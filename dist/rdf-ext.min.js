!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var globalRequire=require;require=function(){};var exports=module.exports={Lexer:require("./lib/N3Lexer"),Parser:require("./lib/N3Parser"),Writer:require("./lib/N3Writer"),Store:require("./lib/N3Store"),StreamParser:require("./lib/N3StreamParser"),StreamWriter:require("./lib/N3StreamWriter"),Util:require("./lib/N3Util")};Object.keys(exports).forEach(function(submodule){Object.defineProperty(exports,submodule,{configurable:!0,enumerable:!0,get:function(){return delete exports[submodule],exports[submodule]=globalRequire("./lib/N3"+submodule)}})})},{"./lib/N3Lexer":2,"./lib/N3Parser":3,"./lib/N3Store":4,"./lib/N3StreamParser":5,"./lib/N3StreamWriter":6,"./lib/N3Util":7,"./lib/N3Writer":8}],2:[function(require,module,exports){function N3Lexer(options){if(!(this instanceof N3Lexer))return new N3Lexer(options);if(options&&options.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var self=this;this._tokenize=this.tokenize,this.tokenize=function(input,callback){this._tokenize(input,function(error,token){!error&&/IRI|prefixed|literal|langcode|type|\.|eof/.test(token.type)?callback&&callback(error,token):callback&&callback(error||self._syntaxError(token.type,callback=null))})}}}var fromCharCode=String.fromCharCode,immediately="function"==typeof setImmediate?setImmediate:function(func){setTimeout(func,0)},escapeSequence=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,escapeReplacements={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},illegalIriChars=/[\x00-\x20<>\\"\{\}\|\^\`]/;N3Lexer.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(callback,inputFinished){function reportSyntaxError(self){callback(self._syntaxError(/^\S*/.exec(input)[0]))}for(var input=this._input;;){for(var whiteSpaceMatch;whiteSpaceMatch=this._newline.exec(input);)input=input.substr(whiteSpaceMatch[0].length,input.length),this._line++;if((whiteSpaceMatch=this._whitespace.exec(input))&&(input=input.substr(whiteSpaceMatch[0].length,input.length)),this._endOfFile.test(input))return inputFinished&&callback(input=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=input;var unescaped,line=this._line,type="",value="",prefix="",firstChar=input[0],match=null,matchLength=0,inconclusive=!1;switch(firstChar){case"^":if(1===input.length)break;if("^"!==input[1])return reportSyntaxError(this);if(this._prevTokenType="^",input=input.substr(2),"<"!==input[0]){inconclusive=!0;break}case"<":if(match=this._unescapedIri.exec(input))type="IRI",value=match[1];else if(match=this._iri.exec(input)){if(unescaped=this._unescape(match[1]),null===unescaped||illegalIriChars.test(unescaped))return reportSyntaxError(this);type="IRI",value=unescaped}break;case"_":((match=this._blank.exec(input))||inputFinished&&(match=this._blank.exec(input+" ")))&&(type="prefixed",prefix="_",value=match[1]);break;case'"':case"'":if(match=this._unescapedString.exec(input))type="literal",value=match[0];else if(match=this._singleQuotedString.exec(input)){if(unescaped=this._unescape(match[0]),null===unescaped)return reportSyntaxError(this);type="literal",value=unescaped.replace(/^'|'$/g,'"')}else if(match=this._tripleQuotedString.exec(input)){if(unescaped=match[1]||match[2],this._line+=unescaped.split(/\r\n|\r|\n/).length-1,unescaped=this._unescape(unescaped),null===unescaped)return reportSyntaxError(this);type="literal",value=unescaped.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(match=this._langcode.exec(input))?(type="langcode",value=match[1]):(match=this._keyword.exec(input))&&(type=match[0]);break;case".":if(1===input.length?inputFinished:input[1]<"0"||input[1]>"9"){type=".",matchLength=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(match=this._number.exec(input))&&(type="literal",value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(match[1]?"double":/^[+\-]?\d+$/.test(match[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(match=this._sparqlKeyword.exec(input))?type=match[0].toUpperCase():inconclusive=!0;break;case"f":case"t":(match=this._boolean.exec(input))?(type="literal",value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):inconclusive=!0;break;case"a":(match=this._shortPredicates.exec(input))?(type="abbreviation",value="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):inconclusive=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":matchLength=1,type=firstChar;break;default:inconclusive=!0}if(inconclusive&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(match=this._prefix.exec(input))?((match=this._prefixed.exec(input))||inputFinished&&(match=this._prefixed.exec(input+" ")))&&(type="prefixed",prefix=match[1]||"",value=this._unescape(match[2])):(type="prefix",value=match[1]||"")),"^"===this._prevTokenType&&(type="IRI"===type||"prefixed"===type?"type":""),!type)return inputFinished||!/^'''|^"""/.test(input)&&/\n|\r/.test(input)?reportSyntaxError(this):this._input=input;callback(null,{line:line,type:type,value:value,prefix:prefix}),this._prevTokenType=type,input=input.substr(matchLength||match[0].length,input.length)}},_unescape:function(item){try{return item.replace(escapeSequence,function(sequence,unicode4,unicode8,escapedChar){var charCode;if(unicode4){if(charCode=parseInt(unicode4,16),isNaN(charCode))throw new Error;return fromCharCode(charCode)}if(unicode8){if(charCode=parseInt(unicode8,16),isNaN(charCode))throw new Error;return 65535>=charCode?fromCharCode(charCode):fromCharCode(55296+(charCode-=65536)/1024,56320+(1023&charCode))}var replacement=escapeReplacements[escapedChar];if(!replacement)throw new Error;return replacement})}catch(error){return null}},_syntaxError:function(issue){return this._input=null,new Error('Syntax error: unexpected "'+issue+'" on line '+this._line+".")},tokenize:function(input,callback){function addChunk(data){null!==self._input&&(self._input+=data,self._tokenizeToEnd(callback,!1))}function end(){null!==self._input&&self._tokenizeToEnd(callback,!0)}var self=this;this._line=1,"string"==typeof input?(this._input=input,immediately(function(){self._tokenizeToEnd(callback,!0)})):(this._input="",input&&"function"!=typeof input?("function"==typeof input.setEncoding&&input.setEncoding("utf8"),input.on("data",addChunk),input.on("end",end)):(this.addChunk=addChunk,this.end=end,callback||(callback=input)))}},module.exports=N3Lexer},{}],3:[function(require,module,exports){function N3Parser(options){if(!(this instanceof N3Parser))return new N3Parser(options);if(this._tripleStack=[],this._graph=null,options=options||{},options.documentIRI){if(options.documentIRI.indexOf("#")>0)throw new Error("Invalid document IRI");this._baseIRI=options.documentIRI,this._baseIRIPath=this._baseIRI.replace(documentPart,""),this._baseIRIRoot=this._baseIRI.match(rootIRI)[0]}else this._baseIRI=null,this._baseIRIPath=null;var format="string"==typeof options.format&&options.format.match(/\w*$/)[0].toLowerCase(),isTurtle="turtle"===format,isTriG="trig"===format,isNTriples=/triple/.test(format),isNQuads=/quad/.test(format),isLineMode=isNTriples||isNQuads;(this._supportsNamedGraphs=!isTurtle)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(isTurtle||isTriG||isNTriples),isLineMode&&(this._baseIRI="",this._resolveIRI=function(token){return this._error("Disallowed relative IRI",token),this._callback=noop,this._subject=null}),this._blankNodePrefix="string"!=typeof options.blankNodePrefix?"":"_:"+options.blankNodePrefix.replace(/^_:/,""),this._lexer=options.lexer||new N3Lexer({lineMode:isLineMode})}function noop(){}var N3Lexer=require("./N3Lexer"),RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_NIL=RDF_PREFIX+"nil",RDF_FIRST=RDF_PREFIX+"first",RDF_REST=RDF_PREFIX+"rest",absoluteIRI=/:/,documentPart=/[^\/]*$/,rootIRI=/^(?:[^:]+:\/*)?[^\/]*/,blankNodePrefix=0,blankNodeCount=0;N3Parser._resetBlankNodeIds=function(){blankNodePrefix=blankNodeCount=0},N3Parser.prototype={_readInTopContext:function(token){switch(token.type){case"eof":return null!==this._graph?this._error("Unclosed graph",token):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(token)}},_readSubject:function(token){switch(this._predicate=null,token.type){case"IRI":null===this._baseIRI||absoluteIRI.test(token.value)?this._subject=token.value:this._subject=this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._subject=prefix+token.value;break;case"[":return this._subject="_:b"+blankNodeCount++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:RDF_NIL,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(token);default:return this._error("Expected subject but got "+token.type,token)}return this._readPredicateOrNamedGraph},_readPredicate:function(token){var type=token.type;switch(type){case"IRI":case"abbreviation":null===this._baseIRI||absoluteIRI.test(token.value)?this._predicate=token.value:this._predicate=this._resolveIRI(token);break;case"prefixed":if("_"===token.prefix)return this._error("Disallowed blank node as predicate",token);var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._predicate=prefix+token.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+type,token):(this._subject=null,"]"===type?this._readBlankNodeTail(token):this._readPunctuation(token));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',token)}return this._readObject},_readObject:function(token){switch(token.type){case"IRI":null===this._baseIRI||absoluteIRI.test(token.value)?this._object=token.value:this._object=this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._object=prefix+token.value;break;case"literal":return this._object=token.value,this._readDataTypeOrLang;case"[":var blank="_:b"+blankNodeCount++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:blank,type:"blank"}),this._subject=blank,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:RDF_NIL,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',token)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(token){return"{"===token.type?this._readGraph(token):this._readPredicate(token)},_readGraph:function(token){return"{"!==token.type?this._error("Expected graph but got "+token.type,token):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(token){return"]"===token.type?(this._subject=null,this._readBlankNodeTail(token)):(this._predicate=null,this._readPredicate(token))},_readBlankNodeTail:function(token){if("]"!==token.type)return this._readBlankNodePunctuation(token);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var triple=this._tripleStack.pop();return this._subject=triple.subject,null!==triple.object?(this._predicate=triple.predicate,this._object=triple.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(token){switch(token.type){case"type":var value;if(""===token.prefix)value=null===this._baseIRI||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token);else{var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);value=prefix+token.value}return this._object+="^^"+value,this._getTripleEndReader();case"langcode":return this._object+="@"+token.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,token)}},_readListItem:function(token){var item=null,itemHead=null,prevItemHead=this._subject,stack=this._tripleStack,parentTriple=stack[stack.length-1],next=this._readListItem;switch(token.type){case"IRI":item=null===this._baseIRI||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);item=prefix+token.value;break;case"literal":item=token.value,next=this._readDataTypeOrLang;break;case"[":itemHead="_:b"+blankNodeCount++,item="_:b"+blankNodeCount++,stack.push({subject:itemHead,predicate:RDF_FIRST,object:item,type:"blank"}),this._subject=item,next=this._readBlankNodeHead;break;case"(":itemHead="_:b"+blankNodeCount++,stack.push({subject:itemHead,predicate:RDF_FIRST,object:RDF_NIL,type:"list"}),this._subject=null,next=this._readListItem;break;case")":if(stack.pop(),0!==stack.length&&"list"===stack[stack.length-1].type&&this._callback(null,{subject:parentTriple.subject,predicate:parentTriple.predicate,object:parentTriple.object,graph:this._graph||""}),this._subject=parentTriple.subject,null===parentTriple.predicate){if(next=this._readPredicate,parentTriple.subject===RDF_NIL)return next}else if(this._predicate=parentTriple.predicate,this._object=parentTriple.object,next=this._getTripleEndReader(),parentTriple.object===RDF_NIL)return next;itemHead=RDF_NIL;break;default:return this._error('Expected list item instead of "'+token.type+'"',token)}return null===itemHead&&(this._subject=itemHead="_:b"+blankNodeCount++),null===prevItemHead?parentTriple.object===RDF_NIL?parentTriple.object=itemHead:parentTriple.subject=itemHead:this._callback(null,{subject:prevItemHead,predicate:RDF_REST,object:itemHead,graph:this._graph||""}),null!==item&&this._callback(null,{subject:itemHead,predicate:RDF_FIRST,object:item,graph:this._graph||""}),next},_readPunctuation:function(token){var next,subject=this._subject,graph=this._graph;switch(token.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",token);this._graph=null;case".":this._subject=null,next=this._readInTopContext;break;case";":next=this._readPredicate;break;case",":next=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){graph=null===this._baseIRI||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token),subject=this._subject,next=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);graph=prefix+token.value,next=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}return null!==subject&&this._callback(null,{subject:subject,predicate:this._predicate,object:this._object,graph:graph||""}),next},_readBlankNodePunctuation:function(token){var next;switch(token.type){case";":next=this._readPredicate;break;case",":next=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),next},_readQuadPunctuation:function(token){return"."!==token.type?this._error("Expected dot to follow quad",token):this._readInTopContext},_readPrefix:function(token){return"prefix"!==token.type?this._error("Expected prefix to follow @prefix",token):(this._prefix=token.value,this._readPrefixIRI)},_readPrefixIRI:function(token){if("IRI"!==token.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',token);var prefixIRI;return prefixIRI=null===this._baseIRI||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token),this._prefixes[this._prefix]=prefixIRI,this._prefixCallback(this._prefix,prefixIRI),this._readDeclarationPunctuation},_readBaseIRI:function(token){return"IRI"!==token.type?this._error("Expected IRI to follow base declaration",token):token.value.indexOf("#")>0?this._error("Invalid base IRI",token):(null===this._baseIRI||absoluteIRI.test(token.value)?this._baseIRI=token.value:this._baseIRI=this._resolveIRI(token),this._baseIRIPath=this._baseIRI.replace(documentPart,""),this._baseIRIRoot=this._baseIRI.match(rootIRI)[0],this._readDeclarationPunctuation)},_readNamedGraphLabel:function(token){switch(token.type){case"IRI":case"prefixed":return this._readSubject(token),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",token)}},_readNamedGraphBlankLabel:function(token){return"]"!==token.type?this._error("Invalid graph label",token):(this._subject="_:b"+blankNodeCount++,this._readGraph)},_readDeclarationPunctuation:function(token){return this._sparqlStyle?this._readInTopContext(token):"."!==token.type?this._error("Expected declaration to end with a dot",token):this._readInTopContext},_getTripleEndReader:function(){var stack=this._tripleStack;if(0===stack.length)return this._readPunctuation;switch(stack[stack.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(message,token){this._callback(new Error(message+" at line "+token.line+"."))},_resolveIRI:function(token){var iri=token.value;switch(iri[0]){case void 0:return this._baseIRI;case"#":return this._baseIRI+iri;case"?":return this._baseIRI.replace(/(?:\?.*)?$/,iri);case"/":return this._baseIRIRoot+iri;case".":var matchLength,basePath=this._baseIRIPath,basePos=basePath.length,rootLength=this._baseIRIRoot.length,iriPos=0;do switch(iri[iriPos+1]){case"/":matchLength=2;break;case".":if("/"===iri[iriPos+2]){matchLength=3,basePos=Math.max(basePath.lastIndexOf("/",basePos-2),rootLength);break}default:matchLength=0}while(0!==matchLength&&"."===iri[iriPos+=matchLength]);return basePath.substr(0,basePos+1)+iri.substr(iriPos);default:return this._baseIRIPath+iri}},parse:function(input,tripleCallback,prefixCallback){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+blankNodePrefix++ +"_","function"==typeof input&&(prefixCallback=tripleCallback,tripleCallback=input,input=null),this._callback=tripleCallback||noop,this._prefixCallback=prefixCallback||noop;var self=this;this._lexer.tokenize(input,function(error,token){null!==error?(self._callback(error),self._callback=noop):void 0!==self._readCallback&&(self._readCallback=self._readCallback(token))}),input||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},module.exports=N3Parser},{"./N3Lexer":2}],4:[function(require,module,exports){function N3Store(triples,options){return this instanceof N3Store?(this._size=0,this._graphs=Object.create(null),this._entities=Object.create(null),this._entities["><"]=0,this._entityCount=0,this._blankNodeIndex=0,options||!triples||triples[0]||(options=triples,triples=null),this._prefixes=Object.create(null),options&&options.prefixes&&this.addPrefixes(options.prefixes),void(triples&&this.addTriples(triples))):new N3Store(triples,options)}var expandPrefixedName=require("./N3Util").expandPrefixedName;N3Store.prototype={get size(){var size=this._size;if(null!==size)return size;var subjects,subject,graphs=this._graphs;for(var graphKey in graphs)for(var subjectKey in subjects=graphs[graphKey].subjects)for(var predicateKey in subject=subjects[subjectKey])size+=Object.keys(subject[predicateKey]).length;return this._size=size},_addToIndex:function(index0,key0,key1,key2){var index1=index0[key0]||(index0[key0]={}),index2=index1[key1]||(index1[key1]={});index2[key2]=null},_removeFromIndex:function(index0,key0,key1,key2){var key,index1=index0[key0],index2=index1[key1];delete index2[key2];for(key in index2)return;delete index1[key1];for(key in index1)return;delete index0[key0]},_findInIndex:function(index0,key0,key1,key2,name0,name1,name2,graph){var tmp,index1,index2,results=[],entityKeys=Object.keys(this._entities);key0&&((tmp=index0,index0={})[key0]=tmp[key0]);for(var value0 in index0){var entity0=entityKeys[value0];if(index1=index0[value0]){key1&&((tmp=index1,index1={})[key1]=tmp[key1]);for(var value1 in index1){var entity1=entityKeys[value1];if(index2=index1[value1])for(var values=(key2?key2 in index2?[key2]:[]:Object.keys(index2)),l=values.length-1;l>=0;l--){var result={subject:"",predicate:"",object:"",graph:graph};result[name0]=entity0,result[name1]=entity1,result[name2]=entityKeys[values[l]],results.push(result)}}}}return results},_countInIndex:function(index0,key0,key1,key2){var tmp,index1,index2,count=0;key0&&((tmp=index0,index0={})[key0]=tmp[key0]);for(var value0 in index0)if(index1=index0[value0]){key1&&((tmp=index1,index1={})[key1]=tmp[key1]);for(var value1 in index1)(index2=index1[value1])&&(key2?key2 in index2&&count++:count+=Object.keys(index2).length)}return count},addTriple:function(subject,predicate,object,graph){predicate||(graph=subject.graph,object=subject.object,predicate=subject.predicate,subject=subject.subject),graph=graph||"";var graphItem=this._graphs[graph];graphItem||(graphItem=this._graphs[graph]={subjects:{},predicates:{},objects:{}},Object.freeze(graphItem));var entities=this._entities;subject=entities[subject]||(entities[subject]=++this._entityCount),predicate=entities[predicate]||(entities[predicate]=++this._entityCount),object=entities[object]||(entities[object]=++this._entityCount),this._addToIndex(graphItem.subjects,subject,predicate,object),this._addToIndex(graphItem.predicates,predicate,object,subject),this._addToIndex(graphItem.objects,object,subject,predicate),this._size=null},addTriples:function(triples){for(var i=triples.length-1;i>=0;i--)this.addTriple(triples[i])},addPrefix:function(prefix,iri){this._prefixes[prefix]=iri},addPrefixes:function(prefixes){for(var prefix in prefixes)this.addPrefix(prefix,prefixes[prefix])},removeTriple:function(subject,predicate,object,graph){predicate||(graph=subject.graph,object=subject.object,predicate=subject.predicate,subject=subject.subject),graph=graph||"";var graphItem,entities=this._entities,graphs=this._graphs;if((subject=entities[subject])&&(predicate=entities[predicate])&&(object=entities[object])&&(graphItem=graphs[graph])){var subjects,predicates;if((subjects=graphItem.subjects[subject])&&(predicates=subjects[predicate])&&object in predicates){this._removeFromIndex(graphItem.subjects,subject,predicate,object),this._removeFromIndex(graphItem.predicates,predicate,object,subject),this._removeFromIndex(graphItem.objects,object,subject,predicate),null!==this._size&&this._size--;for(subject in graphItem.subjects)return;delete graphs[graph]}}},removeTriples:function(triples){for(var i=triples.length-1;i>=0;i--)this.removeTriple(triples[i])},find:function(subject,predicate,object,graph){var prefixes=this._prefixes;return this.findByIRI(expandPrefixedName(subject,prefixes),expandPrefixedName(predicate,prefixes),expandPrefixedName(object,prefixes),expandPrefixedName(graph,prefixes))},findByIRI:function(subject,predicate,object,graph){graph=graph||"";var graphItem=this._graphs[graph],entities=this._entities;return graphItem?subject&&!(subject=entities[subject])?[]:predicate&&!(predicate=entities[predicate])?[]:object&&!(object=entities[object])?[]:subject?object?this._findInIndex(graphItem.objects,object,subject,predicate,"object","subject","predicate",graph):this._findInIndex(graphItem.subjects,subject,predicate,null,"subject","predicate","object",graph):predicate?this._findInIndex(graphItem.predicates,predicate,object,null,"predicate","object","subject",graph):object?this._findInIndex(graphItem.objects,object,null,null,"object","subject","predicate",graph):this._findInIndex(graphItem.subjects,null,null,null,"subject","predicate","object",graph):[]},count:function(subject,predicate,object,graph){var prefixes=this._prefixes;return this.countByIRI(expandPrefixedName(subject,prefixes),expandPrefixedName(predicate,prefixes),expandPrefixedName(object,prefixes),expandPrefixedName(graph,prefixes))},countByIRI:function(subject,predicate,object,graph){graph=graph||"";var graphItem=this._graphs[graph],entities=this._entities;return graphItem?subject&&!(subject=entities[subject])?0:predicate&&!(predicate=entities[predicate])?0:object&&!(object=entities[object])?0:subject?object?this._countInIndex(graphItem.objects,object,subject,predicate):this._countInIndex(graphItem.subjects,subject,predicate,object):predicate?this._countInIndex(graphItem.predicates,predicate,object,subject):this._countInIndex(graphItem.objects,object,subject,predicate):0},createBlankNode:function(suggestedName){var name;if(suggestedName){name=suggestedName="_:"+suggestedName;for(var index=1;this._entities[name];)name=suggestedName+index++}else do name="_:b"+this._blankNodeIndex++;while(this._entities[name]);return this._entities[name]=this._entityCount++,name}},module.exports=N3Store},{"./N3Util":7}],5:[function(require,module,exports){function N3StreamParser(options){if(!(this instanceof N3StreamParser))return new N3StreamParser(options);Transform.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var self=this,parser=new N3Parser(options);parser.parse(function(error,triple){triple&&self.push(triple)||error&&self.emit("error",error)},this.emit.bind(this,"prefix")),this._transform=function(chunk,encoding,done){parser.addChunk(chunk),done()},this._flush=function(done){parser.end(),done()}}var Transform=require("stream").Transform,util=require("util"),N3Parser=require("./N3Parser.js");util.inherits(N3StreamParser,Transform),module.exports=N3StreamParser},{"./N3Parser.js":3,stream:33,util:36}],6:[function(require,module,exports){function N3StreamWriter(options){if(!(this instanceof N3StreamWriter))return new N3StreamWriter(options);Transform.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var self=this,writer=new N3Writer({write:function(chunk,encoding,callback){self.push(chunk),callback&&callback()},end:function(callback){self.push(null),callback&&callback()}},options);this._transform=function(triple,encoding,done){writer.addTriple(triple,done)},this._flush=function(done){writer.end(done)}}var Transform=require("stream").Transform,util=require("util"),N3Writer=require("./N3Writer.js");util.inherits(N3StreamWriter,Transform),module.exports=N3StreamWriter},{"./N3Writer.js":8,stream:33,util:36}],7:[function(require,module,exports){function AddN3Util(parent,toPrototype){for(var name in N3Util)toPrototype?parent.prototype[name]=ApplyToThis(N3Util[name]):parent[name]=N3Util[name];return parent}function ApplyToThis(f){return function(a){return f(this,a)}}var Xsd="http://www.w3.org/2001/XMLSchema#",XsdString=Xsd+"string",XsdInteger=Xsd+"integer",XsdDecimal=Xsd+"decimal",XsdBoolean=Xsd+"boolean",RdfLangString="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",N3Util={isIRI:function(entity){if(!entity)return entity;var firstChar=entity[0];return'"'!==firstChar&&"_"!==firstChar},isLiteral:function(entity){return entity&&'"'===entity[0]},isBlank:function(entity){return entity&&"_:"===entity.substr(0,2)},getLiteralValue:function(literal){var match=/^"([^]*)"/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]},getLiteralType:function(literal){var match=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]||(match[2]?RdfLangString:XsdString)},getLiteralLanguage:function(literal){var match=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]?match[1].toLowerCase():""},isPrefixedName:function(entity){return entity&&/^[^:\/"']*:[^:\/"']+$/.test(entity)},expandPrefixedName:function(prefixedName,prefixes){var prefix,base,index,match=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(prefixedName);return match&&(prefix=match[1],base=prefixes[prefix],index=match.index),void 0===base?prefixedName:0===index?base+prefixedName.substr(prefix.length+1):prefixedName.substr(0,index+3)+base+prefixedName.substr(index+prefix.length+4)},createIRI:function(iri){return iri&&'"'===iri[0]?N3Util.getLiteralValue(iri):iri;
},createLiteral:function(value,modifier){if(!modifier)switch(typeof value){case"boolean":modifier=XsdBoolean;break;case"number":if(isFinite(value)){modifier=value%1===0?XsdInteger:XsdDecimal;break}default:return'"'+value+'"'}return'"'+value+(/^[a-z]+(-[a-z0-9]+)*$/i.test(modifier)?'"@'+modifier.toLowerCase():'"^^'+modifier)}};module.exports=AddN3Util(AddN3Util)},{}],8:[function(require,module,exports){function N3Writer(outputStream,options){if(!(this instanceof N3Writer))return new N3Writer(outputStream,options);if(outputStream&&"function"!=typeof outputStream.write&&(options=outputStream,outputStream=null),options=options||{},outputStream)this._outputStream=outputStream,this._endStream=void 0===options.end?!0:!!options.end;else{var output="";this._outputStream={write:function(chunk,encoding,done){output+=chunk,done&&done()},end:function(done){done&&done(null,output)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(options.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),options.prefixes&&this.addPrefixes(options.prefixes))}function characterReplacer(character){var result=escapeReplacements[character];return void 0===result&&(1===character.length?(result=character.charCodeAt(0).toString(16),result="\\u0000".substr(0,6-result.length)+result):(result=(1024*(character.charCodeAt(0)-55296)+character.charCodeAt(1)+9216).toString(16),result="\\U00000000".substr(0,10-result.length)+result)),result}var N3LiteralMatcher=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_TYPE=RDF_PREFIX+"type",escape=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,escapeAll=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,escapeReplacements={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};N3Writer.prototype={_write:function(string,callback){this._outputStream.write(string,"utf8",callback)},_writeTriple:function(subject,predicate,object,graph,done){try{this._graph!==graph&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(graph?this._encodeIriOrBlankNode(graph)+" {\n":"")),this._graph=graph,this._subject=null),this._subject===subject?this._predicate===predicate?this._write(", "+this._encodeObject(object),done):this._write(";\n    "+this._encodePredicate(this._predicate=predicate)+" "+this._encodeObject(object),done):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=subject)+" "+this._encodePredicate(this._predicate=predicate)+" "+this._encodeObject(object),done)}catch(error){done&&done(error)}},_writeTripleLine:function(subject,predicate,object,graph,done){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(subject)+" "+this._encodeIriOrBlankNode(predicate)+" "+this._encodeObject(object)+(graph?" "+this._encodeIriOrBlankNode(graph)+".\n":".\n"),done)}catch(error){done&&done(error)}},_encodeIriOrBlankNode:function(iri){if("_"===iri[0]&&":"===iri[1])return iri;escape.test(iri)&&(iri=iri.replace(escapeAll,characterReplacer));var prefixMatch=this._prefixRegex.exec(iri);return prefixMatch?prefixMatch[1]?this._prefixIRIs[prefixMatch[1]]+prefixMatch[2]:iri:"<"+iri+">"},_encodeLiteral:function(value,type,language){return escape.test(value)&&(value=value.replace(escapeAll,characterReplacer)),language?'"'+value+'"@'+language:type?'"'+value+'"^^'+this._encodeIriOrBlankNode(type):'"'+value+'"'},_encodeSubject:function(subject){if('"'===subject[0])throw new Error("A literal as subject is not allowed: "+subject);return this._encodeIriOrBlankNode(subject)},_encodePredicate:function(predicate){if('"'===predicate[0])throw new Error("A literal as predicate is not allowed: "+predicate);return predicate===RDF_TYPE?"a":this._encodeIriOrBlankNode(predicate)},_encodeObject:function(object){if('"'!==object[0])return this._encodeIriOrBlankNode(object);var match=N3LiteralMatcher.exec(object);if(!match)throw new Error("Invalid literal: "+object);return this._encodeLiteral(match[1],match[2],match[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(subject,predicate,object,graph,done){"string"!=typeof object?this._writeTriple(subject.subject,subject.predicate,subject.object,subject.graph||"",predicate):"string"!=typeof graph?this._writeTriple(subject,predicate,object,"",graph):this._writeTriple(subject,predicate,object,graph,done)},addTriples:function(triples){for(var i=0;i<triples.length;i++)this.addTriple(triples[i])},addPrefix:function(prefix,iri,done){var prefixes={};prefixes[prefix]=iri,this.addPrefixes(prefixes,done)},addPrefixes:function(prefixes,done){var prefixIRIs=this._prefixIRIs,hasPrefixes=!1;for(var prefix in prefixes){var iri=prefixes[prefix];/[#\/]$/.test(iri)&&prefixIRIs[iri]!==(prefix+=":")&&(hasPrefixes=!0,prefixIRIs[iri]=prefix,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+prefix+" <"+iri+">.\n"))}if(hasPrefixes){var IRIlist="",prefixList="";for(var prefixIRI in prefixIRIs)IRIlist+=IRIlist?"|"+prefixIRI:prefixIRI,prefixList+=(prefixList?"|":"")+prefixIRIs[prefixIRI];IRIlist=IRIlist.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+prefixList+")[^/]*$|^("+IRIlist+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(hasPrefixes?"\n":"",done)},_prefixRegex:/$0^/,end:function(done){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var singleDone=done&&function(error,result){singleDone=null,done(error,result)};if(this._endStream)try{return this._outputStream.end(singleDone)}catch(error){}singleDone&&singleDone()}},module.exports=N3Writer},{}],9:[function(require,module,exports){},{}],10:[function(require,module,exports){arguments[4][9][0].apply(exports,arguments)},{dup:9}],11:[function(require,module,exports){function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){return this instanceof Buffer?(this.length=0,this.parent=void 0,"number"==typeof arg?fromNumber(this,arg):"string"==typeof arg?fromString(this,arg,arguments.length>1?arguments[1]:"utf8"):fromObject(this,arg)):arguments.length>1?new Buffer(arg,arguments[1]):new Buffer(arg)}function fromNumber(that,length){if(that=allocate(that,0>length?0:0|checked(length)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;length>i;i++)that[i]=0;return that}function fromString(that,string,encoding){("string"!=typeof encoding||""===encoding)&&(encoding="utf8");var length=0|byteLength(string,encoding);return that=allocate(that,length),that.write(string,encoding),that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(null==object)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(object.buffer instanceof ArrayBuffer)return fromTypedArray(that,object);if(object instanceof ArrayBuffer)return fromArrayBuffer(that,object)}return object.length?fromArrayLike(that,object):fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=0|checked(buffer.length);return that=allocate(that,length),buffer.copy(that,0,0,length),that}function fromArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromTypedArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array){return Buffer.TYPED_ARRAY_SUPPORT?(array.byteLength,that=Buffer._augment(new Uint8Array(array))):that=fromTypedArray(that,new Uint8Array(array)),that}function fromArrayLike(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromJsonObject(that,object){var array,length=0;"Buffer"===object.type&&isArray(object.data)&&(array=object.data,length=0|checked(array.length)),that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function allocate(that,length){Buffer.TYPED_ARRAY_SUPPORT?that=Buffer._augment(new Uint8Array(length)):(that.length=length,that._isBuffer=!0);var fromPool=0!==length&&length<=Buffer.poolSize>>>1;return fromPool&&(that.parent=rootParent),that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);return delete buf.parent,buf}function byteLength(string,encoding){"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if(start=0|start,end=void 0===end||end===1/0?this.length:0|end,encoding||(encoding="utf8"),0>start&&(start=0),end>this.length&&(end=this.length),start>=end)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var firstByte,secondByte,thirdByte,fourthByte,bytesPerSequence,tempCodePoint,codePoint,res=[],i=start;end>i;i+=bytesPerSequence){if(firstByte=buf[i],codePoint=65533,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1,end>=i+bytesPerSequence)switch(bytesPerSequence){case 1:128>firstByte&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128===(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte,tempCodePoint>127&&(codePoint=tempCodePoint));break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128===(192&secondByte)&&128===(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte,tempCodePoint>2047&&(55296>tempCodePoint||tempCodePoint>57343)&&(codePoint=tempCodePoint));break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128===(192&secondByte)&&128===(192&thirdByte)&&128===(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte,tempCodePoint>65535&&1114112>tempCodePoint&&(codePoint=tempCodePoint))}65533===codePoint?bytesPerSequence=1:codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint)}return String.fromCharCode.apply(String,res)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(127&buf[i]);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(0>offset)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;length>i;i++){if(codePoint=string.charCodeAt(i),codePoint>55295&&57344>codePoint){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=leadSurrogate-55296<<10|codePoint-56320|65536}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,128>codePoint){if((units-=1)<0)break;bytes.push(codePoint)}else if(2048>codePoint){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(65536>codePoint){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(1114112>codePoint))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){function Bar(){}try{var arr=new Uint8Array(1);return arr.foo=function(){return 42},arr.constructor=Bar,42===arr.foo()&&arr.constructor===Bar&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);len>i&&a[i]===b[i];)++i;return i!==len&&(x=a[i],y=b[i]),y>x?-1:x>y?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(0===list.length)return new Buffer(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;i++)length+=list[i].length;var buf=new Buffer(length),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=byteLength,Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:Buffer.compare(this,b)},Buffer.prototype.indexOf=function(val,byteOffset){function arrayIndexOf(arr,val,byteOffset){for(var foundIndex=-1,i=0;byteOffset+i<arr.length;i++)if(arr[byteOffset+i]===val[-1===foundIndex?0:i-foundIndex]){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===val.length)return byteOffset+foundIndex}else foundIndex=-1;return-1}if(byteOffset>2147483647?byteOffset=2147483647:-2147483648>byteOffset&&(byteOffset=-2147483648),byteOffset>>=0,0===this.length)return-1;if(byteOffset>=this.length)return-1;if(0>byteOffset&&(byteOffset=Math.max(this.length+byteOffset,0)),"string"==typeof val)return 0===val.length?-1:String.prototype.indexOf.call(this,val,byteOffset);if(Buffer.isBuffer(val))return arrayIndexOf(this,val,byteOffset);if("number"==typeof val)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,val,byteOffset):arrayIndexOf(this,[val],byteOffset);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else if(isFinite(offset))offset=0|offset,isFinite(length)?(length=0|length,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=0|length,length=swap}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(0>length||0>offset)||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len),0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len),start>end&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=Buffer._augment(this.subarray(start,end));else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;sliceLen>i;i++)newBuf[i]=this[i+start]}return newBuf.length&&(newBuf.parent=this.parent||this),newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0>value?1:0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0>value?1:0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),0>value&&(value=255+value+1),this[offset]=value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),0>value&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&start>end&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(0>targetStart)throw new RangeError("targetStart out of bounds");if(0>start||start>=this.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&targetStart>start&&end>targetStart)for(i=len-1;i>=0;i--)target[i+targetStart]=this[i+start];else if(1e3>len||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;len>i;i++)target[i+targetStart]=this[i+start];else target._set(this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),start>end)throw new RangeError("end < start");if(end!==start&&0!==this.length){if(0>start||start>=this.length)throw new RangeError("start out of bounds");if(0>end||end>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof value)for(i=start;end>i;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;end>i;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr.constructor=Buffer,arr._isBuffer=!0,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.indexOf=BP.indexOf,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUIntLE=BP.readUIntLE,
arr.readUIntBE=BP.readUIntBE,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readIntLE=BP.readIntLE,arr.readIntBE=BP.readIntBE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUIntLE=BP.writeUIntLE,arr.writeUIntBE=BP.writeUIntBE,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeIntLE=BP.writeIntLE,arr.writeIntBE=BP.writeIntBE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g},{"base64-js":12,ieee754:13,"is-array":14}],12:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],13:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],14:[function(require,module,exports){var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],15:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],16:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],17:[function(require,module,exports){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}},{}],18:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),path||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;length>i;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return outputParts=outputParts.concat(toParts.slice(samePartsLength)),outputParts.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return 0>start&&(start=str.length+start),str.substr(start,len)}}).call(this,require("_process"))},{_process:19}],19:[function(require,module,exports){function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var currentQueue,process=module.exports={},queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],20:[function(require,module,exports){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":21}],21:[function(require,module,exports){"use strict";function Duplex(options){return this instanceof Duplex?(Readable.call(this,options),Writable.call(this,options),options&&options.readable===!1&&(this.readable=!1),options&&options.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,options&&options.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(options)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(self){self.end()}var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var processNextTick=require("process-nextick-args"),util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}},{"./_stream_readable":23,"./_stream_writable":25,"core-util-is":26,inherits:16,"process-nextick-args":27}],22:[function(require,module,exports){"use strict";function PassThrough(options){return this instanceof PassThrough?void Transform.call(this,options):new PassThrough(options)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":24,"core-util-is":26,inherits:16}],23:[function(require,module,exports){(function(process){"use strict";function ReadableState(options,stream){var Duplex=require("./_stream_duplex");options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){require("./_stream_duplex");return this instanceof Readable?(this._readableState=new ReadableState(options,this),this.readable=!0,options&&"function"==typeof options.read&&(this._read=options.read),void Stream.call(this)):new Readable(options)}function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(null===chunk)state.reading=!1,onEofChunk(stream,state);else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var e=new Error("stream.unshift() after end event");stream.emit("error",e)}else!state.decoder||addToFront||encoding||(chunk=state.decoder.write(chunk)),addToFront||(state.reading=!1),state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state);else addToFront||(state.reading=!1);return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function roundUpToNextPowerOf2(n){if(n>=MAX_HWM)n=MAX_HWM;else{n--;for(var p=1;32>p;p<<=1)n|=n>>p;n++}return n}function howMuchToRead(n,state){return 0===state.length&&state.ended?0:state.objectMode?0===n?0:1:null===n||isNaN(n)?state.flowing&&state.buffer.length?state.buffer[0].length:state.length:0>=n?0:(n>state.highWaterMark&&(state.highWaterMark=roundUpToNextPowerOf2(n)),n>state.length?state.ended?state.length:(state.needReadable=!0,0):n)}function chunkInvalid(state,chunk){var er=null;return Buffer.isBuffer(chunk)||"string"==typeof chunk||null===chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EE.listenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;if(debug("flow",state.flowing),state.flowing)do var chunk=stream.read();while(null!==chunk&&state.flowing)}function fromList(n,state){var ret,list=state.buffer,length=state.length,stringMode=!!state.decoder,objectMode=!!state.objectMode;if(0===list.length)return null;if(0===length)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length)ret=stringMode?list.join(""):Buffer.concat(list,length),list.length=0;else if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n),list[0]=buf.slice(n)}else if(n===list[0].length)ret=list.shift();else{ret=stringMode?"":new Buffer(n);for(var c=0,i=0,l=list.length;l>i&&n>c;i++){var buf=list[0],cpy=Math.min(n-c,buf.length);stringMode?ret+=buf.slice(0,cpy):buf.copy(ret,c,0,cpy),cpy<buf.length?list[0]=buf.slice(cpy):list.shift(),c+=cpy}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error("endReadable called on non-empty stream");state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function forEach(xs,f){for(var i=0,l=xs.length;l>i;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;l>i;i++)if(xs[i]===x)return i;return-1}module.exports=Readable;var processNextTick=require("process-nextick-args"),isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(emitter,type){return emitter.listeners(type).length});var Stream;!function(){try{Stream=require("stream")}catch(_){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,util=require("core-util-is");util.inherits=require("inherits");var debug=require("util");debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){};var StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(chunk,encoding){var state=this._readableState;return state.objectMode||"string"!=typeof chunk||(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=new Buffer(chunk,encoding),encoding="")),readableAddChunk(this,state,chunk,encoding,!1)},Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",!0)},Readable.prototype.isPaused=function(){return this._readableState.flowing===!1},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n);var state=this._readableState,nOrig=n;if(("number"!=typeof n||n>0)&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(n=howMuchToRead(n,state),0===n&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),(state.ended||state.reading)&&(doRead=!1,debug("reading or ended",doRead)),doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1),doRead&&!state.reading&&(n=howMuchToRead(nOrig,state));var ret;return ret=n>0?fromList(n,state):null,null===ret&&(state.needReadable=!0,n=0),state.length-=n,0!==state.length||state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&0===state.length&&endReadable(this),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable){debug("onunpipe"),readable===src&&cleanup()}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",cleanup),src.removeListener("data",ondata),!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata");var ret=dest.write(chunk);!1===ret&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EE.listenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==!1)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:cleanup;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);return dest.on("drain",ondrain),src.on("data",ondata),dest._events&&dest._events.error?isArray(dest._events.error)?dest._events.error.unshift(onerror):dest._events.error=[onerror,dest._events.error]:dest.on("error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState;if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;len>i;i++)dests[i].emit("unpipe",this);return this}var i=indexOf(state.pipes,dest);return-1===i?this:(state.pipes.splice(i,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev&&!1!==this._readableState.flowing&&this.resume(),"readable"===ev&&this.readable){var state=this._readableState;state.readableListening||(state.readableListening=!0,state.emittedReadable=!1,state.needReadable=!0,state.reading?state.length&&emitReadable(this,state):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){var ret=self.push(chunk);ret||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));var events=["error","close","destroy","pause","resume"];return forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))}),self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,require("_process"))},{"./_stream_duplex":21,_process:19,buffer:11,"core-util-is":26,events:15,inherits:16,isarray:17,"process-nextick-args":27,"string_decoder/":34,util:10}],24:[function(require,module,exports){"use strict";function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb&&cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(er){done(stream,er)}):done(stream)})}function done(stream,er){if(er)return stream.emit("error",er);var ws=stream._writableState,ts=stream._transformState;if(ws.length)throw new Error("calling transform done when ws.length != 0");if(ts.transforming)throw new Error("calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0}},{"./_stream_duplex":21,"core-util-is":26,inherits:16}],25:[function(require,module,exports){"use strict";function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk,this.encoding=encoding,this.callback=cb,this.next=null}function WritableState(options,stream){var Duplex=require("./_stream_duplex");options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);
var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var noDecode=options.decodeStrings===!1;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(options){var Duplex=require("./_stream_duplex");return this instanceof Writable||this instanceof Duplex?(this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev)),void Stream.call(this)):new Writable(options)}function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er),processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=!0;if(!Buffer.isBuffer(chunk)&&"string"!=typeof chunk&&null!==chunk&&void 0!==chunk&&!state.objectMode){var er=new TypeError("Invalid non-string/buffer chunk");stream.emit("error",er),processNextTick(cb,er),valid=!1}return valid}function decodeChunk(state,chunk,encoding){return state.objectMode||state.decodeStrings===!1||"string"!=typeof chunk||(chunk=new Buffer(chunk,encoding)),chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding),Buffer.isBuffer(chunk)&&(encoding="buffer");var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(ret||(state.needDrain=!0),state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb),last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){--state.pendingcb,sync?processNextTick(cb,er):cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?processNextTick(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){for(var buffer=[],cbs=[];entry;)cbs.push(entry.callback),buffer.push(entry),entry=entry.next;state.pendingcb++,state.lastBufferedRequest=null,doWrite(stream,state,!0,state.length,buffer,"",function(err){for(var i=0;i<cbs.length;i++)state.pendingcb--,cbs[i](err)})}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback,len=state.objectMode?1:chunk.length;if(doWrite(stream,state,!1,len,chunk,encoding,cb),entry=entry.next,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function prefinish(stream,state){state.prefinished||(state.prefinished=!0,stream.emit("prefinish"))}function finishMaybe(stream,state){var need=needFinish(state);return need&&(0===state.pendingcb?(prefinish(stream,state),state.finished=!0,stream.emit("finish")):prefinish(stream,state)),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?processNextTick(cb):stream.once("finish",cb)),state.ended=!0}module.exports=Writable;var processNextTick=require("process-nextick-args"),Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream;!function(){try{Stream=require("stream")}catch(_){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer;util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:require("util-deprecate")(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer() instead.")})}catch(_){}}(),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1;return"function"==typeof encoding&&(cb=encoding,encoding=null),Buffer.isBuffer(chunk)?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?writeAfterEnd(this,cb):validChunk(this,state,chunk,cb)&&(state.pendingcb++,ret=writeOrBuffer(this,state,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){var state=this._writableState;state.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||endWritable(this,state,cb)}},{"./_stream_duplex":21,buffer:11,"core-util-is":26,events:15,inherits:16,"process-nextick-args":27,"util-deprecate":28}],26:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function isBuffer(arg){return Buffer.isBuffer(arg)}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=isBuffer}).call(this,require("buffer").Buffer)},{buffer:11}],27:[function(require,module,exports){(function(process){"use strict";function nextTick(fn){for(var args=new Array(arguments.length-1),i=0;i<arguments.length;)args[i++]=arguments[i];process.nextTick(function(){fn.apply(null,args)})}module.exports=nextTick}).call(this,require("_process"))},{_process:19}],28:[function(require,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){if(!global.localStorage)return!1;var val=global.localStorage[name];return null==val?!1:"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(require,module,exports){module.exports=require("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":22}],30:[function(require,module,exports){var Stream=function(){try{return require("stream")}catch(_){}}();exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=Stream||exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":21,"./lib/_stream_passthrough.js":22,"./lib/_stream_readable.js":23,"./lib/_stream_transform.js":24,"./lib/_stream_writable.js":25}],31:[function(require,module,exports){module.exports=require("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":24}],32:[function(require,module,exports){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":25}],33:[function(require,module,exports){function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&options.end===!1||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:15,inherits:16,"readable-stream/duplex.js":20,"readable-stream/passthrough.js":29,"readable-stream/readable.js":30,"readable-stream/transform.js":31,"readable-stream/writable.js":32}],34:[function(require,module,exports){function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding))throw new Error("Unknown encoding: "+encoding)}function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(encoding){switch(this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(encoding),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(buffer){for(var charStr="";this.charLength;){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;if(buffer.copy(this.charBuffer,this.charReceived,0,available),this.charReceived+=available,this.charReceived<this.charLength)return"";buffer=buffer.slice(available,buffer.length),charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(!(charCode>=55296&&56319>=charCode)){if(this.charReceived=this.charLength=0,0===buffer.length)return charStr;break}this.charLength+=this.surrogateSize,charStr=""}this.detectIncompleteChar(buffer);var end=buffer.length;this.charLength&&(buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end),end-=this.charReceived),charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1,charCode=charStr.charCodeAt(end);if(charCode>=55296&&56319>=charCode){var size=this.surrogateSize;return this.charLength+=size,this.charReceived+=size,this.charBuffer.copy(this.charBuffer,size,0,size),buffer.copy(this.charBuffer,0,0,size),charStr.substring(0,end)}return charStr},StringDecoder.prototype.detectIncompleteChar=function(buffer){for(var i=buffer.length>=3?3:buffer.length;i>0;i--){var c=buffer[buffer.length-i];if(1==i&&c>>5==6){this.charLength=2;break}if(2>=i&&c>>4==14){this.charLength=3;break}if(3>=i&&c>>3==30){this.charLength=4;break}}this.charReceived=i},StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length&&(res=this.write(buffer)),this.charReceived){var cr=this.charReceived,buf=this.charBuffer,enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res}},{buffer:11}],35:[function(require,module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],36:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;l>i;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return 10>n?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];len>i;x=args[++i])str+=isNull(x)||!isObject(x)?" "+x:" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":35,_process:19,inherits:16}],37:[function(require,module,exports){var rdf=require("rdf-ext"),JsonLdParser=require("rdf-parser-jsonld"),JsonLdSerializer=require("rdf-serializer-jsonld"),MicrodataParser=require("rdf-parser-microdata"),N3Parser=require("rdf-parser-n3"),N3Serializer=require("rdf-serializer-n3"),NTriplesSerializer=require("rdf-serializer-ntriples"),RdfXmlParser=require("rdf-parser-rdfxml"),InMemoryStore=require("rdf-store-inmemory"),LdpStore=require("rdf-store-ldp"),RdfstoreStore=require("rdf-store-rdfstore-js"),SingleGraphStore=require("rdf-store-singlegraph"),SparqlStore=require("rdf-store-sparql"),SparqlUpdateSerializer=require("rdf-serializer-sparql-update"),mixin=function(options){var rdfDist=rdf(options);return rdfDist.JsonLdParser=JsonLdParser,rdfDist.parseJsonLd=JsonLdParser.parse.bind(JsonLdParser),rdfDist.utils.mimeTypeParserMap["application/ld+json"]=rdfDist.parseJsonLd,rdfDist.JsonLdSerializer=JsonLdSerializer.bind(JsonLdSerializer),rdfDist.serializeJsonLd=JsonLdSerializer.serialize.bind(JsonLdSerializer),rdfDist.utils.mimeTypeSerializerMap["application/ld+json"]=rdfDist.serializeJsonLd,rdfDist.MicrodataParser=MicrodataParser,rdfDist.parseMicrodata=MicrodataParser.parse.bind(MicrodataParser),rdfDist.TurtleSerializer=N3Serializer.bind(N3Serializer),rdfDist.serializeTurtle=N3Serializer.serialize.bind(N3Serializer),rdfDist.utils.mimeTypeSerializerMap["text/n3"]=rdfDist.serializeTurtle,rdfDist.utils.mimeTypeSerializerMap["text/turtle"]=rdfDist.serializeTurtle,rdfDist.NTriplesSerializer=NTriplesSerializer.bind(NTriplesSerializer),rdfDist.serializeNTriples=NTriplesSerializer.serialize.bind(NTriplesSerializer),rdfDist.utils.mimeTypeSerializerMap["application/n-triples"]=rdfDist.serializeNTriples,rdfDist.SparqlUpdateSerializer=SparqlUpdateSerializer.bind(SparqlUpdateSerializer),rdfDist.serializeSparqlUpdate=SparqlUpdateSerializer.serialize.bind(SparqlUpdateSerializer),rdfDist.utils.mimeTypeSerializerMap["application/sparql-update"]=rdfDist.serializeSparqlUpdate,rdfDist.RdfXmlParser=RdfXmlParser,rdfDist.parseRdfXml=RdfXmlParser.parse.bind(RdfXmlParser),rdfDist.utils.mimeTypeParserMap["application/rdf+xml"]=rdfDist.parseRdfXml,rdfDist.TurtleParser=N3Parser,rdfDist.NTriplesParser=N3Parser,rdfDist.parseTurtle=N3Parser.parse.bind(N3Parser),rdfDist.parseNTriples=N3Parser.parse.bind(N3Parser),rdfDist.utils.mimeTypeParserMap["application/n-triples"]=rdfDist.parseNTriples,rdfDist.utils.mimeTypeParserMap["text/n3"]=rdfDist.parseTurtle,rdfDist.utils.mimeTypeParserMap["text/turtle"]=rdfDist.parseTurtle,rdfDist.InMemoryStore=InMemoryStore.bind(null,rdfDist),rdfDist.LdpStore=LdpStore.bind(null,rdfDist),rdfDist.RdfstoreStore=RdfstoreStore.bind(null,rdfDist),rdfDist.SingleGraphStore=SingleGraphStore.bind(null,rdfDist),rdfDist.SparqlStore=SparqlStore.bind(null,rdfDist),rdfDist};rdf.isNode||mixin(),module.exports=mixin},{"rdf-ext":42,"rdf-parser-jsonld":65,"rdf-parser-microdata":70,"rdf-parser-n3":72,"rdf-parser-rdfxml":73,"rdf-serializer-jsonld":75,"rdf-serializer-n3":76,"rdf-serializer-ntriples":85,"rdf-serializer-sparql-update":86,"rdf-store-inmemory":87,"rdf-store-ldp":88,"rdf-store-rdfstore-js":89,"rdf-store-singlegraph":90,"rdf-store-sparql":91}],38:[function(require,module,exports){"use strict";var init=function(rdf){var cf={};cf.options={convertStringUrls:!0},cf.urlRegEx=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;var node=function(value){if(!value)return void 0;if(Array.isArray(value))return value.map(function(item){return node(item)});if("object"==typeof value&&value.interfaceName)return value;if("string"==typeof value)return cf.options.convertStringUrls&&cf.urlRegEx.test(value)?rdf.createNamedNode(value):rdf.createLiteral(value);if("number"==typeof value)return rdf.createLiteral(value+"");throw"unknown type"},nodeGraph=function(value,graph,graphIri){return Array.isArray(value)?value.map(function(item){return nodeGraph(item,graph,graphIri)}):(value=node(value),value.graph=graph,value.graphIri=graphIri,value)},inArray=function(node,array){return array.some(function(otherNode){return otherNode.equals(node)})},toArray=function(value){return value?Array.isArray(value)?value:[value]:void 0};cf.Graph=function(graph,nodes){if(!(this instanceof cf.Graph))return new cf.Graph(graph,nodes);this.context=node(toArray(nodes));var match=function(subject,predicate,object,property){var matches=[];return predicate=node(toArray(predicate)),graph.forEach(function(triple){(null===subject||inArray(triple.subject,subject))&&(null===predicate||inArray(triple.predicate,predicate))&&(null===object||inArray(triple.object,object))&&matches.push(triple[property])}),matches};this.graph=function(){return graph},this.node=function(value){return cf.Graph(graph,value)},this["in"]=function(predicate){return cf.Graph(graph,match(null,predicate,this.context,"subject"))},this.out=function(predicate){return cf.Graph(graph,match(this.context,predicate,null,"object"))},this.nodes=function(){return this.context?this.context:[]},this.literal=function(){return this.context?this.context.map(function(node){return node.toString()}):void 0},this.removeIn=function(predicate){return predicate&&(predicate=node(toArray(predicate))),this.nodes().forEach(function(o){predicate?predicate.forEach(function(p){graph.removeMatches(null,p,o)}):graph.removeMatches(null,null,o)}),this},this.removeOut=function(predicate){return predicate&&(predicate=node(toArray(predicate))),this.nodes().forEach(function(s){predicate?predicate.forEach(function(p){graph.removeMatches(s,p,null)}):graph.removeMatches(s,null,null)}),this},this.toArray=function(){return this.nodes().map(this.node)},this.forEach=function(callback){return this.toArray().forEach(callback)},this.map=function(callback){return this.toArray().map(callback)},this.toString=function(){return this.literal().join()}},cf.Store=function(store,nodes){if(!(this instanceof cf.Store))return new cf.Store(store,nodes);this.context=toArray(nodes),this.store=function(){return store},this.graphs=function(){var unique=[];return this.nodes().forEach(function(item){-1===unique.indexOf(item.graph)&&unique.push(item.graph)}),unique},this.node=function(value,graphIri,then){return graphIri=graphIri||value.graphIri||value,store.graph(graphIri).then(function(graph){return then?Promise.resolve(then(cf.Store(store,nodeGraph(value,graph,graphIri)))):cf.Store(store,nodeGraph(value,graph,graphIri))})},this["in"]=function(predicate){var matches=[];return this.nodes().forEach(function(item){matches=matches.concat(cf.Graph(item.graph,item)["in"](predicate).nodes().map(function(match){return nodeGraph(match,item.graph,item.graphIri)}))}),cf.Store(store,matches)},this.out=function(predicate){var matches=[];return this.nodes().forEach(function(item){matches=matches.concat(cf.Graph(item.graph,item).out(predicate).nodes().map(function(match){return nodeGraph(match,item.graph,item.graphIri)}))}),cf.Store(store,matches)},this.jump=function(then){return Promise.all(this.nodes().map(function(item){return store.graph(item.nominalValue).then(function(graph){return nodeGraph(item,graph,item.nominalValue)})})).then(function(entries){return then?Promise.resolve(then(cf.Store(store,entries))):cf.Store(store,entries)})},this.nodes=function(){return this.context?this.context:[]},this.literal=function(){return this.context?this.context.map(function(node){return node.toString()}):void 0},this.toArray=function(){return this.nodes().map(function(node){return cf.Store(store,node)})},this.forEach=function(callback){return this.toArray().forEach(callback)},this.map=function(callback){
return this.toArray().map(callback)},this.toString=function(){return this.literal().join()}},rdf.cf=cf};module.exports=init},{}],39:[function(require,module,exports){"use strict";var funcTemplate=function(func,PromiseClass){return function(){var args=arguments;return new PromiseClass(function(resolve,reject){var callback=function(error,result){error?reject(error):resolve(result)};func(args,callback)})}},ParserPromiseWrapper=function(p,parser){this.process=funcTemplate(function(args,callback){parser.process(args[0],args[1],args[2],args[3],callback)},p),this.parse=funcTemplate(function(args,callback){parser.parse(args[0],callback,args[1],args[2],args[3])},p),this.parser=function(){return parser}},SerializerPromiseWrapper=function(p,serializer){this.serialize=funcTemplate(function(args,callback){serializer.serialize(args[0],callback)},p),this.serializer=function(){return serializer}},StorePromiseWrapper=function(p,store){this.graph=funcTemplate(function(args,callback){store.graph(args[0],callback)},p),this.match=funcTemplate(function(args,callback){store.match(args[0],args[1],args[2],args[3],callback,args[5])},p),this.add=funcTemplate(function(args,callback){store.add(args[0],args[1],callback)},p),this.merge=funcTemplate(function(args,callback){store.merge(args[0],args[1],callback)},p),this.remove=funcTemplate(function(args,callback){store.remove(args[0],args[1],callback)},p),this.removeMatches=funcTemplate(function(args,callback){store.removeMatches(args[0],args[1],args[2],args[3],callback)},p),this["delete"]=funcTemplate(function(args,callback){store["delete"](args[0],callback)},p),this.store=function(){return store}},parsePromiseWrapper=function(p,parse){return funcTemplate(function(args,callback){parse(args[0],callback,args[1],args[2],args[3])},p)},serializePromiseWrapper=function(p,serialize){return funcTemplate(function(args,callback){serialize(args[0],callback)},p)};module.exports=function(rdf){rdf.promise={},rdf.promise.Parser=ParserPromiseWrapper.bind(null,rdf.Promise),rdf.promise.Serializer=SerializerPromiseWrapper.bind(null,rdf.Promise),rdf.promise.Store=StorePromiseWrapper.bind(null,rdf.Promise),rdf.promise.parse=parsePromiseWrapper.bind(null,rdf.Promise),rdf.promise.serialize=serializePromiseWrapper.bind(null,rdf.Promise)}},{}],40:[function(require,module,exports){"use strict";var utils={};utils.defaultRequest=function(method,requestUrl,headers,content,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState===xhr.DONE){for(var headerLines=xhr.getAllResponseHeaders().split("\r\n"),resHeaders={},i=0;i<headerLines.length;i++){var headerLine=headerLines[i].split(": ",2);resHeaders[headerLine[0].toLowerCase()]=headerLine[1]}callback(xhr.status,resHeaders,xhr.responseText)}},xhr.open(method,requestUrl,!0);for(var header in headers)xhr.setRequestHeader(header,headers[header]);xhr.send(content)},utils.corsProxyRequest=function(proxyUrl,method,requestUrl,headers,content,callback){var url=proxyUrl+"?url="+encodeURIComponent(requestUrl);utils.defaultRequest(method,url,headers,content,callback)},utils.mixin=function(rdf){rdf.defaultRequest=utils.defaultRequest,rdf.corsProxyRequest=utils.corsProxyRequest},module.exports=utils.mixin},{}],41:[function(require,module,exports){"use strict";var utils={};utils.filter={},utils.filter.namedNode=function(node){return"NamedNode"===node.interfaceName},utils.filter.blankNode=function(node){return"BlankNode"===node.interfaceName},utils.filter.literal=function(node){return"Literal"===node.interfaceName},utils.filter.namedNodeSubject=function(subject){return function(triple){return"NamedNode"!==triple.subject.interfaceName||triple.subject.equals(subject)}},utils.list={},utils.list.tripleParts=function(graph,part,filter){var nodes={};return filter=filter||function(){return!0},graph.forEach(function(triple){nodes[triple[part].toNT()]=triple[part]}),nodes=Object.keys(nodes).map(function(key){return nodes[key]}).filter(function(node){return filter(node)})},utils.list.subjects=function(graph,filter){return utils.list.tripleParts(graph,"subject",filter)},utils.list.predicates=function(graph,filter){return utils.list.tripleParts(graph,"predicate",filter)},utils.list.objects=function(graph,filter){return utils.list.tripleParts(graph,"object",filter)},utils.createSubGraph=function(rdf,graph,entry,filter){var processedEntries={},subGraph=rdf.createGraph(),processSubject=function(entries){if(0!==entries.length){var newEntries=[],matches=rdf.createGraph();entries.forEach(function(entry){matches.addAll(graph.match(entry))}),filter&&(matches=matches.filter(filter)),matches.forEach(function(match){var key=match.object.toNT();key in processedEntries||(newEntries.push(match.object),processedEntries[key]=!0)}),subGraph.addAll(matches),processSubject(newEntries)}};return processSubject([entry]),subGraph},utils.createSubGraphByNamedNodeSubject=function(rdf,graph,subject){return rdf.utils.createSubGraph(graph,subject,utils.filter.namedNodeSubject(subject))},utils.splitGraphByNamedNodeSubject=function(rdf,graph,store){store=store||new rdf.promise.Store(rdf.createStore());var adds=[];return utils.list.subjects(graph,utils.filter.namedNode).forEach(function(subject){adds.push(store.add(subject,utils.createSubGraphByNamedNodeSubject(rdf,graph,subject)))}),Promise.all(adds).then(function(){return store})},utils.mapNamespaceNode=function(rdf,node,search,replace){return"NamedNode"!==node.interfaceName?node:0!==node.nominalValue.toString().indexOf(search)?node:rdf.createNamedNode(replace+node.nominalValue.toString().substr(search.length))},utils.mapNamespaceTriple=function(rdf,triple,search,replace){return rdf.createTriple(utils.mapNamespaceNode(rdf,triple.subject,search,replace),utils.mapNamespaceNode(rdf,triple.predicate,search,replace),utils.mapNamespaceNode(rdf,triple.object,search,replace))},utils.mapNamespaceGraph=function(rdf,graph,search,replace){var mappedGraph=rdf.createGraph();return graph.forEach(function(triple){mappedGraph.add(utils.mapNamespaceTriple(rdf,triple,search,replace))}),mappedGraph},utils.mimeTypeParserMap={},utils.parse=function(mimeType,data,base,filter,graph){return mimeType in utils.mimeTypeParserMap?rdf.promise.parse(utils.mimeTypeParserMap[mimeType])(data,base,filter,graph):Promise.reject("no parser available for mime type: "+mimeType)},utils.mimeTypeSerializerMap={},utils.serialize=function(mimeType,graph){return mimeType in utils.mimeTypeSerializerMap?rdf.promise.serialize(utils.mimeTypeSerializerMap[mimeType])(graph):Promise.reject("no serializer available for mime type: "+mimeType)},utils.mixin=function(rdf){rdf.utils={},rdf.utils.filter=utils.filter,rdf.utils.list=utils.list,rdf.utils.createSubGraph=utils.createSubGraph.bind(null,rdf),rdf.utils.createSubGraphByNamedNodeSubject=utils.createSubGraphByNamedNodeSubject.bind(null,rdf),rdf.utils.splitGraphByNamedNodeSubject=utils.splitGraphByNamedNodeSubject.bind(null,rdf),rdf.utils.mapNamespaceNode=utils.mapNamespaceNode.bind(null,rdf),rdf.utils.mapNamespaceTriple=utils.mapNamespaceTriple.bind(null,rdf),rdf.utils.mapNamespaceGraph=utils.mapNamespaceGraph.bind(null,rdf),rdf.utils.mimeTypeParserMap=utils.mimeTypeParserMap,rdf.utils.mimeTypeSerializerMap=utils.mimeTypeSerializerMap,rdf.utils.parse=utils.parse,rdf.utils.serialize=utils.serialize},module.exports=utils.mixin},{}],42:[function(require,module,exports){(function(process){"use strict";var rdf=require("rdf-interfaces"),InMemoryStore=require("rdf-store-inmemory");rdf.isNode="undefined"!=typeof process&&process.versions&&process.versions.node;var mixin=function(options){function deprecatedError(name,pkg){return function(){throw new Error(name+" is now deprecated, please see: http://npm.im/"+pkg)}}options=options||{},"undefined"!=typeof window&&(window.rdf=rdf),"undefined"!=typeof Promise?rdf.Promise=Promise:rdf.Promise=null,rdf.defaultRequest=null,rdf.corsProxyRequest=null,rdf.ns={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"},require("./lib/utils")(rdf),rdf.isNode?require("./lib/utils-node")(rdf):require("./lib/utils-browser")(rdf),"undefined"==typeof rdf.Graph&&(rdf.Graph={}),rdf.Graph.difference=function(a,b){var d=rdf.createGraph();return a.forEach(function(at){b.some(function(bt){return at.equals(bt)})||d.add(at)}),d},rdf.Graph.intersection=function(a,b){var i=rdf.createGraph();return a.forEach(function(at){b.some(function(bt){return at.equals(bt)})&&i.add(at)}),i},rdf.Graph.map=function(graph,callback){var result=[];return graph.forEach(function(triple){result.push(callback(triple))}),result},rdf.Graph.merge=function(a,b){var m=rdf.createGraph();return m.addAll(a),m.addAll(b),m},rdf.Graph.toString=function(a){var s="";return a.forEach(function(t){s+=t.toString()+"\n"}),s};var wrappedCreateGraph=rdf.createGraph.bind(rdf);return rdf.createGraphExt=function(triples){var graph=wrappedCreateGraph(triples);return graph.difference=rdf.Graph.difference.bind(graph,graph),graph.intersection=rdf.Graph.intersection.bind(graph,graph),graph.map=rdf.Graph.map.bind(graph,graph),graph.toString=rdf.Graph.toString.bind(graph,graph),"replaceMerge"in options&&options.replaceMerge&&(graph.merge=rdf.Graph.merge.bind(graph,graph)),graph},Object.defineProperty(rdf,"createGraph",{value:rdf.createGraphExt}),require("./lib/clownface.js")(rdf),require("./lib/promise.js")(rdf),rdf.createStore=function(options){return new InMemoryStore(rdf,options)},rdf.LdpStore=deprecatedError("LdpStore","rdf-store-ldp"),rdf.RdfstoreStore=deprecatedError("RdfstoreStore","rdf-store-rdfstore-js"),rdf.SingleGraphStore=deprecatedError("SingleGraphStore","rdf-store-singlegraph"),rdf.SparqlStore=deprecatedError("SparqlStore","rdf-store-sparql"),rdf};rdf.isNode||mixin(),module.exports=mixin}).call(this,require("_process"))},{"./lib/clownface.js":38,"./lib/promise.js":39,"./lib/utils":41,"./lib/utils-browser":40,"./lib/utils-node":void 0,_process:19,"rdf-interfaces":43,"rdf-store-inmemory":87}],43:[function(require,module,exports){rdf=function(){var rdf={};rdf.encodeString=function(s){for(var out="",skip=!1,_g1=0,_g=s.length;_g>_g1;){var i=_g1++;if(skip)skip=!skip;else{var code=s.charCodeAt(i);if(code>=55296&&56319>=code){var low=s.charCodeAt(i+1);code=1024*(code-55296)+(low-56320)+65536,skip=!0}if(code>1114111)throw new Error("Char out of range");var hex="00000000".concat(new Number(code).toString(16).toUpperCase());if(code>=65536)out+="\\U"+hex.slice(-8);else if(code>=127||31>=code)switch(code){case 9:out+="\\t";break;case 10:out+="\\n";break;case 13:out+="\\r";break;default:out+="\\u"+hex.slice(-4)}else switch(code){case 34:out+='\\"';break;case 92:out+="\\\\";break;default:out+=s.charAt(i)}}}return out},rdf.BlankNode=function(){return Object.defineProperties({},{interfaceName:{writable:!1,configurable:!1,enumerable:!0,value:"BlankNode"},nominalValue:{writable:!1,configurable:!1,enumerable:!0,value:"b".concat(++rdf.BlankNode.NEXTID)},valueOf:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this.nominalValue}},equals:{writable:!0,configurable:!1,enumerable:!0,value:function(o){return o.hasOwnProperty("interfaceName")?o.interfaceName==this.interfaceName?this.nominalValue==o.nominalValue:!1:"function"==typeof o&&"RegExp"==o.constructor.name?o.test(this.valueOf().toString()):this.valueOf()==o}},toString:{writable:!1,configurable:!1,enumerable:!0,value:function(){return"_:".concat(this.nominalValue)}},toNT:{writable:!1,configurable:!1,enumerable:!0,value:function(){return rdf.encodeString(this.toString())}},h:{configurable:!1,enumerable:!1,get:function(){return this.nominalValue}}})},rdf.BlankNode.NEXTID=0,rdf.NamedNode=function(iri){return Object.defineProperties({},{interfaceName:{writable:!1,configurable:!1,enumerable:!0,value:"NamedNode"},nominalValue:{writable:!1,configurable:!1,enumerable:!0,value:iri},valueOf:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this.nominalValue}},equals:{writable:!0,configurable:!1,enumerable:!0,value:function(o){return o.hasOwnProperty("interfaceName")?o.interfaceName==this.interfaceName?this.nominalValue==o.nominalValue:!1:"function"==typeof o&&"RegExp"==o.constructor.name?o.test(this.valueOf().toString()):this.valueOf()==o}},toString:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this.nominalValue.toString()}},toNT:{writable:!1,configurable:!1,enumerable:!0,value:function(){return"<"+rdf.encodeString(this.toString())+">"}},h:{configurable:!1,enumerable:!1,get:function(){return this.nominalValue}}})},rdf.Literal=function(value,language,datatype,nativ){return"string"==typeof language&&"@"==language[0]&&(language=language.slice(1)),Object.defineProperties({},{interfaceName:{writable:!1,configurable:!1,enumerable:!0,value:"Literal"},nominalValue:{writable:!1,configurable:!1,enumerable:!0,value:value},valueOf:{writable:!1,configurable:!1,enumerable:!0,value:function(){return null===nativ?this.nominalValue:nativ}},language:{writable:!1,configurable:!1,enumerable:!0,value:language},datatype:{writable:!1,configurable:!1,enumerable:!0,value:datatype},equals:{writable:!0,configurable:!1,enumerable:!0,value:function(o){return o.hasOwnProperty("interfaceName")?o.interfaceName!=this.interfaceName?!1:this.h==o.h:"function"==typeof o&&"RegExp"==o.constructor.name?o.test(this.valueOf().toString()):this.valueOf()==o}},toString:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this.nominalValue.toString()}},toNT:{writable:!1,configurable:!1,enumerable:!0,value:function(){var s='"'+rdf.encodeString(this.nominalValue)+'"';return Boolean(this.language).valueOf()?s.concat("@"+this.language):Boolean(this.datatype).valueOf()?s.concat("^^"+this.datatype.toNT()):s}},h:{writable:!1,configurable:!1,enumerable:!1,value:language+"|"+(datatype?datatype.toString():"")+"|"+value.toString()}})},rdf.Triple=function(s,p,o){return Object.defineProperties({},{subject:{writable:!1,configurable:!1,enumerable:!0,value:s},predicate:{writable:!1,configurable:!1,enumerable:!0,value:p},object:{writable:!1,configurable:!1,enumerable:!0,value:o},equals:{writable:!0,configurable:!1,enumerable:!0,value:function(t){return this.s.equals(t.s)&&this.p.equals(t.p)&&this.o.equals(t.o)}},toString:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this.s.toNT()+" "+this.p.toNT()+" "+this.o.toNT()+" ."}},s:{configurable:!1,enumerable:!1,get:function(){return this.subject}},p:{configurable:!1,enumerable:!1,get:function(){return this.predicate}},o:{configurable:!1,enumerable:!1,get:function(){return this.object}}})},rdf.Graph=function(a){return Object.defineProperties({},{_graph:{writable:!0,configurable:!1,enumerable:!1,value:[]},_spo:{writable:!0,configurable:!1,enumerable:!1,value:{}},length:{configurable:!1,enumerable:!0,get:function(){return this._graph.length}},add:{writable:!1,configurable:!1,enumerable:!0,value:function(t){return this._spo[t.s.h]||(this._spo[t.s.h]={}),this._spo[t.s.h][t.p.h]||(this._spo[t.s.h][t.p.h]={}),this._spo[t.s.h][t.p.h][t.o.h]||(this._spo[t.s.h][t.p.h][t.o.h]=t,this._graph.push(t),this.actions.forEach(function(a){a.run(t)})),this}},addArray:{writable:!1,configurable:!1,enumerable:!1,value:function(a){if(Array.isArray(a)){var g=this;a.forEach(function(t){g.add(t)})}return this}},remove:{writable:!1,configurable:!1,enumerable:!0,value:function(t){return this._spo[t.s.h]&&this._spo[t.s.h][t.p.h]&&this._spo[t.s.h][t.p.h][t.o.h]&&delete this._spo[t.s.h][t.p.h][t.o.h]&&this._graph.splice(this._graph.indexOf(t),1),this}},removeMatches:{writable:!1,configurable:!1,enumerable:!0,value:function(s,p,o){s=void 0===arguments[0]?null:s,p=void 0===arguments[1]?null:p,o=void 0===arguments[2]?null:o;var r=[];this.forEach(function(t,g){(null===s||t.s.equals(s))&&(null===p||t.p.equals(p))&&(null===o||t.o.equals(o))&&r.push(t)});for(var i in r)this.remove(r[i]);return this}},toArray:{writable:!1,configurable:!1,enumerable:!0,value:function(){return this._graph.slice(0)}},some:{writable:!1,configurable:!1,enumerable:!0,value:function(cb){return this._graph.some(cb)}},every:{writable:!1,configurable:!1,enumerable:!0,value:function(cb){return this._graph.every(cb)}},filter:{writable:!1,configurable:!1,enumerable:!0,value:function(cb){return new rdf.Graph(this._graph.filter(cb))}},forEach:{writable:!1,configurable:!1,enumerable:!0,value:function(cb){var g=this;this._graph.forEach(function(t){cb(t,g)})}},match:{writable:!1,configurable:!1,enumerable:!0,value:function(s,p,o,l){s=void 0===arguments[0]?null:s,p=void 0===arguments[1]?null:p,o=void 0===arguments[2]?null:o,l=void 0===arguments[3]?null:l;var c=0;return 1>l&&(l=-1),new rdf.Graph(this._graph.filter(function(t){return c==l?!1:(null===s||t.s.equals(s))&&(null===p||t.p.equals(p))&&(null===o||t.o.equals(o))&&++c}))}},merge:{writable:!1,configurable:!1,enumerable:!0,value:function(g){return(new rdf.Graph).addAll(this).addAll(g)}},addAll:{writable:!1,configurable:!1,enumerable:!0,value:function(g){return this.addArray(g.toArray())}},actions:{writable:!1,configurable:!1,enumerable:!0,value:[]},addAction:{writable:!1,configurable:!1,enumerable:!0,value:function(a,r){return r&&this.forEach(function(t,g){a.run(t,g)}),this.actions.push(a),this}}}).addArray(a)},rdf.TripleAction=function(test,action){return Object.defineProperties({},{action:{writable:!0,configurable:!1,enumerable:!0,value:action},test:{writable:!0,configurable:!1,enumerable:!0,value:test},run:{writable:!1,configurable:!1,enumerable:!0,value:function(t,g){this.test(t)&&this.action(t,g)}}})},rdf.PrefixMap=function(i){return Object.defineProperties({},{resolve:{writable:!1,configurable:!1,enumerable:!0,value:function(curie){var index=curie.indexOf(":");if(0>index||curie.indexOf("//")>=0)return null;var prefix=curie.slice(0,index).toLowerCase();return this[prefix]?this[prefix].concat(curie.slice(++index)):null}},shrink:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){for(pref in this)if(iri.substr(0,this[pref].length)==this[pref])return pref+":"+iri.slice(this[pref].length);return iri}},setDefault:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){this[""]=iri}},addAll:{writable:!1,configurable:!1,enumerable:!0,value:function(prefixes,override){for(p in prefixes)(!this[p]||override)&&(this[p]=prefixes[p]);return this}}}).addAll(i)},rdf.TermMap=function(i){return Object.defineProperties({},{resolve:{writable:!1,configurable:!1,enumerable:!0,value:function(term){return this[term]?this[term]:this[""]?this[""].concat(term):null}},shrink:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){for(t in this)if(this[t]==iri)return t;return iri}},setDefault:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){this[""]=iri}},addAll:{writable:!1,configurable:!1,enumerable:!0,value:function(terms,override){for(t in terms)(!this[t]||override)&&(this[t]=terms[t]);return this}}}).addAll(i)},rdf.Profile=function(i){return Object.defineProperties({},{prefixes:{writable:!1,configurable:!1,enumerable:!0,value:new rdf.PrefixMap},terms:{writable:!1,configurable:!1,enumerable:!0,value:new rdf.TermMap},resolve:{writable:!1,configurable:!1,enumerable:!0,value:function(tp){return tp.indexOf(":")>=0?this.prefixes.resolve(tp):this.terms.resolve(tp)}},setDefaultVocabulary:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){this.terms.setDefault(iri)}},setDefaultPrefix:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){this.prefixes.setDefault(iri)}},setTerm:{writable:!1,configurable:!1,enumerable:!0,value:function(term,iri){this.terms[term]=iri}},setPrefix:{writable:!1,configurable:!1,enumerable:!0,value:function(prefix,iri){this.prefixes[prefix]=iri}},importProfile:{writable:!1,configurable:!1,enumerable:!0,value:function(profile,override){return profile?(this.prefixes.addAll(profile.prefixes,override),this.terms.addAll(profile.terms,override),this):this}}}).importProfile(i)},rdf.RDFEnvironment=function(){var rp={terms:{},prefixes:{owl:"http://www.w3.org/2002/07/owl#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdfa:"http://www.w3.org/ns/rdfa#",xhv:"http://www.w3.org/1999/xhtml/vocab#",xml:"http://www.w3.org/XML/1998/namespace",xsd:"http://www.w3.org/2001/XMLSchema#"}},xsd={};for(v in x=["string","boolean","dateTime","date","time","int","double","float","decimal","integer","nonPositiveInteger","negativeInteger","long","int","short","byte","nonNegativeInteger","unsignedLong","unsignedInt","unsignedShort","unsignedByte","positiveInteger"])xsd[x[v]]=rp.prefixes.xsd.concat(x[v]);return Object.defineProperties(new rdf.Profile(rp),{createBlankNode:{writable:!1,configurable:!1,enumerable:!0,value:function(){return new rdf.BlankNode}},createNamedNode:{writable:!1,configurable:!1,enumerable:!0,value:function(iri){return new rdf.NamedNode(iri)}},createLiteral:{writable:!1,configurable:!1,enumerable:!0,value:function(value){var l=null,dt=arguments[2],v=value;if(arguments[1]&&(arguments[1].hasOwnProperty("interfaceName")?dt=arguments[1]:l=arguments[1]),dt)switch(dt.valueOf()){case xsd.string:v=new String(v);break;case xsd["boolean"]:v=new Boolean("false"==v?!1:v).valueOf();break;case xsd["float"]:case xsd.integer:case xsd["long"]:case xsd["double"]:case xsd.decimal:case xsd.nonPositiveInteger:case xsd.nonNegativeInteger:case xsd.negativeInteger:case xsd["int"]:case xsd.unsignedLong:case xsd.positiveInteger:case xsd["short"]:case xsd.unsignedInt:case xsd["byte"]:case xsd.unsignedShort:case xsd.unsignedByte:v=new Number(v).valueOf();break;case xsd.date:case xsd.time:case xsd.dateTime:v=new Date(v)}return new rdf.Literal(value,l,dt,v)}},createTriple:{writable:!1,configurable:!1,enumerable:!0,value:function(s,p,o){return new rdf.Triple(s,p,o)}},createGraph:{writable:!1,configurable:!0,enumerable:!0,value:function(a){return new rdf.Graph(a)}},createAction:{writable:!1,configurable:!1,enumerable:!0,value:function(t,a){return new rdf.TripleAction(t,a)}},createProfile:{writable:!1,configurable:!1,enumerable:!0,value:function(empty){return new rdf.Profile(empty?null:this)}},createTermMap:{writable:!1,configurable:!1,enumerable:!0,value:function(empty){return new rdf.TermMap(empty?null:this.terms)}},createPrefixMap:{writable:!1,configurable:!1,enumerable:!0,value:function(empty){return new rdf.PrefixMap(empty?null:this.prefixes)}}})};var _=new rdf.RDFEnvironment;return Object.keys(rdf).forEach(function(k){_[k]=rdf[k]}),rdf=_}(),"undefined"!=typeof module&&(module.exports=rdf)},{}],44:[function(require,module,exports){function AbstractParser(rdf){this.rdf=rdf}var concatStream=require("concat-stream"),util=require("util"),Readable=require("stream").Readable;AbstractParser.prototype.parse=function(data,callback,base,filter,graph){var self=this;graph=graph||self.rdf.createGraph();var pushTriple=function(triple){graph.add(triple)};return new Promise(function(resolve,reject){self.process(data,pushTriple,base,filter,function(error){callback&&(error?callback(error):callback(null,graph)),error?reject(error):resolve(graph)})})},AbstractParser.prototype.stream=function(inputStream,base,filter){var self=this,outputStream=new AbstractParser.TripleReadStream;return AbstractParser.streamToData(inputStream).then(function(data){self.process(data,function(triple){outputStream.push(triple)},base,filter,function(error){error?outputStream.emit("error",error):outputStream.emit("end")})})["catch"](function(error){outputStream.emit("error",error)}),outputStream},AbstractParser.streamToData=function(stream){return new Promise(function(resolve,reject){return"object"!=typeof stream||"function"!=typeof stream.read?resolve(stream):(stream.on("error",function(error){reject(error)}),void stream.pipe(concatStream(function(data){resolve(data)})))})},AbstractParser.TripleReadStream=function(){Readable.call(this,{objectMode:!0}),this._read=function(){return 0}},util.inherits(AbstractParser.TripleReadStream,Readable),module.exports=AbstractParser},{"concat-stream":45,stream:33,util:36}],45:[function(require,module,exports){(function(Buffer){function ConcatStream(opts,cb){if(!(this instanceof ConcatStream))return new ConcatStream(opts,cb);"function"==typeof opts&&(cb=opts,opts={}),opts||(opts={});var encoding=opts.encoding,shouldInferEncoding=!1;encoding?(encoding=String(encoding).toLowerCase(),("u8"===encoding||"uint8"===encoding)&&(encoding="uint8array")):shouldInferEncoding=!0,Writable.call(this,{objectMode:!0}),this.encoding=encoding,this.shouldInferEncoding=shouldInferEncoding,cb&&this.on("finish",function(){cb(this.getBody())}),this.body=[]}function isArrayish(arr){return/Array\]$/.test(Object.prototype.toString.call(arr))}function stringConcat(parts){for(var strings=[],i=0;i<parts.length;i++){var p=parts[i];"string"==typeof p?strings.push(p):Buffer.isBuffer(p)?strings.push(p):strings.push(Buffer(p))}return Buffer.isBuffer(parts[0])?(strings=Buffer.concat(strings),strings=strings.toString("utf8")):strings=strings.join(""),strings}function bufferConcat(parts){for(var bufs=[],i=0;i<parts.length;i++){var p=parts[i];Buffer.isBuffer(p)?bufs.push(p):"string"==typeof p||isArrayish(p)||p&&"function"==typeof p.subarray?bufs.push(Buffer(p)):bufs.push(Buffer(String(p)))}return Buffer.concat(bufs)}function arrayConcat(parts){for(var res=[],i=0;i<parts.length;i++)res.push.apply(res,parts[i]);return res}function u8Concat(parts){for(var len=0,i=0;i<parts.length;i++)"string"==typeof parts[i]&&(parts[i]=Buffer(parts[i])),len+=parts[i].length;for(var u8=new U8(len),i=0,offset=0;i<parts.length;i++)for(var part=parts[i],j=0;j<part.length;j++)u8[offset++]=part[j];return u8}var Writable=require("readable-stream").Writable,inherits=require("inherits");if("undefined"==typeof Uint8Array)var U8=require("typedarray").Uint8Array;else var U8=Uint8Array;module.exports=ConcatStream,inherits(ConcatStream,Writable),ConcatStream.prototype._write=function(chunk,enc,next){this.body.push(chunk),next()},ConcatStream.prototype.inferEncoding=function(buff){var firstBuffer=void 0===buff?this.body[0]:buff;return Buffer.isBuffer(firstBuffer)?"buffer":"undefined"!=typeof Uint8Array&&firstBuffer instanceof Uint8Array?"uint8array":Array.isArray(firstBuffer)?"array":"string"==typeof firstBuffer?"string":"[object Object]"===Object.prototype.toString.call(firstBuffer)?"object":"buffer"},ConcatStream.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?arrayConcat(this.body):"string"===this.encoding?stringConcat(this.body):"buffer"===this.encoding?bufferConcat(this.body):"uint8array"===this.encoding?u8Concat(this.body):this.body):[]};Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}}).call(this,require("buffer").Buffer)},{buffer:11,inherits:46,"readable-stream":57,typedarray:58}],46:[function(require,module,exports){arguments[4][16][0].apply(exports,arguments)},{dup:16}],47:[function(require,module,exports){arguments[4][21][0].apply(exports,arguments)},{"./_stream_readable":49,"./_stream_writable":51,"core-util-is":52,dup:21,inherits:46,"process-nextick-args":54}],48:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{"./_stream_transform":50,"core-util-is":52,dup:22,inherits:46}],49:[function(require,module,exports){(function(process){"use strict";function ReadableState(options,stream){var Duplex=require("./_stream_duplex");options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){require("./_stream_duplex");return this instanceof Readable?(this._readableState=new ReadableState(options,this),this.readable=!0,options&&"function"==typeof options.read&&(this._read=options.read),void Stream.call(this)):new Readable(options)}function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(null===chunk)state.reading=!1,onEofChunk(stream,state);else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var e=new Error("stream.unshift() after end event");stream.emit("error",e)}else!state.decoder||addToFront||encoding||(chunk=state.decoder.write(chunk)),addToFront||(state.reading=!1),state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state);else addToFront||(state.reading=!1);return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function roundUpToNextPowerOf2(n){if(n>=MAX_HWM)n=MAX_HWM;else{n--;for(var p=1;32>p;p<<=1)n|=n>>p;n++}return n}function howMuchToRead(n,state){return 0===state.length&&state.ended?0:state.objectMode?0===n?0:1:null===n||isNaN(n)?state.flowing&&state.buffer.length?state.buffer[0].length:state.length:0>=n?0:(n>state.highWaterMark&&(state.highWaterMark=roundUpToNextPowerOf2(n)),n>state.length?state.ended?state.length:(state.needReadable=!0,0):n)}function chunkInvalid(state,chunk){var er=null;return Buffer.isBuffer(chunk)||"string"==typeof chunk||null===chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EE.listenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;if(debug("flow",state.flowing),state.flowing)do var chunk=stream.read();while(null!==chunk&&state.flowing)}function fromList(n,state){var ret,list=state.buffer,length=state.length,stringMode=!!state.decoder,objectMode=!!state.objectMode;if(0===list.length)return null;if(0===length)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length)ret=stringMode?list.join(""):Buffer.concat(list,length),
list.length=0;else if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n),list[0]=buf.slice(n)}else if(n===list[0].length)ret=list.shift();else{ret=stringMode?"":new Buffer(n);for(var c=0,i=0,l=list.length;l>i&&n>c;i++){var buf=list[0],cpy=Math.min(n-c,buf.length);stringMode?ret+=buf.slice(0,cpy):buf.copy(ret,c,0,cpy),cpy<buf.length?list[0]=buf.slice(cpy):list.shift(),c+=cpy}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error("endReadable called on non-empty stream");state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function forEach(xs,f){for(var i=0,l=xs.length;l>i;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;l>i;i++)if(xs[i]===x)return i;return-1}module.exports=Readable;var processNextTick=require("process-nextick-args"),isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(emitter,type){return emitter.listeners(type).length});var Stream;!function(){try{Stream=require("stream")}catch(_){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,util=require("core-util-is");util.inherits=require("inherits");var debug=require("util");debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){};var StringDecoder;util.inherits(Readable,Stream),Readable.prototype.push=function(chunk,encoding){var state=this._readableState;return state.objectMode||"string"!=typeof chunk||(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=new Buffer(chunk,encoding),encoding="")),readableAddChunk(this,state,chunk,encoding,!1)},Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",!0)},Readable.prototype.isPaused=function(){return this._readableState.flowing===!1},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n);var state=this._readableState,nOrig=n;if(("number"!=typeof n||n>0)&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(n=howMuchToRead(n,state),0===n&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),(state.ended||state.reading)&&(doRead=!1,debug("reading or ended",doRead)),doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1),doRead&&!state.reading&&(n=howMuchToRead(nOrig,state));var ret;return ret=n>0?fromList(n,state):null,null===ret&&(state.needReadable=!0,n=0),state.length-=n,0!==state.length||state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&0===state.length&&endReadable(this),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable){debug("onunpipe"),readable===src&&cleanup()}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",cleanup),src.removeListener("data",ondata),!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata");var ret=dest.write(chunk);!1===ret&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EE.listenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==!1)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:cleanup;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);return dest.on("drain",ondrain),src.on("data",ondata),dest._events&&dest._events.error?isArray(dest._events.error)?dest._events.error.unshift(onerror):dest._events.error=[onerror,dest._events.error]:dest.on("error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState;if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;len>i;i++)dests[i].emit("unpipe",this);return this}var i=indexOf(state.pipes,dest);return-1===i?this:(state.pipes.splice(i,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev&&!1!==this._readableState.flowing&&this.resume(),"readable"===ev&&this.readable){var state=this._readableState;state.readableListening||(state.readableListening=!0,state.emittedReadable=!1,state.needReadable=!0,state.reading?state.length&&emitReadable(this,state):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){var ret=self.push(chunk);ret||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));var events=["error","close","destroy","pause","resume"];return forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))}),self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,require("_process"))},{"./_stream_duplex":47,_process:19,buffer:11,"core-util-is":52,events:15,inherits:46,isarray:53,"process-nextick-args":54,"string_decoder/":55,util:10}],50:[function(require,module,exports){arguments[4][24][0].apply(exports,arguments)},{"./_stream_duplex":47,"core-util-is":52,dup:24,inherits:46}],51:[function(require,module,exports){arguments[4][25][0].apply(exports,arguments)},{"./_stream_duplex":47,buffer:11,"core-util-is":52,dup:25,events:15,inherits:46,"process-nextick-args":54,"util-deprecate":56}],52:[function(require,module,exports){(function(Buffer){function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function isBuffer(arg){return Buffer.isBuffer(arg)}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=isBuffer}).call(this,require("buffer").Buffer)},{buffer:11}],53:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments)},{dup:17}],54:[function(require,module,exports){(function(process){"use strict";function nextTick(fn){for(var args=new Array(arguments.length-1),i=0;i<args.length;)args[i++]=arguments[i];process.nextTick(function(){fn.apply(null,args)})}module.exports=nextTick}).call(this,require("_process"))},{_process:19}],55:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:11,dup:34}],56:[function(require,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){if(!global.localStorage)return!1;var val=global.localStorage[name];return null==val?!1:"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],57:[function(require,module,exports){arguments[4][30][0].apply(exports,arguments)},{"./lib/_stream_duplex.js":47,"./lib/_stream_passthrough.js":48,"./lib/_stream_readable.js":49,"./lib/_stream_transform.js":50,"./lib/_stream_writable.js":51,dup:30}],58:[function(require,module,exports){function configureProperties(obj){if(getOwnPropNames&&defineProp){var i,props=getOwnPropNames(obj);for(i=0;i<props.length;i+=1)defineProp(obj,props[i],{value:obj[props[i]],writable:!1,enumerable:!1,configurable:!1})}}function makeArrayAccessors(obj){function makeArrayAccessor(index){defineProp(obj,index,{get:function(){return obj._getter(index)},set:function(v){obj._setter(index,v)},enumerable:!0,configurable:!1})}if(defineProp){if(obj.length>MAX_ARRAY_LENGTH)throw new RangeError("Array too large for polyfill");var i;for(i=0;i<obj.length;i+=1)makeArrayAccessor(i)}}function as_signed(value,bits){var s=32-bits;return value<<s>>s}function as_unsigned(value,bits){var s=32-bits;return value<<s>>>s}function packI8(n){return[255&n]}function unpackI8(bytes){return as_signed(bytes[0],8)}function packU8(n){return[255&n]}function unpackU8(bytes){return as_unsigned(bytes[0],8)}function packU8Clamped(n){return n=round(Number(n)),[0>n?0:n>255?255:255&n]}function packI16(n){return[n>>8&255,255&n]}function unpackI16(bytes){return as_signed(bytes[0]<<8|bytes[1],16)}function packU16(n){return[n>>8&255,255&n]}function unpackU16(bytes){return as_unsigned(bytes[0]<<8|bytes[1],16)}function packI32(n){return[n>>24&255,n>>16&255,n>>8&255,255&n]}function unpackI32(bytes){return as_signed(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packU32(n){return[n>>24&255,n>>16&255,n>>8&255,255&n]}function unpackU32(bytes){return as_unsigned(bytes[0]<<24|bytes[1]<<16|bytes[2]<<8|bytes[3],32)}function packIEEE754(v,ebits,fbits){function roundToEven(n){var w=floor(n),f=n-w;return.5>f?w:f>.5?w+1:w%2?w+1:w}var s,e,f,i,bits,str,bytes,bias=(1<<ebits-1)-1;for(v!==v?(e=(1<<ebits)-1,f=pow(2,fbits-1),s=0):v===1/0||v===-(1/0)?(e=(1<<ebits)-1,f=0,s=0>v?1:0):0===v?(e=0,f=0,s=1/v===-(1/0)?1:0):(s=0>v,v=abs(v),v>=pow(2,1-bias)?(e=min(floor(log(v)/LN2),1023),f=roundToEven(v/pow(2,e)*pow(2,fbits)),f/pow(2,fbits)>=2&&(e+=1,f=1),e>bias?(e=(1<<ebits)-1,f=0):(e+=bias,f-=pow(2,fbits))):(e=0,f=roundToEven(v/pow(2,1-bias-fbits)))),bits=[],i=fbits;i;i-=1)bits.push(f%2?1:0),f=floor(f/2);for(i=ebits;i;i-=1)bits.push(e%2?1:0),e=floor(e/2);for(bits.push(s?1:0),bits.reverse(),str=bits.join(""),bytes=[];str.length;)bytes.push(parseInt(str.substring(0,8),2)),str=str.substring(8);return bytes}function unpackIEEE754(bytes,ebits,fbits){var i,j,b,str,bias,s,e,f,bits=[];for(i=bytes.length;i;i-=1)for(b=bytes[i-1],j=8;j;j-=1)bits.push(b%2?1:0),b>>=1;return bits.reverse(),str=bits.join(""),bias=(1<<ebits-1)-1,s=parseInt(str.substring(0,1),2)?-1:1,e=parseInt(str.substring(1,1+ebits),2),f=parseInt(str.substring(1+ebits),2),e===(1<<ebits)-1?0!==f?NaN:s*(1/0):e>0?s*pow(2,e-bias)*(1+f/pow(2,fbits)):0!==f?s*pow(2,-(bias-1))*(f/pow(2,fbits)):0>s?-0:0}function unpackF64(b){return unpackIEEE754(b,11,52)}function packF64(v){return packIEEE754(v,11,52)}function unpackF32(b){return unpackIEEE754(b,8,23)}function packF32(v){return packIEEE754(v,8,23)}var defineProp,undefined=void 0,MAX_ARRAY_LENGTH=1e5,ECMAScript=function(){var opts=Object.prototype.toString,ophop=Object.prototype.hasOwnProperty;return{Class:function(v){return opts.call(v).replace(/^\[object *|\]$/g,"")},HasProperty:function(o,p){return p in o},HasOwnProperty:function(o,p){return ophop.call(o,p)},IsCallable:function(o){return"function"==typeof o},ToInt32:function(v){return v>>0},ToUint32:function(v){return v>>>0}}}(),LN2=Math.LN2,abs=Math.abs,floor=Math.floor,log=Math.log,min=Math.min,pow=Math.pow,round=Math.round;defineProp=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()?Object.defineProperty:function(o,p,desc){if(!o===Object(o))throw new TypeError("Object.defineProperty called on non-object");return ECMAScript.HasProperty(desc,"get")&&Object.prototype.__defineGetter__&&Object.prototype.__defineGetter__.call(o,p,desc.get),ECMAScript.HasProperty(desc,"set")&&Object.prototype.__defineSetter__&&Object.prototype.__defineSetter__.call(o,p,desc.set),ECMAScript.HasProperty(desc,"value")&&(o[p]=desc.value),o};var getOwnPropNames=Object.getOwnPropertyNames||function(o){if(o!==Object(o))throw new TypeError("Object.getOwnPropertyNames called on non-object");var p,props=[];for(p in o)ECMAScript.HasOwnProperty(o,p)&&props.push(p);return props};!function(){function makeConstructor(bytesPerElement,pack,unpack){var ctor;return ctor=function(buffer,byteOffset,length){var array,sequence,i,s;if(arguments.length&&"number"!=typeof arguments[0])if("object"==typeof arguments[0]&&arguments[0].constructor===ctor)for(array=arguments[0],this.length=array.length,this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)this._setter(i,array._getter(i));else if("object"!=typeof arguments[0]||(arguments[0]instanceof ArrayBuffer||"ArrayBuffer"===ECMAScript.Class(arguments[0]))){if("object"!=typeof arguments[0]||!(arguments[0]instanceof ArrayBuffer||"ArrayBuffer"===ECMAScript.Class(arguments[0])))throw new TypeError("Unexpected argument type(s)");if(this.buffer=buffer,this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(this.byteOffset%this.BYTES_PER_ELEMENT)throw new RangeError("ArrayBuffer length minus the byteOffset is not a multiple of the element size.");if(arguments.length<3){if(this.byteLength=this.buffer.byteLength-this.byteOffset,this.byteLength%this.BYTES_PER_ELEMENT)throw new RangeError("length of buffer minus byteOffset not a multiple of the element size");this.length=this.byteLength/this.BYTES_PER_ELEMENT}else this.length=ECMAScript.ToUint32(length),this.byteLength=this.length*this.BYTES_PER_ELEMENT;if(this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer")}else for(sequence=arguments[0],this.length=ECMAScript.ToUint32(sequence.length),this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0,i=0;i<this.length;i+=1)s=sequence[i],this._setter(i,Number(s));else{if(this.length=ECMAScript.ToInt32(arguments[0]),0>length)throw new RangeError("ArrayBufferView size is not a small enough positive integer");this.byteLength=this.length*this.BYTES_PER_ELEMENT,this.buffer=new ArrayBuffer(this.byteLength),this.byteOffset=0}this.constructor=ctor,configureProperties(this),makeArrayAccessors(this)},ctor.prototype=new ArrayBufferView,ctor.prototype.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._pack=pack,ctor.prototype._unpack=unpack,ctor.BYTES_PER_ELEMENT=bytesPerElement,ctor.prototype._getter=function(index){if(arguments.length<1)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),index>=this.length)return undefined;var i,o,bytes=[];for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)bytes.push(this.buffer._bytes[o]);return this._unpack(bytes)},ctor.prototype.get=ctor.prototype._getter,ctor.prototype._setter=function(index,value){if(arguments.length<2)throw new SyntaxError("Not enough arguments");if(index=ECMAScript.ToUint32(index),index>=this.length)return undefined;var i,o,bytes=this._pack(value);for(i=0,o=this.byteOffset+index*this.BYTES_PER_ELEMENT;i<this.BYTES_PER_ELEMENT;i+=1,o+=1)this.buffer._bytes[o]=bytes[i]},ctor.prototype.set=function(index,value){if(arguments.length<1)throw new SyntaxError("Not enough arguments");var array,sequence,offset,len,i,s,d,byteOffset,byteLength,tmp;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(array=arguments[0],offset=ECMAScript.ToUint32(arguments[1]),offset+array.length>this.length)throw new RangeError("Offset plus length of array is out of range");if(byteOffset=this.byteOffset+offset*this.BYTES_PER_ELEMENT,byteLength=array.length*this.BYTES_PER_ELEMENT,array.buffer===this.buffer){for(tmp=[],i=0,s=array.byteOffset;byteLength>i;i+=1,s+=1)tmp[i]=array.buffer._bytes[s];for(i=0,d=byteOffset;byteLength>i;i+=1,d+=1)this.buffer._bytes[d]=tmp[i]}else for(i=0,s=array.byteOffset,d=byteOffset;byteLength>i;i+=1,s+=1,d+=1)this.buffer._bytes[d]=array.buffer._bytes[s]}else{if("object"!=typeof arguments[0]||"undefined"==typeof arguments[0].length)throw new TypeError("Unexpected argument type(s)");if(sequence=arguments[0],len=ECMAScript.ToUint32(sequence.length),offset=ECMAScript.ToUint32(arguments[1]),offset+len>this.length)throw new RangeError("Offset plus length of array is out of range");for(i=0;len>i;i+=1)s=sequence[i],this._setter(offset+i,Number(s))}},ctor.prototype.subarray=function(start,end){function clamp(v,min,max){return min>v?min:v>max?max:v}start=ECMAScript.ToInt32(start),end=ECMAScript.ToInt32(end),arguments.length<1&&(start=0),arguments.length<2&&(end=this.length),0>start&&(start=this.length+start),0>end&&(end=this.length+end),start=clamp(start,0,this.length),end=clamp(end,0,this.length);var len=end-start;return 0>len&&(len=0),new this.constructor(this.buffer,this.byteOffset+start*this.BYTES_PER_ELEMENT,len)},ctor}var ArrayBuffer=function(length){if(length=ECMAScript.ToInt32(length),0>length)throw new RangeError("ArrayBuffer size is not a small enough positive integer");this.byteLength=length,this._bytes=[],this._bytes.length=length;var i;for(i=0;i<this.byteLength;i+=1)this._bytes[i]=0;configureProperties(this)};exports.ArrayBuffer=exports.ArrayBuffer||ArrayBuffer;var ArrayBufferView=function(){},Int8Array=makeConstructor(1,packI8,unpackI8),Uint8Array=makeConstructor(1,packU8,unpackU8),Uint8ClampedArray=makeConstructor(1,packU8Clamped,unpackU8),Int16Array=makeConstructor(2,packI16,unpackI16),Uint16Array=makeConstructor(2,packU16,unpackU16),Int32Array=makeConstructor(4,packI32,unpackI32),Uint32Array=makeConstructor(4,packU32,unpackU32),Float32Array=makeConstructor(4,packF32,unpackF32),Float64Array=makeConstructor(8,packF64,unpackF64);exports.Int8Array=exports.Int8Array||Int8Array,exports.Uint8Array=exports.Uint8Array||Uint8Array,exports.Uint8ClampedArray=exports.Uint8ClampedArray||Uint8ClampedArray,exports.Int16Array=exports.Int16Array||Int16Array,exports.Uint16Array=exports.Uint16Array||Uint16Array,exports.Int32Array=exports.Int32Array||Int32Array,exports.Uint32Array=exports.Uint32Array||Uint32Array,exports.Float32Array=exports.Float32Array||Float32Array,exports.Float64Array=exports.Float64Array||Float64Array}(),function(){function r(array,index){return ECMAScript.IsCallable(array.get)?array.get(index):array[index]}function makeGetter(arrayType){return function(byteOffset,littleEndian){if(byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");byteOffset+=this.byteOffset;var i,uint8Array=new exports.Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),bytes=[];for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(uint8Array,i));return Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),r(new arrayType(new exports.Uint8Array(bytes).buffer),0)}}function makeSetter(arrayType){return function(byteOffset,value,littleEndian){if(byteOffset=ECMAScript.ToUint32(byteOffset),byteOffset+arrayType.BYTES_PER_ELEMENT>this.byteLength)throw new RangeError("Array index out of range");var i,byteView,typeArray=new arrayType([value]),byteArray=new exports.Uint8Array(typeArray.buffer),bytes=[];for(i=0;i<arrayType.BYTES_PER_ELEMENT;i+=1)bytes.push(r(byteArray,i));Boolean(littleEndian)===Boolean(IS_BIG_ENDIAN)&&bytes.reverse(),byteView=new exports.Uint8Array(this.buffer,byteOffset,arrayType.BYTES_PER_ELEMENT),byteView.set(bytes)}}var IS_BIG_ENDIAN=function(){var u16array=new exports.Uint16Array([4660]),u8array=new exports.Uint8Array(u16array.buffer);return 18===r(u8array,0)}(),DataView=function(buffer,byteOffset,byteLength){if(0===arguments.length)buffer=new exports.ArrayBuffer(0);else if(!(buffer instanceof exports.ArrayBuffer||"ArrayBuffer"===ECMAScript.Class(buffer)))throw new TypeError("TypeError");if(this.buffer=buffer||new exports.ArrayBuffer(0),this.byteOffset=ECMAScript.ToUint32(byteOffset),this.byteOffset>this.buffer.byteLength)throw new RangeError("byteOffset out of range");if(arguments.length<3?this.byteLength=this.buffer.byteLength-this.byteOffset:this.byteLength=ECMAScript.ToUint32(byteLength),this.byteOffset+this.byteLength>this.buffer.byteLength)throw new RangeError("byteOffset and length reference an area beyond the end of the buffer");configureProperties(this)};DataView.prototype.getUint8=makeGetter(exports.Uint8Array),DataView.prototype.getInt8=makeGetter(exports.Int8Array),DataView.prototype.getUint16=makeGetter(exports.Uint16Array),DataView.prototype.getInt16=makeGetter(exports.Int16Array),DataView.prototype.getUint32=makeGetter(exports.Uint32Array),DataView.prototype.getInt32=makeGetter(exports.Int32Array),DataView.prototype.getFloat32=makeGetter(exports.Float32Array),DataView.prototype.getFloat64=makeGetter(exports.Float64Array),DataView.prototype.setUint8=makeSetter(exports.Uint8Array),DataView.prototype.setInt8=makeSetter(exports.Int8Array),DataView.prototype.setUint16=makeSetter(exports.Uint16Array),DataView.prototype.setInt16=makeSetter(exports.Int16Array),DataView.prototype.setUint32=makeSetter(exports.Uint32Array),DataView.prototype.setInt32=makeSetter(exports.Int32Array),DataView.prototype.setFloat32=makeSetter(exports.Float32Array),DataView.prototype.setFloat64=makeSetter(exports.Float64Array),exports.DataView=exports.DataView||DataView}()},{}],59:[function(require,module,exports){function DomParser(rdf){AbstractParser.call(this,rdf)}var util=require("util"),AbstractParser=require("rdf-parser-abstract");util.inherits(DomParser,AbstractParser),DomParser.prototype.parseHtmlDom=function(toparse,base){var parser=new DOMParser;return parser.parseFromString(toparse,"text/html")},DomParser.prototype.parseXmlDom=function(toparse,base){var parser=new DOMParser;return parser.parseFromString(toparse,"application/xml")},module.exports=DomParser},{"rdf-parser-abstract":44,util:36}],60:[function(require,module,exports){(function(process){process.browser?module.exports=require("./browser"):module.exports=require("./node")}).call(this,require("_process"))},{"./browser":59,"./node":61,_process:19}],61:[function(require,module,exports){function DomParser(rdf){AbstractParser.call(this,rdf)}var util=require("util"),xmldom=require("xmldom"),AbstractParser=require("rdf-parser-abstract");util.inherits(DomParser,AbstractParser),DomParser.prototype.parseHtmlDom=function(toparse,base){var parser=new xmldom.DOMParser;return parser.options.errorHandler={warning:function(){},error:function(){},fatalError:function(){}},parser.parseFromString(toparse,"text/html")},DomParser.prototype.parseXmlDom=function(toparse,base){var parser=new xmldom.DOMParser;return parser.options.errorHandler={warning:function(){},error:function(){},fatalError:function(){}},parser.parseFromString(toparse,"application/xml")},module.exports=DomParser},{"rdf-parser-abstract":44,util:36,xmldom:62}],62:[function(require,module,exports){function DOMParser(options){this.options=options||{locator:{}}}function buildErrorHandler(errorImpl,domBuilder,locator){function build(key){var fn=errorImpl[key];if(!fn)if(isCallback)fn=2==errorImpl.length?function(msg){errorImpl(key,msg)}:errorImpl;else for(var i=arguments.length;--i&&!(fn=errorImpl[arguments[i]]););errorHandler[key]=fn&&function(msg){fn(msg+_locator(locator))}||function(){}}if(!errorImpl){if(domBuilder instanceof DOMHandler)return domBuilder;errorImpl=domBuilder}var errorHandler={},isCallback=errorImpl instanceof Function;return locator=locator||{},build("warning","warn"),build("error","warn","warning"),build("fatalError","warn","warning","error"),errorHandler}function DOMHandler(){this.cdata=!1}function position(locator,node){node.lineNumber=locator.lineNumber,node.columnNumber=locator.columnNumber}function _locator(l){return l?"\n@"+(l.systemId||"")+"#[line:"+l.lineNumber+",col:"+l.columnNumber+"]":void 0}function _toString(chars,start,length){return"string"==typeof chars?chars.substr(start,length):chars.length>=start+length||start?new java.lang.String(chars,start,length)+"":chars}function appendElement(hander,node){hander.currentElement?hander.currentElement.appendChild(node):hander.document.appendChild(node)}if(DOMParser.prototype.parseFromString=function(source,mimeType){var options=this.options,sax=new XMLReader,domBuilder=options.domBuilder||new DOMHandler,errorHandler=options.errorHandler,locator=options.locator,defaultNSMap=options.xmlns||{},entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return locator&&domBuilder.setDocumentLocator(locator),sax.errorHandler=buildErrorHandler(errorHandler,domBuilder,locator),sax.domBuilder=options.domBuilder||domBuilder,/\/x?html?$/.test(mimeType)&&(entityMap.nbsp=" ",entityMap.copy="©",defaultNSMap[""]="http://www.w3.org/1999/xhtml"),source?sax.parse(source,defaultNSMap,entityMap):sax.errorHandler.error("invalid document source"),domBuilder.document},DOMHandler.prototype={startDocument:function(){this.document=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.document.documentURI=this.locator.systemId)},startElement:function(namespaceURI,localName,qName,attrs){var doc=this.document,el=doc.createElementNS(namespaceURI,qName||localName),len=attrs.length;appendElement(this,el),this.currentElement=el,this.locator&&position(this.locator,el);for(var i=0;len>i;i++){var namespaceURI=attrs.getURI(i),value=attrs.getValue(i),qName=attrs.getQName(i),attr=doc.createAttributeNS(namespaceURI,qName);attr.getOffset&&position(attr.getOffset(1),attr),attr.value=attr.nodeValue=value,el.setAttributeNode(attr)}},endElement:function(namespaceURI,localName,qName){var current=this.currentElement;current.tagName;this.currentElement=current.parentNode},startPrefixMapping:function(prefix,uri){},endPrefixMapping:function(prefix){},processingInstruction:function(target,data){var ins=this.document.createProcessingInstruction(target,data);this.locator&&position(this.locator,ins),appendElement(this,ins)},ignorableWhitespace:function(ch,start,length){},characters:function(chars,start,length){if(chars=_toString.apply(this,arguments),this.currentElement&&chars){if(this.cdata){var charNode=this.document.createCDATASection(chars);this.currentElement.appendChild(charNode)}else{var charNode=this.document.createTextNode(chars);this.currentElement.appendChild(charNode)}this.locator&&position(this.locator,charNode)}},skippedEntity:function(name){},endDocument:function(){this.document.normalize()},setDocumentLocator:function(locator){(this.locator=locator)&&(locator.lineNumber=0)},comment:function(chars,start,length){chars=_toString.apply(this,arguments);var comm=this.document.createComment(chars);this.locator&&position(this.locator,comm),appendElement(this,comm)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(name,publicId,systemId){var impl=this.document.implementation;if(impl&&impl.createDocumentType){var dt=impl.createDocumentType(name,publicId,systemId);this.locator&&position(this.locator,dt),appendElement(this,dt)}},warning:function(error){console.warn(error,_locator(this.locator))},error:function(error){console.error(error,_locator(this.locator))},fatalError:function(error){throw console.error(error,_locator(this.locator)),error}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(key){DOMHandler.prototype[key]=function(){return null}}),"function"==typeof require){var XMLReader=require("./sax").XMLReader,DOMImplementation=exports.DOMImplementation=require("./dom").DOMImplementation;exports.XMLSerializer=require("./dom").XMLSerializer,exports.DOMParser=DOMParser}},{"./dom":63,"./sax":64}],63:[function(require,module,exports){function copy(src,dest){for(var p in src)dest[p]=src[p]}function _extends(Class,Super){function t(){}var pt=Class.prototype;if(Object.create){var ppt=Object.create(Super.prototype);pt.__proto__=ppt}pt instanceof Super||(t.prototype=Super.prototype,t=new t,copy(pt,t),Class.prototype=pt=t),pt.constructor!=Class&&("function"!=typeof Class&&console.error("unknow Class:"+Class),pt.constructor=Class)}function DOMException(code,message){if(message instanceof Error)var error=message;else error=this,Error.call(this,ExceptionMessage[code]),this.message=ExceptionMessage[code],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return error.code=code,message&&(this.message=this.message+": "+message),error}function NodeList(){}function LiveNodeList(node,refresh){
this._node=node,this._refresh=refresh,_updateLiveList(this)}function _updateLiveList(list){var inc=list._node._inc||list._node.ownerDocument._inc;if(list._inc!=inc){var ls=list._refresh(list._node);__set__(list,"length",ls.length),copy(ls,list),list._inc=inc}}function NamedNodeMap(){}function _findNodeIndex(list,node){for(var i=list.length;i--;)if(list[i]===node)return i}function _addNamedNode(el,list,newAttr,oldAttr){if(oldAttr?list[_findNodeIndex(list,oldAttr)]=newAttr:list[list.length++]=newAttr,el){newAttr.ownerElement=el;var doc=el.ownerDocument;doc&&(oldAttr&&_onRemoveAttribute(doc,el,oldAttr),_onAddAttribute(doc,el,newAttr))}}function _removeNamedNode(el,list,attr){var i=_findNodeIndex(list,attr);if(!(i>=0))throw DOMException(NOT_FOUND_ERR,new Error);for(var lastIndex=list.length-1;lastIndex>i;)list[i]=list[++i];if(list.length=lastIndex,el){var doc=el.ownerDocument;doc&&(_onRemoveAttribute(doc,el,attr),attr.ownerElement=null)}}function DOMImplementation(features){if(this._features={},features)for(var feature in features)this._features=features[feature]}function Node(){}function _xmlEncoder(c){return"<"==c&&"&lt;"||">"==c&&"&gt;"||"&"==c&&"&amp;"||'"'==c&&"&quot;"||"&#"+c.charCodeAt()+";"}function _visitNode(node,callback){if(callback(node))return!0;if(node=node.firstChild)do if(_visitNode(node,callback))return!0;while(node=node.nextSibling)}function Document(){}function _onAddAttribute(doc,el,newAttr){doc&&doc._inc++;var ns=newAttr.namespaceURI;"http://www.w3.org/2000/xmlns/"==ns&&(el._nsMap[newAttr.prefix?newAttr.localName:""]=newAttr.value)}function _onRemoveAttribute(doc,el,newAttr,remove){doc&&doc._inc++;var ns=newAttr.namespaceURI;"http://www.w3.org/2000/xmlns/"==ns&&delete el._nsMap[newAttr.prefix?newAttr.localName:""]}function _onUpdateChild(doc,el,newChild){if(doc&&doc._inc){doc._inc++;var cs=el.childNodes;if(newChild)cs[cs.length++]=newChild;else{for(var child=el.firstChild,i=0;child;)cs[i++]=child,child=child.nextSibling;cs.length=i}}}function _removeChild(parentNode,child){var previous=child.previousSibling,next=child.nextSibling;return previous?previous.nextSibling=next:parentNode.firstChild=next,next?next.previousSibling=previous:parentNode.lastChild=previous,_onUpdateChild(parentNode.ownerDocument,parentNode),child}function _insertBefore(parentNode,newChild,nextChild){var cp=newChild.parentNode;if(cp&&cp.removeChild(newChild),newChild.nodeType===DOCUMENT_FRAGMENT_NODE){var newFirst=newChild.firstChild;if(null==newFirst)return newChild;var newLast=newChild.lastChild}else newFirst=newLast=newChild;var pre=nextChild?nextChild.previousSibling:parentNode.lastChild;newFirst.previousSibling=pre,newLast.nextSibling=nextChild,pre?pre.nextSibling=newFirst:parentNode.firstChild=newFirst,null==nextChild?parentNode.lastChild=newLast:nextChild.previousSibling=newLast;do newFirst.parentNode=parentNode;while(newFirst!==newLast&&(newFirst=newFirst.nextSibling));return _onUpdateChild(parentNode.ownerDocument||parentNode,parentNode),newChild.nodeType==DOCUMENT_FRAGMENT_NODE&&(newChild.firstChild=newChild.lastChild=null),newChild}function _appendSingleChild(parentNode,newChild){var cp=newChild.parentNode;if(cp){var pre=parentNode.lastChild;cp.removeChild(newChild);var pre=parentNode.lastChild}var pre=parentNode.lastChild;return newChild.parentNode=parentNode,newChild.previousSibling=pre,newChild.nextSibling=null,pre?pre.nextSibling=newChild:parentNode.firstChild=newChild,parentNode.lastChild=newChild,_onUpdateChild(parentNode.ownerDocument,parentNode,newChild),newChild}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function serializeToString(node,buf){switch(node.nodeType){case ELEMENT_NODE:var attrs=node.attributes,len=attrs.length,child=node.firstChild,nodeName=node.tagName,isHTML=htmlns===node.namespaceURI;buf.push("<",nodeName);for(var i=0;len>i;i++)serializeToString(attrs.item(i),buf,isHTML);if(child||isHTML&&!/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){if(buf.push(">"),isHTML&&/^script$/i.test(nodeName))child&&buf.push(child.data);else for(;child;)serializeToString(child,buf),child=child.nextSibling;buf.push("</",nodeName,">")}else buf.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var child=node.firstChild;child;)serializeToString(child,buf),child=child.nextSibling;return;case ATTRIBUTE_NODE:return buf.push(" ",node.name,'="',node.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return buf.push(node.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return buf.push("<![CDATA[",node.data,"]]>");case COMMENT_NODE:return buf.push("<!--",node.data,"-->");case DOCUMENT_TYPE_NODE:var pubid=node.publicId,sysid=node.systemId;if(buf.push("<!DOCTYPE ",node.name),pubid)buf.push(' PUBLIC "',pubid),sysid&&"."!=sysid&&buf.push('" "',sysid),buf.push('">');else if(sysid&&"."!=sysid)buf.push(' SYSTEM "',sysid,'">');else{var sub=node.internalSubset;sub&&buf.push(" [",sub,"]"),buf.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return buf.push("<?",node.target," ",node.data,"?>");case ENTITY_REFERENCE_NODE:return buf.push("&",node.nodeName,";");default:buf.push("??",node.nodeName)}}function importNode(doc,node,deep){var node2;switch(node.nodeType){case ELEMENT_NODE:node2=node.cloneNode(!1),node2.ownerDocument=doc;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:deep=!0}if(node2||(node2=node.cloneNode(!1)),node2.ownerDocument=doc,node2.parentNode=null,deep)for(var child=node.firstChild;child;)node2.appendChild(importNode(doc,child,deep)),child=child.nextSibling;return node2}function cloneNode(doc,node,deep){var node2=new node.constructor;for(var n in node){var v=node[n];"object"!=typeof v&&v!=node2[n]&&(node2[n]=v)}switch(node.childNodes&&(node2.childNodes=new NodeList),node2.ownerDocument=doc,node2.nodeType){case ELEMENT_NODE:var attrs=node.attributes,attrs2=node2.attributes=new NamedNodeMap,len=attrs.length;attrs2._ownerElement=node2;for(var i=0;len>i;i++)node2.setAttributeNode(cloneNode(doc,attrs.item(i),!0));break;case ATTRIBUTE_NODE:deep=!0}if(deep)for(var child=node.firstChild;child;)node2.appendChild(cloneNode(doc,child,deep)),child=child.nextSibling;return node2}function __set__(object,key,value){object[key]=value}function getTextContent(node){switch(node.nodeType){case 1:case 11:var buf=[];for(node=node.firstChild;node;)7!==node.nodeType&&8!==node.nodeType&&buf.push(getTextContent(node)),node=node.nextSibling;return buf.join("");default:return node.nodeValue}}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},NOT_FOUND_ERR=(ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3),ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8)),INUSE_ATTRIBUTE_ERR=(ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10));ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(index){return this[index]||null}},LiveNodeList.prototype.item=function(i){return _updateLiveList(this),this[i]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(key){for(var i=this.length;i--;){var attr=this[i];if(attr.nodeName==key)return attr}},setNamedItem:function(attr){var el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var oldAttr=this.getNamedItem(attr.nodeName);return _addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},setNamedItemNS:function(attr){var oldAttr,el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return oldAttr=this.getNamedItemNS(attr.namespaceURI,attr.localName),_addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},removeNamedItem:function(key){var attr=this.getNamedItem(key);return _removeNamedNode(this._ownerElement,this,attr),attr},removeNamedItemNS:function(namespaceURI,localName){var attr=this.getNamedItemNS(namespaceURI,localName);return _removeNamedNode(this._ownerElement,this,attr),attr},getNamedItemNS:function(namespaceURI,localName){for(var i=this.length;i--;){var node=this[i];if(node.localName==localName&&node.namespaceURI==namespaceURI)return node}return null}},DOMImplementation.prototype={hasFeature:function(feature,version){var versions=this._features[feature.toLowerCase()];return versions&&(!version||version in versions)?!0:!1},createDocument:function(namespaceURI,qualifiedName,doctype){var doc=new Document;if(doc.doctype=doctype,doctype&&doc.appendChild(doctype),doc.implementation=this,doc.childNodes=new NodeList,qualifiedName){var root=doc.createElementNS(namespaceURI,qualifiedName);doc.appendChild(root)}return doc},createDocumentType:function(qualifiedName,publicId,systemId){var node=new DocumentType;return node.name=qualifiedName,node.nodeName=qualifiedName,node.publicId=publicId,node.systemId=systemId,node}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(newChild,refChild){return _insertBefore(this,newChild,refChild)},replaceChild:function(newChild,oldChild){this.insertBefore(newChild,oldChild),oldChild&&this.removeChild(oldChild)},removeChild:function(oldChild){return _removeChild(this,oldChild)},appendChild:function(newChild){return this.insertBefore(newChild,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(deep){return cloneNode(this.ownerDocument||this,this,deep)},normalize:function(){for(var child=this.firstChild;child;){var next=child.nextSibling;next&&next.nodeType==TEXT_NODE&&child.nodeType==TEXT_NODE?(this.removeChild(next),child.appendData(next.data)):(child.normalize(),child=next)}},isSupported:function(feature,version){return this.ownerDocument.implementation.hasFeature(feature,version)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(namespaceURI){for(var el=this;el;){var map=el._nsMap;if(map)for(var n in map)if(map[n]==namespaceURI)return n;el=2==el.nodeType?el.ownerDocument:el.parentNode}return null},lookupNamespaceURI:function(prefix){for(var el=this;el;){var map=el._nsMap;if(map&&prefix in map)return map[prefix];el=2==el.nodeType?el.ownerDocument:el.parentNode}return null},isDefaultNamespace:function(namespaceURI){var prefix=this.lookupPrefix(namespaceURI);return null==prefix}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(newChild,refChild){if(newChild.nodeType==DOCUMENT_FRAGMENT_NODE){for(var child=newChild.firstChild;child;){var next=child.nextSibling;this.insertBefore(child,refChild),child=next}return newChild}return null==this.documentElement&&1==newChild.nodeType&&(this.documentElement=newChild),_insertBefore(this,newChild,refChild),newChild.ownerDocument=this,newChild},removeChild:function(oldChild){return this.documentElement==oldChild&&(this.documentElement=null),_removeChild(this,oldChild)},importNode:function(importedNode,deep){return importNode(this,importedNode,deep)},getElementById:function(id){var rtv=null;return _visitNode(this.documentElement,function(node){return 1==node.nodeType&&node.getAttribute("id")==id?(rtv=node,!0):void 0}),rtv},createElement:function(tagName){var node=new Element;node.ownerDocument=this,node.nodeName=tagName,node.tagName=tagName,node.childNodes=new NodeList;var attrs=node.attributes=new NamedNodeMap;return attrs._ownerElement=node,node},createDocumentFragment:function(){var node=new DocumentFragment;return node.ownerDocument=this,node.childNodes=new NodeList,node},createTextNode:function(data){var node=new Text;return node.ownerDocument=this,node.appendData(data),node},createComment:function(data){var node=new Comment;return node.ownerDocument=this,node.appendData(data),node},createCDATASection:function(data){var node=new CDATASection;return node.ownerDocument=this,node.appendData(data),node},createProcessingInstruction:function(target,data){var node=new ProcessingInstruction;return node.ownerDocument=this,node.tagName=node.target=target,node.nodeValue=node.data=data,node},createAttribute:function(name){var node=new Attr;return node.ownerDocument=this,node.name=name,node.nodeName=name,node.localName=name,node.specified=!0,node},createEntityReference:function(name){var node=new EntityReference;return node.ownerDocument=this,node.nodeName=name,node},createElementNS:function(namespaceURI,qualifiedName){var node=new Element,pl=qualifiedName.split(":"),attrs=node.attributes=new NamedNodeMap;return node.childNodes=new NodeList,node.ownerDocument=this,node.nodeName=qualifiedName,node.tagName=qualifiedName,node.namespaceURI=namespaceURI,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,attrs._ownerElement=node,node},createAttributeNS:function(namespaceURI,qualifiedName){var node=new Attr,pl=qualifiedName.split(":");return node.ownerDocument=this,node.nodeName=qualifiedName,node.name=qualifiedName,node.namespaceURI=namespaceURI,node.specified=!0,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,node}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(name){return null!=this.getAttributeNode(name)},getAttribute:function(name){var attr=this.getAttributeNode(name);return attr&&attr.value||""},getAttributeNode:function(name){return this.attributes.getNamedItem(name)},setAttribute:function(name,value){var attr=this.ownerDocument.createAttribute(name);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},removeAttribute:function(name){var attr=this.getAttributeNode(name);attr&&this.removeAttributeNode(attr)},appendChild:function(newChild){return newChild.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(newChild,null):_appendSingleChild(this,newChild)},setAttributeNode:function(newAttr){return this.attributes.setNamedItem(newAttr)},setAttributeNodeNS:function(newAttr){return this.attributes.setNamedItemNS(newAttr)},removeAttributeNode:function(oldAttr){return this.attributes.removeNamedItem(oldAttr.nodeName)},removeAttributeNS:function(namespaceURI,localName){var old=this.getAttributeNodeNS(namespaceURI,localName);old&&this.removeAttributeNode(old)},hasAttributeNS:function(namespaceURI,localName){return null!=this.getAttributeNodeNS(namespaceURI,localName)},getAttributeNS:function(namespaceURI,localName){var attr=this.getAttributeNodeNS(namespaceURI,localName);return attr&&attr.value||""},setAttributeNS:function(namespaceURI,qualifiedName,value){var attr=this.ownerDocument.createAttributeNS(namespaceURI,qualifiedName);attr.value=attr.nodeValue=value,this.setAttributeNode(attr)},getAttributeNodeNS:function(namespaceURI,localName){return this.attributes.getNamedItemNS(namespaceURI,localName)},getElementsByTagName:function(tagName){return new LiveNodeList(this,function(base){var ls=[];return _visitNode(base,function(node){node===base||node.nodeType!=ELEMENT_NODE||"*"!==tagName&&node.tagName!=tagName||ls.push(node)}),ls})},getElementsByTagNameNS:function(namespaceURI,localName){return new LiveNodeList(this,function(base){var ls=[];return _visitNode(base,function(node){node===base||node.nodeType!==ELEMENT_NODE||node.namespaceURI!==namespaceURI||"*"!==localName&&node.localName!=localName||ls.push(node)}),ls})}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(offset,count){return this.data.substring(offset,offset+count)},appendData:function(text){text=this.data+text,this.nodeValue=this.data=text,this.length=text.length},insertData:function(offset,text){this.replaceData(offset,0,text)},appendChild:function(newChild){throw new Error(ExceptionMessage[3])},deleteData:function(offset,count){this.replaceData(offset,count,"")},replaceData:function(offset,count,text){var start=this.data.substring(0,offset),end=this.data.substring(offset+count);text=start+text+end,this.nodeValue=this.data=text,this.length=text.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(offset){var text=this.data,newText=text.substring(offset);text=text.substring(0,offset),this.data=this.nodeValue=text,this.length=text.length;var newNode=this.ownerDocument.createTextNode(newText);return this.parentNode&&this.parentNode.insertBefore(newNode,this.nextSibling),newNode}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(node){var buf=[];return serializeToString(node,buf),buf.join("")},Node.prototype.toString=function(){return XMLSerializer.prototype.serializeToString(this)};try{Object.defineProperty&&(Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(data){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(data||String(data))&&this.appendChild(this.ownerDocument.createTextNode(data));break;default:this.data=data,this.value=value,this.nodeValue=data}}}),__set__=function(object,key,value){object["$$"+key]=value})}catch(e){}"function"==typeof require&&(exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer)},{}],64:[function(require,module,exports){function XMLReader(){}function parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){function fixedFromCharCode(code){if(code>65535){code-=65536;var surrogate1=55296+(code>>10),surrogate2=56320+(1023&code);return String.fromCharCode(surrogate1,surrogate2)}return String.fromCharCode(code)}function entityReplacer(a){var k=a.slice(1,-1);return k in entityMap?entityMap[k]:"#"===k.charAt(0)?fixedFromCharCode(parseInt(k.substr(1).replace("x","0x"))):(errorHandler.error("entity not found:"+a),a)}function appendText(end){var xt=source.substring(start,end).replace(/&#?\w+;/g,entityReplacer);locator&&position(start),domBuilder.characters(xt,0,end-start),start=end}function position(start,m){for(;start>=endPos&&(m=linePattern.exec(source));)startPos=m.index,endPos=startPos+m[0].length,locator.lineNumber++;locator.columnNumber=start-startPos+1}for(var startPos=0,endPos=0,linePattern=/.+(?:\r\n?|\n)|.*$/g,locator=domBuilder.locator,parseStack=[{currentNSMap:defaultNSMapCopy}],closeMap={},start=0;;){var i=source.indexOf("<",start);if(0>i){if(!source.substr(start).match(/^\s*$/)){var doc=domBuilder.document,text=doc.createTextNode(source.substr(start));doc.appendChild(text),domBuilder.currentElement=text}return}switch(i>start&&appendText(i),source.charAt(i+1)){case"/":var end=source.indexOf(">",i+3),tagName=source.substring(i+2,end),config=parseStack.pop(),localNSMap=config.localNSMap;if(config.tagName!=tagName&&errorHandler.fatalError("end tag name: "+tagName+" is not match the current start tagName:"+config.tagName),domBuilder.endElement(config.uri,config.localName,tagName),localNSMap)for(var prefix in localNSMap)domBuilder.endPrefixMapping(prefix);end++;break;case"?":locator&&position(i),end=parseInstruction(source,i,domBuilder);break;case"!":locator&&position(i),end=parseDCC(source,i,domBuilder,errorHandler);break;default:try{locator&&position(i);var el=new ElementAttributes,end=parseElementStartPart(source,i,el,entityReplacer,errorHandler),len=el.length;if(len&&locator){for(var backup=copyLocator(locator,{}),i=0;len>i;i++){var a=el[i];position(a.offset),a.offset=copyLocator(locator,{})}copyLocator(backup,locator)}!el.closed&&fixSelfClosed(source,end,el.tagName,closeMap)&&(el.closed=!0,entityMap.nbsp||errorHandler.warning("unclosed xml attribute")),appendElement(el,domBuilder,parseStack),"http://www.w3.org/1999/xhtml"!==el.uri||el.closed?end++:end=parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)}catch(e){errorHandler.error("element parse error: "+e),end=-1}}0>end?appendText(i+1):start=end}}function copyLocator(f,t){return t.lineNumber=f.lineNumber,t.columnNumber=f.columnNumber,t}function parseElementStartPart(source,start,el,entityReplacer,errorHandler){for(var attrName,value,p=++start,s=S_TAG;;){var c=source.charAt(p);switch(c){case"=":if(s===S_ATTR)attrName=source.slice(start,p),s=S_EQ;else{if(s!==S_ATTR_S)throw new Error("attribute equal must after attrName");s=S_EQ}break;case"'":case'"':if(s===S_EQ){if(start=p+1,p=source.indexOf(c,start),!(p>0))throw new Error("attribute value no end '"+c+"' match");value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start-1),s=S_E}else{if(s!=S_V)throw new Error('attribute value must after "="');value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start),errorHandler.warning('attribute "'+attrName+'" missed start quot('+c+")!!"),start=p+1,s=S_E}break;case"/":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_E:case S_S:case S_C:s=S_C,el.closed=!0;case S_V:case S_ATTR:case S_ATTR_S:break;default:throw new Error("attribute invalid close char('/')")}break;case"":errorHandler.error("unexpected end of input");case">":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_E:case S_S:case S_C:break;case S_V:case S_ATTR:value=source.slice(start,p),"/"===value.slice(-1)&&(el.closed=!0,value=value.slice(0,-1));case S_ATTR_S:s===S_ATTR_S&&(value=attrName),s==S_V?(errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value.replace(/&#?\w+;/g,entityReplacer),start)):(errorHandler.warning('attribute "'+value+'" missed value!! "'+value+'" instead!!'),el.add(value,value,start));break;case S_EQ:throw new Error("attribute value missed!!")}return p;case"":c=" ";default:if(" ">=c)switch(s){case S_TAG:el.setTagName(source.slice(start,p)),s=S_S;break;case S_ATTR:attrName=source.slice(start,p),s=S_ATTR_S;break;case S_V:var value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer);errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value,start);case S_E:s=S_S}else switch(s){case S_ATTR_S:errorHandler.warning('attribute "'+attrName+'" missed value!! "'+attrName+'" instead!!'),el.add(attrName,attrName,start),start=p,s=S_ATTR;break;case S_E:errorHandler.warning('attribute space is required"'+attrName+'"!!');case S_S:s=S_ATTR,start=p;break;case S_EQ:s=S_V,start=p;break;case S_C:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function appendElement(el,domBuilder,parseStack){for(var tagName=el.tagName,localNSMap=null,currentNSMap=parseStack[parseStack.length-1].currentNSMap,i=el.length;i--;){var a=el[i],qName=a.qName,value=a.value,nsp=qName.indexOf(":");if(nsp>0)var prefix=a.prefix=qName.slice(0,nsp),localName=qName.slice(nsp+1),nsPrefix="xmlns"===prefix&&localName;else localName=qName,prefix=null,nsPrefix="xmlns"===qName&&"";a.localName=localName,nsPrefix!==!1&&(null==localNSMap&&(localNSMap={},_copy(currentNSMap,currentNSMap={})),currentNSMap[nsPrefix]=localNSMap[nsPrefix]=value,a.uri="http://www.w3.org/2000/xmlns/",domBuilder.startPrefixMapping(nsPrefix,value))}for(var i=el.length;i--;){a=el[i];var prefix=a.prefix;prefix&&("xml"===prefix&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==prefix&&(a.uri=currentNSMap[prefix]))}var nsp=tagName.indexOf(":");nsp>0?(prefix=el.prefix=tagName.slice(0,nsp),localName=el.localName=tagName.slice(nsp+1)):(prefix=null,localName=el.localName=tagName);var ns=el.uri=currentNSMap[prefix||""];if(domBuilder.startElement(ns,localName,tagName,el),el.closed){if(domBuilder.endElement(ns,localName,tagName),localNSMap)for(prefix in localNSMap)domBuilder.endPrefixMapping(prefix)}else el.currentNSMap=currentNSMap,el.localNSMap=localNSMap,parseStack.push(el)}function parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){if(/^(?:script|textarea)$/i.test(tagName)){var elEndStart=source.indexOf("</"+tagName+">",elStartEnd),text=source.substring(elStartEnd+1,elEndStart);if(/[&<]/.test(text))return/^script$/i.test(tagName)?(domBuilder.characters(text,0,text.length),elEndStart):(text=text.replace(/&#?\w+;/g,entityReplacer),domBuilder.characters(text,0,text.length),elEndStart)}return elStartEnd+1}function fixSelfClosed(source,elStartEnd,tagName,closeMap){var pos=closeMap[tagName];return null==pos&&(pos=closeMap[tagName]=source.lastIndexOf("</"+tagName+">")),elStartEnd>pos}function _copy(source,target){for(var n in source)target[n]=source[n]}function parseDCC(source,start,domBuilder,errorHandler){var next=source.charAt(start+2);switch(next){case"-":if("-"===source.charAt(start+3)){var end=source.indexOf("-->",start+4);return end>start?(domBuilder.comment(source,start+4,end-start-4),end+3):(errorHandler.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==source.substr(start+3,6)){var end=source.indexOf("]]>",start+9);return domBuilder.startCDATA(),domBuilder.characters(source,start+9,end-start-9),domBuilder.endCDATA(),end+3}var matchs=split(source,start),len=matchs.length;if(len>1&&/!doctype/i.test(matchs[0][0])){var name=matchs[1][0],pubid=len>3&&/^public$/i.test(matchs[2][0])&&matchs[3][0],sysid=len>4&&matchs[4][0],lastMatch=matchs[len-1];return domBuilder.startDTD(name,pubid&&pubid.replace(/^(['"])(.*?)\1$/,"$2"),sysid&&sysid.replace(/^(['"])(.*?)\1$/,"$2")),domBuilder.endDTD(),lastMatch.index+lastMatch[0].length}}return-1}function parseInstruction(source,start,domBuilder){var end=source.indexOf("?>",start);if(end){var match=source.substring(start,end).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(match){match[0].length;return domBuilder.processingInstruction(match[1],match[2]),end+2}return-1}return-1}function ElementAttributes(source){}function _set_proto_(thiz,parent){return thiz.__proto__=parent,thiz}function split(source,start){var match,buf=[],reg=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(reg.lastIndex=start,reg.exec(source);match=reg.exec(source);)if(buf.push(match),match[1])return buf}var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"·̀-ͯ\\ux203F-⁀]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_S=2,S_EQ=3,S_V=4,S_E=5,S_S=6,S_C=7;XMLReader.prototype={parse:function(source,defaultNSMap,entityMap){var domBuilder=this.domBuilder;domBuilder.startDocument(),_copy(defaultNSMap,defaultNSMap={}),parse(source,defaultNSMap,entityMap,domBuilder,this.errorHandler),domBuilder.endDocument()}},ElementAttributes.prototype={setTagName:function(tagName){if(!tagNamePattern.test(tagName))throw new Error("invalid tagName:"+tagName);this.tagName=tagName},add:function(qName,value,offset){if(!tagNamePattern.test(qName))throw new Error("invalid attribute:"+qName);this[this.length++]={qName:qName,value:value,offset:offset}},length:0,getLocalName:function(i){return this[i].localName},getOffset:function(i){return this[i].offset},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(thiz,parent){function p(){}p.prototype=parent,p=new p;for(parent in thiz)p[parent]=thiz[parent];return p}),"function"==typeof require&&(exports.XMLReader=XMLReader)},{}],65:[function(require,module,exports){var jsonld=require("jsonld"),rdf=require("rdf-ext")(),util=require("util"),AbstractParser=require("rdf-parser-abstract"),JsonLdParser=function(options){AbstractParser.call(this,rdf),options=options||{},"importPrefixMap"in options||(options.importPrefixMap=!0);var expandAndFlatten=function(data,base,callback){jsonld.expand(data,{base:base},function(error,expanded){return error?callback(error):void jsonld.flatten(expanded,{},function(error,flattened){return error?callback(error):"@graph"in flattened?void callback(null,flattened["@graph"]):callback(new Error("no @graph property in flattened JSON-LD"))})})},toArray=function(object){return object=object||[],Array.isArray(object)?object:[object]};this.process=function(data,callback,base,filter,done){return new Promise(function(resolve,reject){"string"==typeof data&&(data=JSON.parse(data)),base=base||"",filter=filter||function(){return!0},done=done||function(){};var getLiteral=function(jsonNode){var type=null,lang=null;return"@type"in jsonNode&&(type=getNode(jsonNode["@type"])),"@language"in jsonNode&&(lang=jsonNode["@language"]),rdf.createLiteral(jsonNode["@value"],lang,type)},nodeCache={},getNode=function(jsonNode){return jsonNode in nodeCache?nodeCache[jsonNode]:jsonNode?0===jsonNode.indexOf("_:")?nodeCache[jsonNode]=rdf.createBlankNode():nodeCache[jsonNode]=rdf.createNamedNode(jsonNode):rdf.createBlankNode()},pushTriple=function(subject,predicate,object){var triple=rdf.createTriple(subject,predicate,object);filter(triple)&&callback(triple)},processSubject=function(jsonSubject){var subject=jsonSubject["@id"],types=toArray(jsonSubject["@type"]);types.forEach(function(type){pushTriple(getNode(subject),getNode(rdf.ns.type),getNode(type))});for(var predicate in jsonSubject)0!==predicate.indexOf("@")&&processPredicate(subject,predicate,toArray(jsonSubject[predicate]));
},processPredicate=function(subject,predicate,jsonObjects){jsonObjects.forEach(function(jsonObject){pushTriple(getNode(subject),getNode(predicate),processObject(jsonObject))})},processObject=function(jsonObject){return"string"==typeof jsonObject?rdf.createLiteral(jsonObject):"@id"in jsonObject?getNode(jsonObject["@id"]):"@list"in jsonObject?processList(jsonObject["@list"]):getLiteral(jsonObject)},processList=function(jsonList){var rest,entry=getNode(),subject=entry;return jsonList.forEach(function(jItem,index){rest=index!==jsonList.length-1?getNode():getNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"),pushTriple(subject,getNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"),getNode(jItem["@id"])),pushTriple(subject,getNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"),rest),subject=rest}),entry};if(options.importPrefixMap&&"@context"in data&&"object"==typeof data["@context"]){var context=data["@context"];Object.keys(context).forEach(function(key){"@"!==key.slice(0,1)&&"string"==typeof context[key]&&(rdf.prefixes[key]=context[key])})}expandAndFlatten(data,base,function(error,jsonGraph){return error?(done&&done(error),reject(error)):(jsonGraph&&jsonGraph.forEach(function(jsonSubject){processSubject(jsonSubject)}),done&&done(),void resolve())})})}};util.inherits(JsonLdParser,AbstractParser);var instance=new JsonLdParser;for(var property in instance)JsonLdParser[property]=instance[property];module.exports=JsonLdParser},{jsonld:67,"rdf-ext":42,"rdf-parser-abstract":44,util:36}],66:[function(require,module,exports){},{}],67:[function(require,module,exports){(function(process,global,__dirname){!function(){var _nodejs="undefined"!=typeof process&&process.versions&&process.versions.node,_browser=!_nodejs&&("undefined"!=typeof window||"undefined"!=typeof self);_browser&&"undefined"==typeof global&&("undefined"!=typeof window?global=window:"undefined"!=typeof self?global=self:"undefined"!=typeof $&&(global=$));var wrapper=function(jsonld){function JsonLdProcessor(){}function _expandLanguageMap(languageMap){for(var rval=[],keys=Object.keys(languageMap).sort(),ki=0;ki<keys.length;++ki){var key=keys[ki],val=languageMap[key];_isArray(val)||(val=[val]);for(var vi=0;vi<val.length;++vi){var item=val[vi];if(!_isString(item))throw new JsonLdError("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:languageMap});rval.push({"@value":item,"@language":key.toLowerCase()})}}return rval}function _labelBlankNodes(namer,element){if(_isArray(element))for(var i=0;i<element.length;++i)element[i]=_labelBlankNodes(namer,element[i]);else if(_isList(element))element["@list"]=_labelBlankNodes(namer,element["@list"]);else if(_isObject(element)){_isBlankNode(element)&&(element["@id"]=namer.getName(element["@id"]));for(var keys=Object.keys(element).sort(),ki=0;ki<keys.length;++ki){var key=keys[ki];"@id"!==key&&(element[key]=_labelBlankNodes(namer,element[key]))}}return element}function _expandValue(activeCtx,activeProperty,value){if(null===value||void 0===value)return null;var expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:!0});if("@id"===expandedProperty)return _expandIri(activeCtx,value,{base:!0});if("@type"===expandedProperty)return _expandIri(activeCtx,value,{vocab:!0,base:!0});var type=jsonld.getContextValue(activeCtx,activeProperty,"@type");if("@id"===type||"@graph"===expandedProperty&&_isString(value))return{"@id":_expandIri(activeCtx,value,{base:!0})};if("@vocab"===type)return{"@id":_expandIri(activeCtx,value,{vocab:!0,base:!0})};if(_isKeyword(expandedProperty))return value;var rval={};if(null!==type)rval["@type"]=type;else if(_isString(value)){var language=jsonld.getContextValue(activeCtx,activeProperty,"@language");null!==language&&(rval["@language"]=language)}return-1===["boolean","number","string"].indexOf(typeof value)&&(value=value.toString()),rval["@value"]=value,rval}function _graphToRDF(graph,namer,options){for(var rval=[],ids=Object.keys(graph).sort(),i=0;i<ids.length;++i)for(var id=ids[i],node=graph[id],properties=Object.keys(node).sort(),pi=0;pi<properties.length;++pi){var property=properties[pi],items=node[property];if("@type"===property)property=RDF_TYPE;else if(_isKeyword(property))continue;for(var ii=0;ii<items.length;++ii){var item=items[ii],subject={};if(subject.type=0===id.indexOf("_:")?"blank node":"IRI",subject.value=id,_isAbsoluteIri(id)){var predicate={};if(predicate.type=0===property.indexOf("_:")?"blank node":"IRI",predicate.value=property,_isAbsoluteIri(property)&&("blank node"!==predicate.type||options.produceGeneralizedRdf))if(_isList(item))_listToRDF(item["@list"],namer,subject,predicate,rval);else{var object=_objectToRDF(item);object&&rval.push({subject:subject,predicate:predicate,object:object})}}}}return rval}function _listToRDF(list,namer,subject,predicate,triples){for(var first={type:"IRI",value:RDF_FIRST},rest={type:"IRI",value:RDF_REST},nil={type:"IRI",value:RDF_NIL},i=0;i<list.length;++i){var item=list[i],blankNode={type:"blank node",value:namer.getName()};triples.push({subject:subject,predicate:predicate,object:blankNode}),subject=blankNode,predicate=first;var object=_objectToRDF(item);object&&triples.push({subject:subject,predicate:predicate,object:object}),predicate=rest}triples.push({subject:subject,predicate:predicate,object:nil})}function _objectToRDF(item){var object={};if(_isValue(item)){object.type="literal";var value=item["@value"],datatype=item["@type"]||null;_isBoolean(value)?(object.value=value.toString(),object.datatype=datatype||XSD_BOOLEAN):_isDouble(value)||datatype===XSD_DOUBLE?(_isDouble(value)||(value=parseFloat(value)),object.value=value.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),object.datatype=datatype||XSD_DOUBLE):_isNumber(value)?(object.value=value.toFixed(0),object.datatype=datatype||XSD_INTEGER):"@language"in item?(object.value=value,object.datatype=datatype||RDF_LANGSTRING,object.language=item["@language"]):(object.value=value,object.datatype=datatype||XSD_STRING)}else{var id=_isObject(item)?item["@id"]:item;object.type=0===id.indexOf("_:")?"blank node":"IRI",object.value=id}return"IRI"!==object.type||_isAbsoluteIri(object.value)?object:null}function _RDFToObject(o,useNativeTypes){if("IRI"===o.type||"blank node"===o.type)return{"@id":o.value};var rval={"@value":o.value};if(o.language)rval["@language"]=o.language;else{var type=o.datatype;if(type||(type=XSD_STRING),useNativeTypes){if(type===XSD_BOOLEAN)"true"===rval["@value"]?rval["@value"]=!0:"false"===rval["@value"]&&(rval["@value"]=!1);else if(_isNumeric(rval["@value"]))if(type===XSD_INTEGER){var i=parseInt(rval["@value"],10);i.toFixed(0)===rval["@value"]&&(rval["@value"]=i)}else type===XSD_DOUBLE&&(rval["@value"]=parseFloat(rval["@value"]));-1===[XSD_BOOLEAN,XSD_INTEGER,XSD_DOUBLE,XSD_STRING].indexOf(type)&&(rval["@type"]=type)}else type!==XSD_STRING&&(rval["@type"]=type)}return rval}function _compareRDFTriples(t1,t2){for(var attrs=["subject","predicate","object"],i=0;i<attrs.length;++i){var attr=attrs[i];if(t1[attr].type!==t2[attr].type||t1[attr].value!==t2[attr].value)return!1}return t1.object.language!==t2.object.language?!1:t1.object.datatype!==t2.object.datatype?!1:!0}function _hashQuads(id,bnodes){if("hash"in bnodes[id])return bnodes[id].hash;for(var quads=bnodes[id].quads,nquads=[],i=0;i<quads.length;++i)nquads.push(_toNQuad(quads[i],quads[i].name?quads[i].name.value:null,id));nquads.sort();var hash=bnodes[id].hash=sha1.hash(nquads);return hash}function _hashPaths(id,bnodes,namer,pathNamer,callback){function groupNodes(i){if(i===quads.length)return groupHashes=Object.keys(groups).sort(),hashGroup(0);var quad=quads[i],bnode=_getAdjacentBlankNodeName(quad.subject,id),direction=null;if(null!==bnode?direction="p":(bnode=_getAdjacentBlankNodeName(quad.object,id),null!==bnode&&(direction="r")),null!==bnode){var name;name=namer.isNamed(bnode)?namer.getName(bnode):pathNamer.isNamed(bnode)?pathNamer.getName(bnode):_hashQuads(bnode,bnodes);var md=sha1.create();md.update(direction),md.update(quad.predicate.value),md.update(name);var groupHash=md.digest();groupHash in groups?groups[groupHash].push(bnode):groups[groupHash]=[bnode]}jsonld.setImmediate(function(){groupNodes(i+1)})}function hashGroup(i){function permutate(){function nextRecursion(n){if(n===recurse.length)return nextPermutation(!1);var bnode=recurse[n];_hashPaths(bnode,bnodes,namer,pathNamerCopy,function(err,result){return err?callback(err):(path+=pathNamerCopy.getName(bnode)+"<"+result.hash+">",pathNamerCopy=result.pathNamer,null!==chosenPath&&path.length>=chosenPath.length&&path>chosenPath?nextPermutation(!0):void nextRecursion(n+1))})}function nextPermutation(skipped){!skipped&&(null===chosenPath||chosenPath>path)&&(chosenPath=path,chosenNamer=pathNamerCopy),permutator.hasNext()?jsonld.setImmediate(function(){permutate()}):(md.update(chosenPath),pathNamer=chosenNamer,hashGroup(i+1))}var permutation=permutator.next(),pathNamerCopy=pathNamer.clone(),path="",recurse=[];for(var n in permutation){var bnode=permutation[n];if(namer.isNamed(bnode)?path+=namer.getName(bnode):(pathNamerCopy.isNamed(bnode)||recurse.push(bnode),path+=pathNamerCopy.getName(bnode)),null!==chosenPath&&path.length>=chosenPath.length&&path>chosenPath)return nextPermutation(!0)}nextRecursion(0)}if(i===groupHashes.length)return callback(null,{hash:md.digest(),pathNamer:pathNamer});var groupHash=groupHashes[i];md.update(groupHash);var chosenPath=null,chosenNamer=null,permutator=new Permutator(groups[groupHash]);jsonld.setImmediate(function(){permutate()})}var groupHashes,md=sha1.create(),groups={},quads=bnodes[id].quads;jsonld.setImmediate(function(){groupNodes(0)})}function _getAdjacentBlankNodeName(node,id){return"blank node"===node.type&&node.value!==id?node.value:null}function _createNodeMap(input,graphs,graph,namer,name,list){if(_isArray(input))for(var i=0;i<input.length;++i)_createNodeMap(input[i],graphs,graph,namer,void 0,list);else{if(!_isObject(input))return void(list&&list.push(input));if(_isValue(input)){if("@type"in input){var type=input["@type"];0===type.indexOf("_:")&&(input["@type"]=type=namer.getName(type))}return void(list&&list.push(input))}if("@type"in input)for(var types=input["@type"],i=0;i<types.length;++i){var type=types[i];0===type.indexOf("_:")&&namer.getName(type)}_isUndefined(name)&&(name=_isBlankNode(input)?namer.getName(input["@id"]):input["@id"]),list&&list.push({"@id":name});var subjects=graphs[graph],subject=subjects[name]=subjects[name]||{};subject["@id"]=name;for(var properties=Object.keys(input).sort(),pi=0;pi<properties.length;++pi){var property=properties[pi];if("@id"!==property)if("@reverse"!==property)if("@graph"!==property)if("@type"!==property&&_isKeyword(property)){if("@index"===property&&property in subject&&(input[property]!==subject[property]||input[property]["@id"]!==subject[property]["@id"]))throw new JsonLdError("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:subject});subject[property]=input[property]}else{var objects=input[property];if(0===property.indexOf("_:")&&(property=namer.getName(property)),0!==objects.length)for(var oi=0;oi<objects.length;++oi){var o=objects[oi];if("@type"===property&&(o=0===o.indexOf("_:")?namer.getName(o):o),_isSubject(o)||_isSubjectReference(o)){var id=_isBlankNode(o)?namer.getName(o["@id"]):o["@id"];jsonld.addValue(subject,property,{"@id":id},{propertyIsArray:!0,allowDuplicate:!1}),_createNodeMap(o,graphs,graph,namer,id)}else if(_isList(o)){var _list=[];_createNodeMap(o["@list"],graphs,graph,namer,name,_list),o={"@list":_list},jsonld.addValue(subject,property,o,{propertyIsArray:!0,allowDuplicate:!1})}else _createNodeMap(o,graphs,graph,namer,name),jsonld.addValue(subject,property,o,{propertyIsArray:!0,allowDuplicate:!1})}else jsonld.addValue(subject,property,[],{propertyIsArray:!0})}else{name in graphs||(graphs[name]={});var g="@merged"===graph?graph:name;_createNodeMap(input[property],graphs,g,namer)}else{var referencedNode={"@id":name},reverseMap=input["@reverse"];for(var reverseProperty in reverseMap)for(var items=reverseMap[reverseProperty],ii=0;ii<items.length;++ii){var item=items[ii],itemName=item["@id"];_isBlankNode(item)&&(itemName=namer.getName(itemName)),_createNodeMap(item,graphs,graph,namer,itemName),jsonld.addValue(subjects[itemName],reverseProperty,referencedNode,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function _mergeNodeMaps(graphs){for(var defaultGraph=graphs["@default"],graphNames=Object.keys(graphs).sort(),i=0;i<graphNames.length;++i){var graphName=graphNames[i];if("@default"!==graphName){var nodeMap=graphs[graphName],subject=defaultGraph[graphName];subject?"@graph"in subject||(subject["@graph"]=[]):defaultGraph[graphName]=subject={"@id":graphName,"@graph":[]};for(var graph=subject["@graph"],ids=Object.keys(nodeMap).sort(),ii=0;ii<ids.length;++ii){var node=nodeMap[ids[ii]];_isSubjectReference(node)||graph.push(node)}}}return defaultGraph}function _frame(state,subjects,frame,parent,property){_validateFrame(frame),frame=frame[0];for(var options=state.options,flags={embed:_getFrameFlag(frame,options,"embed"),explicit:_getFrameFlag(frame,options,"explicit"),requireAll:_getFrameFlag(frame,options,"requireAll")},matches=_filterSubjects(state,subjects,frame,flags),ids=Object.keys(matches).sort(),idx=0;idx<ids.length;++idx){var id=ids[idx],subject=matches[id];if("@link"===flags.embed&&id in state.link)_addFrameOutput(parent,property,state.link[id]);else{null===property&&(state.uniqueEmbeds={});var output={};if(output["@id"]=id,state.link[id]=output,"@never"===flags.embed||_createsCircularReference(subject,state.subjectStack))_addFrameOutput(parent,property,output);else{"@last"===flags.embed&&(id in state.uniqueEmbeds&&_removeEmbed(state,id),state.uniqueEmbeds[id]={parent:parent,property:property}),state.subjectStack.push(subject);for(var props=Object.keys(subject).sort(),i=0;i<props.length;i++){var prop=props[i];if(_isKeyword(prop))output[prop]=_clone(subject[prop]);else if(!flags.explicit||prop in frame)for(var objects=subject[prop],oi=0;oi<objects.length;++oi){var o=objects[oi];if(_isList(o)){var list={"@list":[]};_addFrameOutput(output,prop,list);var src=o["@list"];for(var n in src)if(o=src[n],_isSubjectReference(o)){var subframe=prop in frame?frame[prop][0]["@list"]:_createImplicitFrame(flags);_frame(state,[o["@id"]],subframe,list,"@list")}else _addFrameOutput(list,"@list",_clone(o))}else if(_isSubjectReference(o)){var subframe=prop in frame?frame[prop]:_createImplicitFrame(flags);_frame(state,[o["@id"]],subframe,output,prop)}else _addFrameOutput(output,prop,_clone(o))}}for(var props=Object.keys(frame).sort(),i=0;i<props.length;++i){var prop=props[i];if(!_isKeyword(prop)){var next=frame[prop][0],omitDefaultOn=_getFrameFlag(next,options,"omitDefault");if(!(omitDefaultOn||prop in output)){var preserve="@null";"@default"in next&&(preserve=_clone(next["@default"])),_isArray(preserve)||(preserve=[preserve]),output[prop]=[{"@preserve":preserve}]}}}_addFrameOutput(parent,property,output),state.subjectStack.pop()}}}}function _createImplicitFrame(flags){var frame={};for(var key in flags)void 0!==flags[key]&&(frame["@"+key]=[flags[key]]);return[frame]}function _createsCircularReference(subjectToEmbed,subjectStack){for(var i=subjectStack.length-1;i>=0;--i)if(subjectStack[i]["@id"]===subjectToEmbed["@id"])return!0;return!1}function _getFrameFlag(frame,options,name){var flag="@"+name,rval=flag in frame?frame[flag][0]:options[name];return"embed"===name&&(rval===!0?rval="@last":rval===!1?rval="@never":"@always"!==rval&&"@never"!==rval&&"@link"!==rval&&(rval="@last")),rval}function _validateFrame(frame){if(!_isArray(frame)||1!==frame.length||!_isObject(frame[0]))throw new JsonLdError("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:frame})}function _filterSubjects(state,subjects,frame,flags){for(var rval={},i=0;i<subjects.length;++i){var id=subjects[i],subject=state.subjects[id];_filterSubject(subject,frame,flags)&&(rval[id]=subject)}return rval}function _filterSubject(subject,frame,flags){if("@type"in frame&&(1!==frame["@type"].length||!_isObject(frame["@type"][0]))){for(var types=frame["@type"],i=0;i<types.length;++i)if(jsonld.hasValue(subject,"@type",types[i]))return!0;return!1}var wildcard=!0,matchesSome=!1;for(var key in frame){if(_isKeyword(key)){if("@id"!==key&&"@type"!==key)continue;if(wildcard=!1,"@id"===key&&_isString(frame[key])){if(subject[key]!==frame[key])return!1;matchesSome=!0;continue}}if(wildcard=!1,key in subject){if(_isArray(frame[key])&&0===frame[key].length&&void 0!==subject[key])return!1;matchesSome=!0}else{var hasDefault=_isArray(frame[key])&&_isObject(frame[key][0])&&"@default"in frame[key][0];if(flags.requireAll&&!hasDefault)return!1}}return wildcard||matchesSome}function _removeEmbed(state,id){var embeds=state.uniqueEmbeds,embed=embeds[id],parent=embed.parent,property=embed.property,subject={"@id":id};if(_isArray(parent)){for(var i=0;i<parent.length;++i)if(jsonld.compareValues(parent[i],subject)){parent[i]=subject;break}}else{var useArray=_isArray(parent[property]);jsonld.removeValue(parent,property,subject,{propertyIsArray:useArray}),jsonld.addValue(parent,property,subject,{propertyIsArray:useArray})}var removeDependents=function(id){for(var ids=Object.keys(embeds),i=0;i<ids.length;++i){var next=ids[i];next in embeds&&_isObject(embeds[next].parent)&&embeds[next].parent["@id"]===id&&(delete embeds[next],removeDependents(next))}};removeDependents(id)}function _addFrameOutput(parent,property,output){_isObject(parent)?jsonld.addValue(parent,property,output,{propertyIsArray:!0}):parent.push(output)}function _removePreserve(ctx,input,options){if(_isArray(input)){for(var output=[],i=0;i<input.length;++i){var result=_removePreserve(ctx,input[i],options);null!==result&&output.push(result)}input=output}else if(_isObject(input)){if("@preserve"in input)return"@null"===input["@preserve"]?null:input["@preserve"];if(_isValue(input))return input;if(_isList(input))return input["@list"]=_removePreserve(ctx,input["@list"],options),input;var idAlias=_compactIri(ctx,"@id");if(idAlias in input){var id=input[idAlias];if(id in options.link){var idx=options.link[id].indexOf(input);if(-1!==idx)return options.link[id][idx];options.link[id].push(input)}else options.link[id]=[input]}for(var prop in input){var result=_removePreserve(ctx,input[prop],options),container=jsonld.getContextValue(ctx,prop,"@container");options.compactArrays&&_isArray(result)&&1===result.length&&null===container&&(result=result[0]),input[prop]=result}}return input}function _compareShortestLeast(a,b){return a.length<b.length?-1:b.length<a.length?1:a===b?0:b>a?-1:1}function _selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue){null===typeOrLanguageValue&&(typeOrLanguageValue="@null");var prefs=[];if("@id"!==typeOrLanguageValue&&"@reverse"!==typeOrLanguageValue||!_isSubjectReference(value))prefs.push(typeOrLanguageValue);else{"@reverse"===typeOrLanguageValue&&prefs.push("@reverse");var term=_compactIri(activeCtx,value["@id"],null,{vocab:!0});term in activeCtx.mappings&&activeCtx.mappings[term]&&activeCtx.mappings[term]["@id"]===value["@id"]?prefs.push.apply(prefs,["@vocab","@id"]):prefs.push.apply(prefs,["@id","@vocab"])}prefs.push("@none");for(var containerMap=activeCtx.inverse[iri],ci=0;ci<containers.length;++ci){var container=containers[ci];if(container in containerMap)for(var typeOrLanguageValueMap=containerMap[container][typeOrLanguage],pi=0;pi<prefs.length;++pi){var pref=prefs[pi];if(pref in typeOrLanguageValueMap)return typeOrLanguageValueMap[pref]}}return null}function _compactIri(activeCtx,iri,value,relativeTo,reverse){if(null===iri)return iri;if(_isUndefined(value)&&(value=null),_isUndefined(reverse)&&(reverse=!1),relativeTo=relativeTo||{},_isKeyword(iri)&&(relativeTo.vocab=!0),relativeTo.vocab&&iri in activeCtx.getInverse()){var defaultLanguage=activeCtx["@language"]||"@none",containers=[];_isObject(value)&&"@index"in value&&containers.push("@index");var typeOrLanguage="@language",typeOrLanguageValue="@null";if(reverse)typeOrLanguage="@type",typeOrLanguageValue="@reverse",containers.push("@set");else if(_isList(value)){"@index"in value||containers.push("@list");for(var list=value["@list"],commonLanguage=0===list.length?defaultLanguage:null,commonType=null,i=0;i<list.length;++i){var item=list[i],itemLanguage="@none",itemType="@none";if(_isValue(item)?"@language"in item?itemLanguage=item["@language"]:"@type"in item?itemType=item["@type"]:itemLanguage="@null":itemType="@id",null===commonLanguage?commonLanguage=itemLanguage:itemLanguage!==commonLanguage&&_isValue(item)&&(commonLanguage="@none"),null===commonType?commonType=itemType:itemType!==commonType&&(commonType="@none"),"@none"===commonLanguage&&"@none"===commonType)break}commonLanguage=commonLanguage||"@none",commonType=commonType||"@none","@none"!==commonType?(typeOrLanguage="@type",typeOrLanguageValue=commonType):typeOrLanguageValue=commonLanguage}else _isValue(value)?"@language"in value&&!("@index"in value)?(containers.push("@language"),typeOrLanguageValue=value["@language"]):"@type"in value&&(typeOrLanguage="@type",typeOrLanguageValue=value["@type"]):(typeOrLanguage="@type",typeOrLanguageValue="@id"),containers.push("@set");containers.push("@none");var term=_selectTerm(activeCtx,iri,value,containers,typeOrLanguage,typeOrLanguageValue);if(null!==term)return term}if(relativeTo.vocab&&"@vocab"in activeCtx){var vocab=activeCtx["@vocab"];if(0===iri.indexOf(vocab)&&iri!==vocab){var suffix=iri.substr(vocab.length);if(!(suffix in activeCtx.mappings))return suffix}}var choice=null;for(var term in activeCtx.mappings)if(-1===term.indexOf(":")){var definition=activeCtx.mappings[term];if(definition&&definition["@id"]!==iri&&0===iri.indexOf(definition["@id"])){var curie=term+":"+iri.substr(definition["@id"].length),isUsableCurie=!(curie in activeCtx.mappings)||null===value&&activeCtx.mappings[curie]&&activeCtx.mappings[curie]["@id"]===iri;isUsableCurie&&(null===choice||_compareShortestLeast(curie,choice)<0)&&(choice=curie)}}return null!==choice?choice:relativeTo.vocab?iri:_removeBase(activeCtx["@base"],iri)}function _compactValue(activeCtx,activeProperty,value){if(_isValue(value)){var type=jsonld.getContextValue(activeCtx,activeProperty,"@type"),language=jsonld.getContextValue(activeCtx,activeProperty,"@language"),container=jsonld.getContextValue(activeCtx,activeProperty,"@container"),preserveIndex="@index"in value&&"@index"!==container;if(!preserveIndex&&(value["@type"]===type||value["@language"]===language))return value["@value"];var keyCount=Object.keys(value).length,isValueOnlyKey=1===keyCount||2===keyCount&&"@index"in value&&!preserveIndex,hasDefaultLanguage="@language"in activeCtx,isValueString=_isString(value["@value"]),hasNullMapping=activeCtx.mappings[activeProperty]&&null===activeCtx.mappings[activeProperty]["@language"];if(isValueOnlyKey&&(!hasDefaultLanguage||!isValueString||hasNullMapping))return value["@value"];var rval={};return preserveIndex&&(rval[_compactIri(activeCtx,"@index")]=value["@index"]),"@type"in value?rval[_compactIri(activeCtx,"@type")]=_compactIri(activeCtx,value["@type"],null,{vocab:!0}):"@language"in value&&(rval[_compactIri(activeCtx,"@language")]=value["@language"]),rval[_compactIri(activeCtx,"@value")]=value["@value"],rval}var expandedProperty=_expandIri(activeCtx,activeProperty,{vocab:!0}),type=jsonld.getContextValue(activeCtx,activeProperty,"@type"),compacted=_compactIri(activeCtx,value["@id"],null,{vocab:"@vocab"===type});if("@id"===type||"@vocab"===type||"@graph"===expandedProperty)return compacted;var rval={};return rval[_compactIri(activeCtx,"@id")]=compacted,rval}function _createTermDefinition(activeCtx,localCtx,term,defined){if(term in defined){if(defined[term])return;throw new JsonLdError("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:localCtx,term:term})}if(defined[term]=!1,_isKeyword(term))throw new JsonLdError("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:localCtx,term:term});if(""===term)throw new JsonLdError("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx});activeCtx.mappings[term]&&delete activeCtx.mappings[term];var value=localCtx[term];if(null===value||_isObject(value)&&null===value["@id"])return activeCtx.mappings[term]=null,void(defined[term]=!0);if(_isString(value)&&(value={"@id":value}),!_isObject(value))throw new JsonLdError("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:localCtx});var mapping=activeCtx.mappings[term]={};if(mapping.reverse=!1,"@reverse"in value){if("@id"in value)throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx});var reverse=value["@reverse"];if(!_isString(reverse))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});var id=_expandIri(activeCtx,reverse,{vocab:!0,base:!1},localCtx,defined);if(!_isAbsoluteIri(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});mapping["@id"]=id,mapping.reverse=!0}else if("@id"in value){var id=value["@id"];if(!_isString(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});if(id!==term){if(id=_expandIri(activeCtx,id,{vocab:!0,base:!1},localCtx,defined),!_isAbsoluteIri(id)&&!_isKeyword(id))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx});mapping["@id"]=id}}if(!("@id"in mapping)){var colon=term.indexOf(":");if(-1!==colon){var prefix=term.substr(0,colon);if(prefix in localCtx&&_createTermDefinition(activeCtx,localCtx,prefix,defined),activeCtx.mappings[prefix]){var suffix=term.substr(colon+1);mapping["@id"]=activeCtx.mappings[prefix]["@id"]+suffix}else mapping["@id"]=term}else{if(!("@vocab"in activeCtx))throw new JsonLdError("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:localCtx,term:term});mapping["@id"]=activeCtx["@vocab"]+term}}if(defined[term]=!0,"@type"in value){var type=value["@type"];if(!_isString(type))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx});if("@id"!==type&&"@vocab"!==type){if(type=_expandIri(activeCtx,type,{vocab:!0,base:!1},localCtx,defined),!_isAbsoluteIri(type))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx});if(0===type.indexOf("_:"))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:localCtx})}mapping["@type"]=type}if("@container"in value){var container=value["@container"];if("@list"!==container&&"@set"!==container&&"@index"!==container&&"@language"!==container)throw new JsonLdError("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:localCtx});if(mapping.reverse&&"@index"!==container&&"@set"!==container&&null!==container)throw new JsonLdError("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:localCtx});mapping["@container"]=container}if("@language"in value&&!("@type"in value)){var language=value["@language"];if(null!==language&&!_isString(language))throw new JsonLdError("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:localCtx});null!==language&&(language=language.toLowerCase()),mapping["@language"]=language}var id=mapping["@id"];if("@context"===id||"@preserve"===id)throw new JsonLdError("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:localCtx})}function _expandIri(activeCtx,value,relativeTo,localCtx,defined){if(null===value||_isKeyword(value))return value;if(value=String(value),localCtx&&value in localCtx&&defined[value]!==!0&&_createTermDefinition(activeCtx,localCtx,value,defined),relativeTo=relativeTo||{},relativeTo.vocab){var mapping=activeCtx.mappings[value];if(null===mapping)return null;if(mapping)return mapping["@id"]}var colon=value.indexOf(":");if(-1!==colon){var prefix=value.substr(0,colon),suffix=value.substr(colon+1);if("_"===prefix||0===suffix.indexOf("//"))return value;localCtx&&prefix in localCtx&&_createTermDefinition(activeCtx,localCtx,prefix,defined);var mapping=activeCtx.mappings[prefix];return mapping?mapping["@id"]+suffix:value}if(relativeTo.vocab&&"@vocab"in activeCtx)return activeCtx["@vocab"]+value;var rval=value;return relativeTo.base&&(rval=_prependBase(activeCtx["@base"],rval)),rval}function _prependBase(base,iri){if(null===base)return iri;if(-1!==iri.indexOf(":"))return iri;_isString(base)&&(base=jsonld.url.parse(base||""));var rel=jsonld.url.parse(iri),transform={protocol:base.protocol||""};if(null!==rel.authority)transform.authority=rel.authority,transform.path=rel.path,transform.query=rel.query;else if(transform.authority=base.authority,""===rel.path)transform.path=base.path,null!==rel.query?transform.query=rel.query:transform.query=base.query;else{if(0===rel.path.indexOf("/"))transform.path=rel.path;else{var path=base.path;""!==rel.path&&(path=path.substr(0,path.lastIndexOf("/")+1),path.length>0&&"/"!==path.substr(-1)&&(path+="/"),path+=rel.path),transform.path=path}transform.query=rel.query}transform.path=_removeDotSegments(transform.path,!!transform.authority);var rval=transform.protocol;return null!==transform.authority&&(rval+="//"+transform.authority),rval+=transform.path,null!==transform.query&&(rval+="?"+transform.query),null!==rel.fragment&&(rval+="#"+rel.fragment),""===rval&&(rval="./"),rval}function _removeBase(base,iri){if(null===base)return iri;_isString(base)&&(base=jsonld.url.parse(base||""));var root="";if(""!==base.href?root+=(base.protocol||"")+"//"+(base.authority||""):iri.indexOf("//")&&(root+="//"),0!==iri.indexOf(root))return iri;for(var rel=jsonld.url.parse(iri.substr(root.length)),baseSegments=base.normalizedPath.split("/"),iriSegments=rel.normalizedPath.split("/"),last=rel.fragment||rel.query?0:1;baseSegments.length>0&&iriSegments.length>last&&baseSegments[0]===iriSegments[0];)baseSegments.shift(),iriSegments.shift();var rval="";if(baseSegments.length>0){baseSegments.pop();for(var i=0;i<baseSegments.length;++i)rval+="../"}return rval+=iriSegments.join("/"),null!==rel.query&&(rval+="?"+rel.query),null!==rel.fragment&&(rval+="#"+rel.fragment),""===rval&&(rval="./"),rval}function _getInitialContext(options){function _createInverseContext(){var activeCtx=this;if(activeCtx.inverse)return activeCtx.inverse;for(var inverse=activeCtx.inverse={},defaultLanguage=activeCtx["@language"]||"@none",mappings=activeCtx.mappings,terms=Object.keys(mappings).sort(_compareShortestLeast),i=0;i<terms.length;++i){var term=terms[i],mapping=mappings[term];if(null!==mapping){var container=mapping["@container"]||"@none",ids=mapping["@id"];_isArray(ids)||(ids=[ids]);for(var ii=0;ii<ids.length;++ii){var iri=ids[ii],entry=inverse[iri];
if(entry||(inverse[iri]=entry={}),entry[container]||(entry[container]={"@language":{},"@type":{}}),entry=entry[container],mapping.reverse)_addPreferredTerm(mapping,term,entry["@type"],"@reverse");else if("@type"in mapping)_addPreferredTerm(mapping,term,entry["@type"],mapping["@type"]);else if("@language"in mapping){var language=mapping["@language"]||"@null";_addPreferredTerm(mapping,term,entry["@language"],language)}else _addPreferredTerm(mapping,term,entry["@language"],defaultLanguage),_addPreferredTerm(mapping,term,entry["@type"],"@none"),_addPreferredTerm(mapping,term,entry["@language"],"@none")}}}return inverse}function _addPreferredTerm(mapping,term,entry,typeOrLanguageValue){typeOrLanguageValue in entry||(entry[typeOrLanguageValue]=term)}function _cloneActiveContext(){var child={};return child["@base"]=this["@base"],child.mappings=_clone(this.mappings),child.clone=this.clone,child.inverse=null,child.getInverse=this.getInverse,"@language"in this&&(child["@language"]=this["@language"]),"@vocab"in this&&(child["@vocab"]=this["@vocab"]),child}var base=jsonld.url.parse(options.base||"");return{"@base":base,mappings:{},inverse:null,getInverse:_createInverseContext,clone:_cloneActiveContext}}function _isKeyword(v){if(!_isString(v))return!1;switch(v){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function _isObject(v){return"[object Object]"===Object.prototype.toString.call(v)}function _isEmptyObject(v){return _isObject(v)&&0===Object.keys(v).length}function _isArray(v){return Array.isArray(v)}function _validateTypeValue(v){if(!_isString(v)&&!_isEmptyObject(v)){var isValid=!1;if(_isArray(v)){isValid=!0;for(var i=0;i<v.length;++i)if(!_isString(v[i])){isValid=!1;break}}if(!isValid)throw new JsonLdError('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:v})}}function _isString(v){return"string"==typeof v||"[object String]"===Object.prototype.toString.call(v)}function _isNumber(v){return"number"==typeof v||"[object Number]"===Object.prototype.toString.call(v)}function _isDouble(v){return _isNumber(v)&&-1!==String(v).indexOf(".")}function _isNumeric(v){return!isNaN(parseFloat(v))&&isFinite(v)}function _isBoolean(v){return"boolean"==typeof v||"[object Boolean]"===Object.prototype.toString.call(v)}function _isUndefined(v){return"undefined"==typeof v}function _isSubject(v){var rval=!1;if(_isObject(v)&&!("@value"in v||"@set"in v||"@list"in v)){var keyCount=Object.keys(v).length;rval=keyCount>1||!("@id"in v)}return rval}function _isSubjectReference(v){return _isObject(v)&&1===Object.keys(v).length&&"@id"in v}function _isValue(v){return _isObject(v)&&"@value"in v}function _isList(v){return _isObject(v)&&"@list"in v}function _isBlankNode(v){var rval=!1;return _isObject(v)&&(rval="@id"in v?0===v["@id"].indexOf("_:"):0===Object.keys(v).length||!("@value"in v||"@set"in v||"@list"in v)),rval}function _isAbsoluteIri(v){return _isString(v)&&-1!==v.indexOf(":")}function _clone(value){if(value&&"object"==typeof value){var rval;if(_isArray(value)){rval=[];for(var i=0;i<value.length;++i)rval[i]=_clone(value[i])}else if(_isObject(value)){rval={};for(var key in value)rval[key]=_clone(value[key])}else rval=value.toString();return rval}return value}function _findContextUrls(input,urls,replace,base){var count=Object.keys(urls).length;if(_isArray(input)){for(var i=0;i<input.length;++i)_findContextUrls(input[i],urls,replace,base);return count<Object.keys(urls).length}if(_isObject(input)){for(var key in input)if("@context"===key){var ctx=input[key];if(_isArray(ctx))for(var length=ctx.length,i=0;length>i;++i){var _ctx=ctx[i];_isString(_ctx)&&(_ctx=_prependBase(base,_ctx),replace?(_ctx=urls[_ctx],_isArray(_ctx)?(Array.prototype.splice.apply(ctx,[i,1].concat(_ctx)),i+=_ctx.length-1,length=ctx.length):ctx[i]=_ctx):_ctx in urls||(urls[_ctx]=!1))}else _isString(ctx)&&(ctx=_prependBase(base,ctx),replace?input[key]=urls[ctx]:ctx in urls||(urls[ctx]=!1))}else _findContextUrls(input[key],urls,replace,base);return count<Object.keys(urls).length}return!1}function _retrieveContextUrls(input,options,callback){var error=null,documentLoader=options.documentLoader,retrieve=function(input,cycles,documentLoader,base,callback){if(Object.keys(cycles).length>MAX_CONTEXT_URLS)return error=new JsonLdError("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:MAX_CONTEXT_URLS}),callback(error);var urls={},finished=function(){_findContextUrls(input,urls,!0,base),callback(null,input)};_findContextUrls(input,urls,!1,base)||finished();var queue=[];for(var url in urls)urls[url]===!1&&queue.push(url);for(var count=queue.length,i=0;i<queue.length;++i)!function(url){if(url in cycles)return error=new JsonLdError("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:url}),callback(error);var _cycles=_clone(cycles);_cycles[url]=!0;var done=function(err,remoteDoc){if(!error){var ctx=remoteDoc?remoteDoc.document:null;if(!err&&_isString(ctx))try{ctx=JSON.parse(ctx)}catch(ex){err=ex}if(err?err=new JsonLdError("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:url,cause:err}):_isObject(ctx)||(err=new JsonLdError("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:url,cause:err})),err)return error=err,callback(error);ctx="@context"in ctx?{"@context":ctx["@context"]}:{"@context":{}},remoteDoc.contextUrl&&(_isArray(ctx["@context"])||(ctx["@context"]=[ctx["@context"]]),ctx["@context"].push(remoteDoc.contextUrl)),retrieve(ctx,_cycles,documentLoader,url,function(err,ctx){return err?callback(err):(urls[url]=ctx["@context"],count-=1,void(0===count&&finished()))})}},promise=documentLoader(url,done);promise&&"then"in promise&&promise.then(done.bind(null,null),done)}(queue[i])};retrieve(input,{},documentLoader,options.base,callback)}function _parseNQuads(input){for(var iri="(?:<([^:]+:[^>]*)>)",bnode="(_:(?:[A-Za-z0-9]+))",plain='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',datatype="(?:\\^\\^"+iri+")",language="(?:@([a-z]+(?:-[a-z0-9]+)*))",literal="(?:"+plain+"(?:"+datatype+"|"+language+")?)",ws="[ \\t]+",wso="[ \\t]*",eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,empty=new RegExp("^"+wso+"$"),subject="(?:"+iri+"|"+bnode+")"+ws,property=iri+ws,object="(?:"+iri+"|"+bnode+"|"+literal+")"+wso,graphName="(?:\\.|(?:(?:"+iri+"|"+bnode+")"+wso+"\\.))",quad=new RegExp("^"+wso+subject+property+object+graphName+wso+"$"),dataset={},lines=input.split(eoln),lineNumber=0,li=0;li<lines.length;++li){var line=lines[li];if(lineNumber++,!empty.test(line)){var match=line.match(quad);if(null===match)throw new JsonLdError("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:lineNumber});var triple={};if(_isUndefined(match[1])?triple.subject={type:"blank node",value:match[2]}:triple.subject={type:"IRI",value:match[1]},triple.predicate={type:"IRI",value:match[3]},_isUndefined(match[4]))if(_isUndefined(match[5])){triple.object={type:"literal"},_isUndefined(match[7])?_isUndefined(match[8])?triple.object.datatype=XSD_STRING:(triple.object.datatype=RDF_LANGSTRING,triple.object.language=match[8]):triple.object.datatype=match[7];var unescaped=match[6].replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");triple.object.value=unescaped}else triple.object={type:"blank node",value:match[5]};else triple.object={type:"IRI",value:match[4]};var name="@default";if(_isUndefined(match[9])?_isUndefined(match[10])||(name=match[10]):name=match[9],name in dataset){for(var unique=!0,triples=dataset[name],ti=0;unique&&ti<triples.length;++ti)_compareRDFTriples(triples[ti],triple)&&(unique=!1);unique&&triples.push(triple)}else dataset[name]=[triple]}}return dataset}function _toNQuads(dataset){var quads=[];for(var graphName in dataset)for(var triples=dataset[graphName],ti=0;ti<triples.length;++ti){var triple=triples[ti];"@default"===graphName&&(graphName=null),quads.push(_toNQuad(triple,graphName))}return quads.sort(),quads.join("")}function _toNQuad(triple,graphName,bnode){var s=triple.subject,p=triple.predicate,o=triple.object,g=graphName,quad="";if(quad+="IRI"===s.type?"<"+s.value+">":bnode?s.value===bnode?"_:a":"_:z":s.value,quad+=" ",quad+="IRI"===p.type?"<"+p.value+">":bnode?"_:p":p.value,quad+=" ","IRI"===o.type)quad+="<"+o.value+">";else if("blank node"===o.type)quad+=bnode?o.value===bnode?"_:a":"_:z":o.value;else{var escaped=o.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');quad+='"'+escaped+'"',o.datatype===RDF_LANGSTRING?o.language&&(quad+="@"+o.language):o.datatype!==XSD_STRING&&(quad+="^^<"+o.datatype+">")}return null!==g&&(quad+=0!==g.indexOf("_:")?" <"+g+">":bnode?" _:g":" "+g),quad+=" .\n"}function _parseRdfaApiData(data){var dataset={};dataset["@default"]=[];for(var subjects=data.getSubjects(),si=0;si<subjects.length;++si){var subject=subjects[si];if(null!==subject){var triples=data.getSubjectTriples(subject);if(null!==triples){var predicates=triples.predicates;for(var predicate in predicates)for(var objects=predicates[predicate].objects,oi=0;oi<objects.length;++oi){var object=objects[oi],triple={};0===subject.indexOf("_:")?triple.subject={type:"blank node",value:subject}:triple.subject={type:"IRI",value:subject},0===predicate.indexOf("_:")?triple.predicate={type:"blank node",value:predicate}:triple.predicate={type:"IRI",value:predicate};var value=object.value;if(object.type===RDF_XML_LITERAL){XMLSerializer||_defineXMLSerializer();var serializer=new XMLSerializer;value="";for(var x=0;x<object.value.length;x++)object.value[x].nodeType===Node.ELEMENT_NODE?value+=serializer.serializeToString(object.value[x]):object.value[x].nodeType===Node.TEXT_NODE&&(value+=object.value[x].nodeValue)}triple.object={},object.type===RDF_OBJECT?0===object.value.indexOf("_:")?triple.object.type="blank node":triple.object.type="IRI":(triple.object.type="literal",object.type===RDF_PLAIN_LITERAL?object.language?(triple.object.datatype=RDF_LANGSTRING,triple.object.language=object.language):triple.object.datatype=XSD_STRING:triple.object.datatype=object.type),triple.object.value=value,dataset["@default"].push(triple)}}}}return dataset}function UniqueNamer(prefix){this.prefix=prefix,this.counter=0,this.existing={}}function _removeDotSegments(path,hasAuthority){var rval="";0===path.indexOf("/")&&(rval="/");for(var input=path.split("/"),output=[];input.length>0;)"."===input[0]||""===input[0]&&input.length>1?input.shift():".."!==input[0]?output.push(input.shift()):(input.shift(),hasAuthority||output.length>0&&".."!==output[output.length-1]?output.pop():output.push(".."));return rval+output.join("/")}jsonld.compact=function(input,ctx,options,callback){function cleanup(err,compacted,activeCtx,options){if(err)return callback(err);options.compactArrays&&!options.graph&&_isArray(compacted)?1===compacted.length?compacted=compacted[0]:0===compacted.length&&(compacted={}):options.graph&&_isObject(compacted)&&(compacted=[compacted]),_isObject(ctx)&&"@context"in ctx&&(ctx=ctx["@context"]),ctx=_clone(ctx),_isArray(ctx)||(ctx=[ctx]);var tmp=ctx;ctx=[];for(var i=0;i<tmp.length;++i)(!_isObject(tmp[i])||Object.keys(tmp[i]).length>0)&&ctx.push(tmp[i]);var hasContext=ctx.length>0;if(1===ctx.length&&(ctx=ctx[0]),_isArray(compacted)){var kwgraph=_compactIri(activeCtx,"@graph"),graph=compacted;compacted={},hasContext&&(compacted["@context"]=ctx),compacted[kwgraph]=graph}else if(_isObject(compacted)&&hasContext){var graph=compacted;compacted={"@context":ctx};for(var key in graph)compacted[key]=graph[key]}callback(null,compacted,activeCtx)}if(arguments.length<2)return jsonld.nextTick(function(){callback(new TypeError("Could not compact, too few arguments."))});if("function"==typeof options&&(callback=options,options={}),options=options||{},null===ctx)return jsonld.nextTick(function(){callback(new JsonLdError("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===input)return jsonld.nextTick(function(){callback(null,null)});"base"in options||(options.base="string"==typeof input?input:""),"compactArrays"in options||(options.compactArrays=!0),"graph"in options||(options.graph=!1),"skipExpansion"in options||(options.skipExpansion=!1),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),"link"in options||(options.link=!1),options.link&&(options.skipExpansion=!0);var expand=function(input,options,callback){jsonld.nextTick(function(){return options.skipExpansion?callback(null,input):void jsonld.expand(input,options,callback)})};expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before compaction.","jsonld.CompactError",{cause:err}));var activeCtx=_getInitialContext(options);jsonld.processContext(activeCtx,ctx,options,function(err,activeCtx){if(err)return callback(new JsonLdError("Could not process context before compaction.","jsonld.CompactError",{cause:err}));var compacted;try{compacted=(new Processor).compact(activeCtx,null,expanded,options)}catch(ex){return callback(ex)}cleanup(null,compacted,activeCtx,options)})})},jsonld.expand=function(input,options,callback){function expand(remoteDoc){"base"in options||(options.base=remoteDoc.documentUrl||"");var input={document:_clone(remoteDoc.document),remoteContext:{"@context":remoteDoc.contextUrl}};if("expandContext"in options){var expandContext=_clone(options.expandContext);"object"==typeof expandContext&&"@context"in expandContext?input.expandContext=expandContext:input.expandContext={"@context":expandContext}}_retrieveContextUrls(input,options,function(err,input){if(err)return callback(err);var expanded;try{var processor=new Processor,activeCtx=_getInitialContext(options),document=input.document,remoteContext=input.remoteContext["@context"];input.expandContext&&(activeCtx=processor.processContext(activeCtx,input.expandContext["@context"],options)),remoteContext&&(activeCtx=processor.processContext(activeCtx,remoteContext,options)),expanded=processor.expand(activeCtx,null,document,options,!1),_isObject(expanded)&&"@graph"in expanded&&1===Object.keys(expanded).length?expanded=expanded["@graph"]:null===expanded&&(expanded=[]),_isArray(expanded)||(expanded=[expanded])}catch(ex){return callback(ex)}callback(null,expanded)})}return arguments.length<1?jsonld.nextTick(function(){callback(new TypeError("Could not expand, too few arguments."))}):("function"==typeof options&&(callback=options,options={}),options=options||{},"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),"keepFreeFloatingNodes"in options||(options.keepFreeFloatingNodes=!1),void jsonld.nextTick(function(){if("string"==typeof input){var done=function(err,remoteDoc){if(err)return callback(err);try{if(!remoteDoc.document)throw new JsonLdError("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof remoteDoc.document&&(remoteDoc.document=JSON.parse(remoteDoc.document))}catch(ex){return callback(new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:ex,remoteDoc:remoteDoc}))}expand(remoteDoc)},promise=options.documentLoader(input,done);return void(promise&&"then"in promise&&promise.then(done.bind(null,null),done))}expand({contextUrl:null,documentUrl:null,document:input})}))},jsonld.flatten=function(input,ctx,options,callback){return arguments.length<1?jsonld.nextTick(function(){callback(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof options?(callback=options,options={}):"function"==typeof ctx&&(callback=ctx,ctx=null,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),void jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before flattening.","jsonld.FlattenError",{cause:err}));var flattened;try{flattened=(new Processor).flatten(_input)}catch(ex){return callback(ex)}return null===ctx?callback(null,flattened):(options.graph=!0,options.skipExpansion=!0,void jsonld.compact(flattened,ctx,options,function(err,compacted){return err?callback(new JsonLdError("Could not compact flattened output.","jsonld.FlattenError",{cause:err})):void callback(null,compacted)}))}))},jsonld.frame=function(input,frame,options,callback){function doFrame(remoteFrame){var ctx,frame=remoteFrame.document;frame?(ctx=frame["@context"],remoteFrame.contextUrl?(ctx?_isArray(ctx)?ctx.push(remoteFrame.contextUrl):ctx=[ctx,remoteFrame.contextUrl]:ctx=remoteFrame.contextUrl,frame["@context"]=ctx):ctx=ctx||{}):ctx={},jsonld.expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before framing.","jsonld.FrameError",{cause:err}));var opts=_clone(options);opts.isFrame=!0,opts.keepFreeFloatingNodes=!0,jsonld.expand(frame,opts,function(err,expandedFrame){if(err)return callback(new JsonLdError("Could not expand frame before framing.","jsonld.FrameError",{cause:err}));var framed;try{framed=(new Processor).frame(expanded,expandedFrame,opts)}catch(ex){return callback(ex)}opts.graph=!0,opts.skipExpansion=!0,opts.link={},jsonld.compact(framed,ctx,opts,function(err,compacted,ctx){if(err)return callback(new JsonLdError("Could not compact framed output.","jsonld.FrameError",{cause:err}));var graph=_compactIri(ctx,"@graph");opts.link={},compacted[graph]=_removePreserve(ctx,compacted[graph],opts),callback(null,compacted)})})})}return arguments.length<2?jsonld.nextTick(function(){callback(new TypeError("Could not frame, too few arguments."))}):("function"==typeof options&&(callback=options,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),"embed"in options||(options.embed="@last"),options.explicit=options.explicit||!1,"requireAll"in options||(options.requireAll=!0),options.omitDefault=options.omitDefault||!1,void jsonld.nextTick(function(){if("string"==typeof frame){var done=function(err,remoteDoc){if(err)return callback(err);try{if(!remoteDoc.document)throw new JsonLdError("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof remoteDoc.document&&(remoteDoc.document=JSON.parse(remoteDoc.document))}catch(ex){return callback(new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:ex,remoteDoc:remoteDoc}))}doFrame(remoteDoc)},promise=options.documentLoader(frame,done);return void(promise&&"then"in promise&&promise.then(done.bind(null,null),done))}doFrame({contextUrl:null,documentUrl:null,document:frame})}))},jsonld.link=function(input,ctx,options,callback){var frame={};ctx&&(frame["@context"]=ctx),frame["@embed"]="@link",jsonld.frame(input,frame,options,callback)},jsonld.objectify=function(input,ctx,options,callback){"function"==typeof options&&(callback=options,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before linking.","jsonld.LinkError",{cause:err}));var flattened;try{flattened=(new Processor).flatten(_input)}catch(ex){return callback(ex)}options.graph=!0,options.skipExpansion=!0,jsonld.compact(flattened,ctx,options,function(err,compacted,ctx){if(err)return callback(new JsonLdError("Could not compact flattened output before linking.","jsonld.LinkError",{cause:err}));var graph=_compactIri(ctx,"@graph"),top=compacted[graph][0],recurse=function(subject){if(_isObject(subject)||_isArray(subject)){if(_isObject(subject)){if(recurse.visited[subject["@id"]])return;recurse.visited[subject["@id"]]=!0}for(var k in subject){var obj=subject[k],isid="@id"===jsonld.getContextValue(ctx,k,"@type");if(_isArray(obj)||_isObject(obj)||isid)if(_isString(obj)&&isid)subject[k]=obj=top[obj],recurse(obj);else if(_isArray(obj))for(var i=0;i<obj.length;++i)_isString(obj[i])&&isid?obj[i]=top[obj[i]]:_isObject(obj[i])&&"@id"in obj[i]&&(obj[i]=top[obj[i]["@id"]]),recurse(obj[i]);else if(_isObject(obj)){var sid=obj["@id"];subject[k]=obj=top[sid],recurse(obj)}}}};recurse.visited={},recurse(top),compacted.of_type={};for(var s in top)if("@type"in top[s]){var types=top[s]["@type"];_isArray(types)||(types=[types]);for(var t=0;t<types.length;++t)types[t]in compacted.of_type||(compacted.of_type[types[t]]=[]),compacted.of_type[types[t]].push(top[s])}callback(null,compacted)})})},jsonld.normalize=function(input,options,callback){if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not normalize, too few arguments."))});"function"==typeof options&&(callback=options,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument);var opts=_clone(options);delete opts.format,opts.produceGeneralizedRdf=!1,jsonld.toRDF(input,opts,function(err,dataset){return err?callback(new JsonLdError("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:err})):void(new Processor).normalize(dataset,options,callback)})},jsonld.fromRDF=function(dataset,options,callback){return arguments.length<1?jsonld.nextTick(function(){callback(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof options&&(callback=options,options={}),options=options||{},"useRdfType"in options||(options.useRdfType=!1),"useNativeTypes"in options||(options.useNativeTypes=!1),"format"in options||!_isString(dataset)||"format"in options||(options.format="application/nquads"),void jsonld.nextTick(function(){function fromRDF(dataset,options,callback){(new Processor).fromRDF(dataset,options,callback)}var rdfParser;if(options.format){if(rdfParser=options.rdfParser||_rdfParsers[options.format],!rdfParser)return callback(new JsonLdError("Unknown input format.","jsonld.UnknownFormat",{format:options.format}))}else rdfParser=function(){return dataset};var callbackCalled=!1;try{dataset=rdfParser(dataset,function(err,dataset){return callbackCalled=!0,err?callback(err):void fromRDF(dataset,options,callback)})}catch(e){if(!callbackCalled)return callback(e);throw e}if(dataset){if("then"in dataset)return dataset.then(function(dataset){fromRDF(dataset,options,callback)},callback);fromRDF(dataset,options,callback)}}))},jsonld.toRDF=function(input,options,callback){return arguments.length<1?jsonld.nextTick(function(){callback(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof options&&(callback=options,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),void jsonld.expand(input,options,function(err,expanded){if(err)return callback(new JsonLdError("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:err}));var dataset;try{if(dataset=Processor.prototype.toRDF(expanded,options),options.format){if("application/nquads"===options.format)return callback(null,_toNQuads(dataset));throw new JsonLdError("Unknown output format.","jsonld.UnknownFormat",{format:options.format})}}catch(ex){return callback(ex)}callback(null,dataset)}))},jsonld.createNodeMap=function(input,options,callback){return arguments.length<1?jsonld.nextTick(function(){callback(new TypeError("Could not create node map, too few arguments."))}):("function"==typeof options&&(callback=options,options={}),options=options||{},"base"in options||(options.base="string"==typeof input?input:""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),void jsonld.expand(input,options,function(err,_input){if(err)return callback(new JsonLdError("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:err}));var nodeMap;try{nodeMap=(new Processor).createNodeMap(_input,options)}catch(ex){return callback(ex)}callback(null,nodeMap)}))},jsonld.merge=function(docs,ctx,options,callback){function expandComplete(err,_input){if(!error){if(err)return error=err,callback(new JsonLdError("Could not expand input before flattening.","jsonld.FlattenError",{cause:err}));expanded.push(_input),0===--count&&merge(expanded)}}function merge(expanded){var mergeNodes=!0;"mergeNodes"in options&&(mergeNodes=options.mergeNodes);var defaultGraph,namer=options.namer||new UniqueNamer("_:b"),graphs={"@default":{}};try{for(var i=0;i<expanded.length;++i){var doc=expanded[i];doc=jsonld.relabelBlankNodes(doc,{namer:new UniqueNamer("_:b"+i+"-")});var _graphs=mergeNodes||0===i?graphs:{"@default":{}};if(_createNodeMap(doc,_graphs,"@default",namer),_graphs!==graphs)for(var graphName in _graphs){var _nodeMap=_graphs[graphName];if(graphName in graphs){var nodeMap=graphs[graphName];for(var key in _nodeMap)key in nodeMap||(nodeMap[key]=_nodeMap[key])}else graphs[graphName]=_nodeMap}}defaultGraph=_mergeNodeMaps(graphs)}catch(ex){return callback(ex)}for(var flattened=[],keys=Object.keys(defaultGraph).sort(),ki=0;ki<keys.length;++ki){var node=defaultGraph[keys[ki]];_isSubjectReference(node)||flattened.push(node)}return null===ctx?callback(null,flattened):(options.graph=!0,options.skipExpansion=!0,void jsonld.compact(flattened,ctx,options,function(err,compacted){return err?callback(new JsonLdError("Could not compact merged output.","jsonld.MergeError",{cause:err})):void callback(null,compacted)}))}if(arguments.length<1)return jsonld.nextTick(function(){callback(new TypeError("Could not merge, too few arguments."))});if(!_isArray(docs))return jsonld.nextTick(function(){callback(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof options?(callback=options,options={}):"function"==typeof ctx&&(callback=ctx,ctx=null,options={}),options=options||{};for(var expanded=[],error=null,count=docs.length,i=0;i<docs.length;++i){var opts={};for(var key in options)opts[key]=options[key];jsonld.expand(docs[i],opts,expandComplete)}},jsonld.relabelBlankNodes=function(input,options){options=options||{};var namer=options.namer||new UniqueNamer("_:b");return _labelBlankNodes(namer,input)},jsonld.documentLoader=function(url,callback){var err=new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return _nodejs?callback(err,{contextUrl:null,documentUrl:url,document:null}):jsonld.promisify(function(callback){callback(err)})},jsonld.loadDocument=function(url,callback){var promise=jsonld.documentLoader(url,callback);promise&&"then"in promise&&promise.then(callback.bind(null,null),callback)},jsonld.promises=function(options){options=options||{};var slice=Array.prototype.slice,promisify=jsonld.promisify,api=options.api||{},version=options.version||"jsonld.js";"string"==typeof options.api&&(options.version||(version=options.api),api={}),api.expand=function(input){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return promisify.apply(null,[jsonld.expand].concat(slice.call(arguments)))},api.compact=function(input,ctx){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var compact=function(input,ctx,options,callback){jsonld.compact(input,ctx,options,function(err,compacted){callback(err,compacted)})};return promisify.apply(null,[compact].concat(slice.call(arguments)))},api.flatten=function(input){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return promisify.apply(null,[jsonld.flatten].concat(slice.call(arguments)))},api.frame=function(input,frame){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return promisify.apply(null,[jsonld.frame].concat(slice.call(arguments)))},api.fromRDF=function(dataset){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return promisify.apply(null,[jsonld.fromRDF].concat(slice.call(arguments)))},api.toRDF=function(input){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return promisify.apply(null,[jsonld.toRDF].concat(slice.call(arguments)))},api.normalize=function(input){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return promisify.apply(null,[jsonld.normalize].concat(slice.call(arguments)))},"jsonld.js"===version&&(api.link=function(input,ctx){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return promisify.apply(null,[jsonld.link].concat(slice.call(arguments)))},api.objectify=function(input){return promisify.apply(null,[jsonld.objectify].concat(slice.call(arguments)))},api.createNodeMap=function(input){return promisify.apply(null,[jsonld.createNodeMap].concat(slice.call(arguments)))},api.merge=function(input){return promisify.apply(null,[jsonld.merge].concat(slice.call(arguments)))});try{jsonld.Promise=global.Promise||require("es6-promise").Promise}catch(e){var f=function(){throw new Error("Unable to find a Promise implementation.")};for(var method in api)api[method]=f}return api},jsonld.promisify=function(op){if(!jsonld.Promise)try{jsonld.Promise=global.Promise||require("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.")}var args=Array.prototype.slice.call(arguments,1);return new jsonld.Promise(function(resolve,reject){op.apply(null,args.concat(function(err,value){err?reject(err):resolve(value)}))})},jsonld.promises({api:jsonld.promises}),JsonLdProcessor.prototype=jsonld.promises({version:"json-ld-1.0"}),JsonLdProcessor.prototype.toString=function(){return this instanceof JsonLdProcessor?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},jsonld.JsonLdProcessor=JsonLdProcessor;var canDefineProperty=!!Object.defineProperty;if(canDefineProperty)try{Object.defineProperty({},"x",{})}catch(e){canDefineProperty=!1}canDefineProperty&&(Object.defineProperty(JsonLdProcessor,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(JsonLdProcessor.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:JsonLdProcessor})),_browser&&"undefined"==typeof global.JsonLdProcessor&&(canDefineProperty?Object.defineProperty(global,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:JsonLdProcessor}):global.JsonLdProcessor=JsonLdProcessor);var _setImmediate="function"==typeof setImmediate&&setImmediate,_delay=_setImmediate?function(fn){_setImmediate(fn)}:function(fn){setTimeout(fn,0)};"object"==typeof process&&"function"==typeof process.nextTick?jsonld.nextTick=process.nextTick:jsonld.nextTick=_delay,jsonld.setImmediate=_setImmediate?_delay:jsonld.nextTick,jsonld.parseLinkHeader=function(header){for(var rval={},entries=header.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),rLinkHeader=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,i=0;i<entries.length;++i){var match=entries[i].match(rLinkHeader);if(match){for(var result={target:match[1]},params=match[2],rParams=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;match=rParams.exec(params);)result[match[1]]=void 0===match[2]?match[3]:match[2];
var rel=result.rel||"";_isArray(rval[rel])?rval[rel].push(result):rel in rval?rval[rel]=[rval[rel],result]:rval[rel]=result}}return rval},jsonld.DocumentCache=function(size){this.order=[],this.cache={},this.size=size||50,this.expires=3e4},jsonld.DocumentCache.prototype.get=function(url){if(url in this.cache){var entry=this.cache[url];if(entry.expires>=+new Date)return entry.ctx;delete this.cache[url],this.order.splice(this.order.indexOf(url),1)}return null},jsonld.DocumentCache.prototype.set=function(url,ctx){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(url),this.cache[url]={ctx:ctx,expires:+new Date+this.expires}},jsonld.ActiveContextCache=function(size){this.order=[],this.cache={},this.size=size||100},jsonld.ActiveContextCache.prototype.get=function(activeCtx,localCtx){var key1=JSON.stringify(activeCtx),key2=JSON.stringify(localCtx),level1=this.cache[key1];return level1&&key2 in level1?level1[key2]:null},jsonld.ActiveContextCache.prototype.set=function(activeCtx,localCtx,result){if(this.order.length===this.size){var entry=this.order.shift();delete this.cache[entry.activeCtx][entry.localCtx]}var key1=JSON.stringify(activeCtx),key2=JSON.stringify(localCtx);this.order.push({activeCtx:key1,localCtx:key2}),key1 in this.cache||(this.cache[key1]={}),this.cache[key1][key2]=_clone(result)},jsonld.cache={activeCtx:new jsonld.ActiveContextCache},jsonld.documentLoaders={},jsonld.documentLoaders.jquery=function($,options){options=options||{};var loader=function(url,callback){return 0!==url.indexOf("http:")&&0!==url.indexOf("https:")?callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null}):options.secure&&0!==url.indexOf("https")?callback(new JsonLdError('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null}):void $.ajax({url:url,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(data,textStatus,jqXHR){var doc={contextUrl:null,documentUrl:url,document:data},contentType=jqXHR.getResponseHeader("Content-Type"),linkHeader=jqXHR.getResponseHeader("Link");if(linkHeader&&"application/ld+json"!==contentType){if(linkHeader=jsonld.parseLinkHeader(linkHeader)[LINK_HEADER_REL],_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),doc);linkHeader&&(doc.contextUrl=linkHeader.target)}callback(null,doc)},error:function(jqXHR,textStatus,err){callback(new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:err}),{contextUrl:null,documentUrl:url,document:null})}})},usePromise="undefined"!=typeof Promise;return"usePromise"in options&&(usePromise=options.usePromise),usePromise?function(url){return jsonld.promisify(loader,url)}:loader},jsonld.documentLoaders.node=function(options){function loadDocument(url,redirects,callback){function handleResponse(err,res,body){if(doc={contextUrl:null,documentUrl:url,document:body||null},err)return callback(new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url,cause:err}),doc);var statusText=http.STATUS_CODES[res.statusCode];if(res.statusCode>=400)return callback(new JsonLdError("URL could not be dereferenced: "+statusText,"jsonld.InvalidUrl",{code:"loading document failed",url:url,httpStatusCode:res.statusCode}),doc);if(res.headers.link&&"application/ld+json"!==res.headers["content-type"]){var linkHeader=jsonld.parseLinkHeader(res.headers.link)[LINK_HEADER_REL];if(_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),doc);linkHeader&&(doc.contextUrl=linkHeader.target)}if(res.statusCode>=300&&res.statusCode<400&&res.headers.location)return redirects.length===maxRedirects?callback(new JsonLdError("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:url,httpStatusCode:res.statusCode,redirects:redirects}),doc):-1!==redirects.indexOf(url)?callback(new JsonLdError("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:url,httpStatusCode:res.statusCode,redirects:redirects}),doc):(redirects.push(url),loadDocument(res.headers.location,redirects,callback));redirects.push(url);for(var i=0;i<redirects.length;++i)cache.set(redirects[i],{contextUrl:null,documentUrl:redirects[i],document:body});callback(err,doc)}if(0!==url.indexOf("http:")&&0!==url.indexOf("https:"))return callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});if(options.secure&&0!==url.indexOf("https"))return callback(new JsonLdError('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});var doc=cache.get(url);return null!==doc?callback(null,doc):void request({url:url,headers:{Accept:"application/ld+json, application/json"},strictSSL:strictSSL,followRedirect:!1},handleResponse)}options=options||{};var strictSSL="strictSSL"in options?options.strictSSL:!0,maxRedirects="maxRedirects"in options?options.maxRedirects:-1,request=require("request"),http=require("http"),cache=new jsonld.DocumentCache,loader=function(url,callback){loadDocument(url,[],callback)};return options.usePromise?function(url){return jsonld.promisify(loader,url)}:loader},jsonld.documentLoaders.xhr=function(options){var rlink=/(^|(\r\n))link:/i;options=options||{};var loader=function(url,callback){if(0!==url.indexOf("http:")&&0!==url.indexOf("https:"))return callback(new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});if(options.secure&&0!==url.indexOf("https"))return callback(new JsonLdError('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null});var xhr=options.xhr||XMLHttpRequest,req=new xhr;req.onload=function(e){if(req.status>=400)return callback(new JsonLdError("URL could not be dereferenced: "+req.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:url,httpStatusCode:req.status}),{contextUrl:null,documentUrl:url,document:null});var linkHeader,doc={contextUrl:null,documentUrl:url,document:req.response},contentType=req.getResponseHeader("Content-Type");if(rlink.test(req.getAllResponseHeaders())&&(linkHeader=req.getResponseHeader("Link")),linkHeader&&"application/ld+json"!==contentType){if(linkHeader=jsonld.parseLinkHeader(linkHeader)[LINK_HEADER_REL],_isArray(linkHeader))return callback(new JsonLdError("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:url}),doc);linkHeader&&(doc.contextUrl=linkHeader.target)}callback(null,doc)},req.onerror=function(){callback(new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:url}),{contextUrl:null,documentUrl:url,document:null})},req.open("GET",url,!0),req.setRequestHeader("Accept","application/ld+json, application/json"),req.send()},usePromise="undefined"!=typeof Promise;return"usePromise"in options&&(usePromise=options.usePromise),usePromise?function(url){return jsonld.promisify(loader,url)}:loader},jsonld.useDocumentLoader=function(type){if(!(type in jsonld.documentLoaders))throw new JsonLdError('Unknown document loader type: "'+type+'"',"jsonld.UnknownDocumentLoader",{type:type});jsonld.documentLoader=jsonld.documentLoaders[type].apply(jsonld,Array.prototype.slice.call(arguments,1))},jsonld.processContext=function(activeCtx,localCtx){var options={},callbackArg=2;arguments.length>3&&(options=arguments[2]||{},callbackArg+=1);var callback=arguments[callbackArg];return"base"in options||(options.base=""),"documentLoader"in options||(options.documentLoader=jsonld.loadDocument),null===localCtx?callback(null,_getInitialContext(options)):(localCtx=_clone(localCtx),_isObject(localCtx)&&"@context"in localCtx||(localCtx={"@context":localCtx}),void _retrieveContextUrls(localCtx,options,function(err,ctx){if(err)return callback(err);try{ctx=(new Processor).processContext(activeCtx,ctx,options)}catch(ex){return callback(ex)}callback(null,ctx)}))},jsonld.hasProperty=function(subject,property){var rval=!1;if(property in subject){var value=subject[property];rval=!_isArray(value)||value.length>0}return rval},jsonld.hasValue=function(subject,property,value){var rval=!1;if(jsonld.hasProperty(subject,property)){var val=subject[property],isList=_isList(val);if(_isArray(val)||isList){isList&&(val=val["@list"]);for(var i=0;i<val.length;++i)if(jsonld.compareValues(value,val[i])){rval=!0;break}}else _isArray(value)||(rval=jsonld.compareValues(value,val))}return rval},jsonld.addValue=function(subject,property,value,options){if(options=options||{},"propertyIsArray"in options||(options.propertyIsArray=!1),"allowDuplicate"in options||(options.allowDuplicate=!0),_isArray(value)){0!==value.length||!options.propertyIsArray||property in subject||(subject[property]=[]);for(var i=0;i<value.length;++i)jsonld.addValue(subject,property,value[i],options)}else if(property in subject){var hasValue=!options.allowDuplicate&&jsonld.hasValue(subject,property,value);_isArray(subject[property])||hasValue&&!options.propertyIsArray||(subject[property]=[subject[property]]),hasValue||subject[property].push(value)}else subject[property]=options.propertyIsArray?[value]:value},jsonld.getValues=function(subject,property){var rval=subject[property]||[];return _isArray(rval)||(rval=[rval]),rval},jsonld.removeProperty=function(subject,property){delete subject[property]},jsonld.removeValue=function(subject,property,value,options){options=options||{},"propertyIsArray"in options||(options.propertyIsArray=!1);var values=jsonld.getValues(subject,property).filter(function(e){return!jsonld.compareValues(e,value)});0===values.length?jsonld.removeProperty(subject,property):1!==values.length||options.propertyIsArray?subject[property]=values:subject[property]=values[0]},jsonld.compareValues=function(v1,v2){return v1===v2?!0:_isValue(v1)&&_isValue(v2)&&v1["@value"]===v2["@value"]&&v1["@type"]===v2["@type"]&&v1["@language"]===v2["@language"]&&v1["@index"]===v2["@index"]?!0:_isObject(v1)&&"@id"in v1&&_isObject(v2)&&"@id"in v2?v1["@id"]===v2["@id"]:!1},jsonld.getContextValue=function(ctx,key,type){var rval=null;if(null===key)return rval;if("@language"===type&&type in ctx&&(rval=ctx[type]),ctx.mappings[key]){var entry=ctx.mappings[key];_isUndefined(type)?rval=entry:type in entry&&(rval=entry[type])}return rval};var _rdfParsers={};if(jsonld.registerRDFParser=function(contentType,parser){_rdfParsers[contentType]=parser},jsonld.unregisterRDFParser=function(contentType){delete _rdfParsers[contentType]},_nodejs){if("undefined"==typeof XMLSerializer)var XMLSerializer=null;if("undefined"==typeof Node)var Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var XSD_BOOLEAN="http://www.w3.org/2001/XMLSchema#boolean",XSD_DOUBLE="http://www.w3.org/2001/XMLSchema#double",XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer",XSD_STRING="http://www.w3.org/2001/XMLSchema#string",RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_LIST=RDF+"List",RDF_FIRST=RDF+"first",RDF_REST=RDF+"rest",RDF_NIL=RDF+"nil",RDF_TYPE=RDF+"type",RDF_PLAIN_LITERAL=RDF+"PlainLiteral",RDF_XML_LITERAL=RDF+"XMLLiteral",RDF_OBJECT=RDF+"object",RDF_LANGSTRING=RDF+"langString",LINK_HEADER_REL="http://www.w3.org/ns/json-ld#context",MAX_CONTEXT_URLS=10,JsonLdError=function(msg,type,details){_nodejs?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=type||"jsonld.Error",this.message=msg||"An unspecified JSON-LD error occurred.",this.details=details||{}};_nodejs?require("util").inherits(JsonLdError,Error):"undefined"!=typeof Error&&(JsonLdError.prototype=new Error);var Processor=function(){};Processor.prototype.compact=function(activeCtx,activeProperty,element,options){if(_isArray(element)){for(var rval=[],i=0;i<element.length;++i){var compacted=this.compact(activeCtx,activeProperty,element[i],options);null!==compacted&&rval.push(compacted)}if(options.compactArrays&&1===rval.length){var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");null===container&&(rval=rval[0])}return rval}if(_isObject(element)){if(options.link&&"@id"in element&&element["@id"]in options.link)for(var linked=options.link[element["@id"]],i=0;i<linked.length;++i)if(linked[i].expanded===element)return linked[i].compacted;if(_isValue(element)||_isSubjectReference(element)){var rval=_compactValue(activeCtx,activeProperty,element);return options.link&&_isSubjectReference(element)&&(element["@id"]in options.link||(options.link[element["@id"]]=[]),options.link[element["@id"]].push({expanded:element,compacted:rval})),rval}var insideReverse="@reverse"===activeProperty,rval={};options.link&&"@id"in element&&(element["@id"]in options.link||(options.link[element["@id"]]=[]),options.link[element["@id"]].push({expanded:element,compacted:rval}));for(var keys=Object.keys(element).sort(),ki=0;ki<keys.length;++ki){var expandedProperty=keys[ki],expandedValue=element[expandedProperty];if("@id"!==expandedProperty&&"@type"!==expandedProperty)if("@reverse"!==expandedProperty)if("@index"!==expandedProperty)if("@graph"!==expandedProperty&&"@list"!==expandedProperty&&_isKeyword(expandedProperty)){var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,expandedValue)}else{if(0===expandedValue.length){var itemActiveProperty=_compactIri(activeCtx,expandedProperty,expandedValue,{vocab:!0},insideReverse);jsonld.addValue(rval,itemActiveProperty,expandedValue,{propertyIsArray:!0})}for(var vi=0;vi<expandedValue.length;++vi){var expandedItem=expandedValue[vi],itemActiveProperty=_compactIri(activeCtx,expandedProperty,expandedItem,{vocab:!0},insideReverse),container=jsonld.getContextValue(activeCtx,itemActiveProperty,"@container"),isList=_isList(expandedItem),list=null;isList&&(list=expandedItem["@list"]);var compactedItem=this.compact(activeCtx,itemActiveProperty,isList?list:expandedItem,options);if(isList)if(_isArray(compactedItem)||(compactedItem=[compactedItem]),"@list"!==container){var wrapper={};wrapper[_compactIri(activeCtx,"@list")]=compactedItem,compactedItem=wrapper,"@index"in expandedItem&&(compactedItem[_compactIri(activeCtx,"@index")]=expandedItem["@index"])}else if(itemActiveProperty in rval)throw new JsonLdError('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===container||"@index"===container){var mapObject;itemActiveProperty in rval?mapObject=rval[itemActiveProperty]:rval[itemActiveProperty]=mapObject={},"@language"===container&&_isValue(compactedItem)&&(compactedItem=compactedItem["@value"]),jsonld.addValue(mapObject,expandedItem[container],compactedItem)}else{var isArray=!options.compactArrays||"@set"===container||"@list"===container||_isArray(compactedItem)&&0===compactedItem.length||"@list"===expandedProperty||"@graph"===expandedProperty;jsonld.addValue(rval,itemActiveProperty,compactedItem,{propertyIsArray:isArray})}}}else{var container=jsonld.getContextValue(activeCtx,activeProperty,"@container");if("@index"===container)continue;var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,expandedValue)}else{var compactedValue=this.compact(activeCtx,"@reverse",expandedValue,options);for(var compactedProperty in compactedValue)if(activeCtx.mappings[compactedProperty]&&activeCtx.mappings[compactedProperty].reverse){var value=compactedValue[compactedProperty],container=jsonld.getContextValue(activeCtx,compactedProperty,"@container"),useArray="@set"===container||!options.compactArrays;jsonld.addValue(rval,compactedProperty,value,{propertyIsArray:useArray}),delete compactedValue[compactedProperty]}if(Object.keys(compactedValue).length>0){var alias=_compactIri(activeCtx,expandedProperty);jsonld.addValue(rval,alias,compactedValue)}}else{var compactedValue;if(_isString(expandedValue))compactedValue=_compactIri(activeCtx,expandedValue,null,{vocab:"@type"===expandedProperty});else{compactedValue=[];for(var vi=0;vi<expandedValue.length;++vi)compactedValue.push(_compactIri(activeCtx,expandedValue[vi],null,{vocab:!0}))}var alias=_compactIri(activeCtx,expandedProperty),isArray=_isArray(compactedValue)&&0===expandedValue.length;jsonld.addValue(rval,alias,compactedValue,{propertyIsArray:isArray})}}return rval}return element},Processor.prototype.expand=function(activeCtx,activeProperty,element,options,insideList){var self=this;if(null===element||void 0===element)return null;if(!_isArray(element)&&!_isObject(element))return insideList||null!==activeProperty&&"@graph"!==_expandIri(activeCtx,activeProperty,{vocab:!0})?_expandValue(activeCtx,activeProperty,element):null;if(_isArray(element)){var rval=[],container=jsonld.getContextValue(activeCtx,activeProperty,"@container");insideList=insideList||"@list"===container;for(var i=0;i<element.length;++i){var e=self.expand(activeCtx,activeProperty,element[i],options);if(insideList&&(_isArray(e)||_isList(e)))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==e&&(_isArray(e)?rval=rval.concat(e):rval.push(e))}return rval}"@context"in element&&(activeCtx=self.processContext(activeCtx,element["@context"],options));for(var expandedActiveProperty=_expandIri(activeCtx,activeProperty,{vocab:!0}),rval={},keys=Object.keys(element).sort(),ki=0;ki<keys.length;++ki){var expandedValue,key=keys[ki],value=element[key];if("@context"!==key){var expandedProperty=_expandIri(activeCtx,key,{vocab:!0});if(null!==expandedProperty&&(_isAbsoluteIri(expandedProperty)||_isKeyword(expandedProperty))){if(_isKeyword(expandedProperty)){if("@reverse"===expandedActiveProperty)throw new JsonLdError("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:value});if(expandedProperty in rval)throw new JsonLdError("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:expandedProperty})}if("@id"===expandedProperty&&!_isString(value)){if(!options.isFrame)throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:value});if(!_isObject(value))throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:value})}if("@type"===expandedProperty&&_validateTypeValue(value),"@graph"===expandedProperty&&!_isObject(value)&&!_isArray(value))throw new JsonLdError('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:value});if("@value"===expandedProperty&&(_isObject(value)||_isArray(value)))throw new JsonLdError('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:value});if("@language"===expandedProperty){if(null===value)continue;if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:value});value=value.toLowerCase()}if("@index"===expandedProperty&&!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:value});if("@reverse"!==expandedProperty){var container=jsonld.getContextValue(activeCtx,key,"@container");if("@language"===container&&_isObject(value))expandedValue=_expandLanguageMap(value);else if("@index"===container&&_isObject(value))expandedValue=function(activeProperty){for(var rval=[],keys=Object.keys(value).sort(),ki=0;ki<keys.length;++ki){var key=keys[ki],val=value[key];_isArray(val)||(val=[val]),val=self.expand(activeCtx,activeProperty,val,options,!1);for(var vi=0;vi<val.length;++vi){var item=val[vi];"@index"in item||(item["@index"]=key),rval.push(item)}}return rval}(key);else{var isList="@list"===expandedProperty;if(isList||"@set"===expandedProperty){var nextActiveProperty=activeProperty;if(isList&&"@graph"===expandedActiveProperty&&(nextActiveProperty=null),expandedValue=self.expand(activeCtx,nextActiveProperty,value,options,isList),isList&&_isList(expandedValue))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else expandedValue=self.expand(activeCtx,key,value,options,!1)}if(null!==expandedValue||"@value"===expandedProperty)if("@list"===expandedProperty||_isList(expandedValue)||"@list"!==container||(expandedValue=_isArray(expandedValue)?expandedValue:[expandedValue],expandedValue={"@list":expandedValue}),activeCtx.mappings[key]&&activeCtx.mappings[key].reverse){var reverseMap=rval["@reverse"]=rval["@reverse"]||{};_isArray(expandedValue)||(expandedValue=[expandedValue]);for(var ii=0;ii<expandedValue.length;++ii){var item=expandedValue[ii];if(_isValue(item)||_isList(item))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue});jsonld.addValue(reverseMap,expandedProperty,item,{propertyIsArray:!0})}}else{var useArray=-1===["@index","@id","@type","@value","@language"].indexOf(expandedProperty);jsonld.addValue(rval,expandedProperty,expandedValue,{propertyIsArray:useArray})}}else{if(!_isObject(value))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:value});if(expandedValue=self.expand(activeCtx,"@reverse",value,options),"@reverse"in expandedValue)for(var property in expandedValue["@reverse"])jsonld.addValue(rval,property,expandedValue["@reverse"][property],{propertyIsArray:!0});var reverseMap=rval["@reverse"]||null;for(var property in expandedValue)if("@reverse"!==property){null===reverseMap&&(reverseMap=rval["@reverse"]={}),jsonld.addValue(reverseMap,property,[],{propertyIsArray:!0});for(var items=expandedValue[property],ii=0;ii<items.length;++ii){var item=items[ii];if(_isValue(item)||_isList(item))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:expandedValue});jsonld.addValue(reverseMap,property,item,{propertyIsArray:!0})}}}}}}keys=Object.keys(rval);var count=keys.length;if("@value"in rval){if("@type"in rval&&"@language"in rval)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:rval});var validCount=count-1;if("@type"in rval&&(validCount-=1),"@index"in rval&&(validCount-=1),"@language"in rval&&(validCount-=1),0!==validCount)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:rval});if(null===rval["@value"])rval=null;else{if("@language"in rval&&!_isString(rval["@value"]))throw new JsonLdError("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:rval});if("@type"in rval&&(!_isAbsoluteIri(rval["@type"])||0===rval["@type"].indexOf("_:")))throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:rval})}}else if("@type"in rval&&!_isArray(rval["@type"]))rval["@type"]=[rval["@type"]];else if("@set"in rval||"@list"in rval){if(count>1&&!(2===count&&"@index"in rval))throw new JsonLdError('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:rval});"@set"in rval&&(rval=rval["@set"],keys=Object.keys(rval),count=keys.length)}else 1===count&&"@language"in rval&&(rval=null);return!_isObject(rval)||options.keepFreeFloatingNodes||insideList||null!==activeProperty&&"@graph"!==expandedActiveProperty||(0===count||"@value"in rval||"@list"in rval||1===count&&"@id"in rval)&&(rval=null),rval},Processor.prototype.createNodeMap=function(input,options){options=options||{};var namer=options.namer||new UniqueNamer("_:b"),graphs={"@default":{}};return _createNodeMap(input,graphs,"@default",namer),_mergeNodeMaps(graphs)},Processor.prototype.flatten=function(input){for(var defaultGraph=this.createNodeMap(input),flattened=[],keys=Object.keys(defaultGraph).sort(),ki=0;ki<keys.length;++ki){var node=defaultGraph[keys[ki]];_isSubjectReference(node)||flattened.push(node)}return flattened},Processor.prototype.frame=function(input,frame,options){var state={options:options,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},namer=new UniqueNamer("_:b");_createNodeMap(input,state.graphs,"@merged",namer),state.subjects=state.graphs["@merged"];var framed=[];return _frame(state,Object.keys(state.subjects).sort(),frame,framed,null),framed},Processor.prototype.normalize=function(dataset,options,callback){function hashBlankNodes(unnamed){function hashUnnamed(i){if(i===unnamed.length)return nameBlankNodes(unique,duplicates,nextUnnamed);var bnode=unnamed[i],hash=_hashQuads(bnode,bnodes);hash in duplicates?(duplicates[hash].push(bnode),nextUnnamed.push(bnode)):hash in unique?(duplicates[hash]=[unique[hash],bnode],nextUnnamed.push(unique[hash]),nextUnnamed.push(bnode),delete unique[hash]):unique[hash]=bnode,jsonld.setImmediate(function(){hashUnnamed(i+1)})}var nextUnnamed=[],duplicates={},unique={};jsonld.setImmediate(function(){hashUnnamed(0)})}function nameBlankNodes(unique,duplicates,unnamed){for(var named=!1,hashes=Object.keys(unique).sort(),i=0;i<hashes.length;++i){var bnode=unique[hashes[i]];namer.getName(bnode),named=!0}named?hashBlankNodes(unnamed):nameDuplicates(duplicates)}function nameDuplicates(duplicates){function processGroup(i){function nameGroupMember(group,n){if(n===group.length){results.sort(function(a,b){return a=a.hash,b=b.hash,b>a?-1:a>b?1:0});for(var r=0;r<results.length;++r)for(var key in results[r].pathNamer.existing)namer.getName(key);return processGroup(i+1)}var bnode=group[n];if(namer.isNamed(bnode))return nameGroupMember(group,n+1);var pathNamer=new UniqueNamer("_:b");pathNamer.getName(bnode),_hashPaths(bnode,bnodes,namer,pathNamer,function(err,result){return err?callback(err):(results.push(result),void nameGroupMember(group,n+1))})}if(i===hashes.length)return createArray();var group=duplicates[hashes[i]],results=[];nameGroupMember(group,0)}var hashes=Object.keys(duplicates).sort();processGroup(0)}function createArray(){for(var normalized=[],i=0;i<quads.length;++i){for(var quad=quads[i],attrs=["subject","object","name"],ai=0;ai<attrs.length;++ai){var attr=attrs[ai];quad[attr]&&"blank node"===quad[attr].type&&0!==quad[attr].value.indexOf("_:c14n")&&(quad[attr].value=namer.getName(quad[attr].value))}normalized.push(_toNQuad(quad,quad.name?quad.name.value:null))}return normalized.sort(),options.format?"application/nquads"===options.format?callback(null,normalized.join("")):callback(new JsonLdError("Unknown output format.","jsonld.UnknownFormat",{format:options.format})):void callback(null,_parseNQuads(normalized.join("")))}var quads=[],bnodes={};for(var graphName in dataset){var triples=dataset[graphName];"@default"===graphName&&(graphName=null);for(var ti=0;ti<triples.length;++ti){var quad=triples[ti];null!==graphName&&(0===graphName.indexOf("_:")?quad.name={type:"blank node",value:graphName}:quad.name={type:"IRI",value:graphName}),quads.push(quad);for(var attrs=["subject","object","name"],ai=0;ai<attrs.length;++ai){var attr=attrs[ai];if(quad[attr]&&"blank node"===quad[attr].type){var id=quad[attr].value;id in bnodes?bnodes[id].quads.push(quad):bnodes[id]={quads:[quad]}}}}}var namer=new UniqueNamer("_:c14n");return hashBlankNodes(Object.keys(bnodes))},Processor.prototype.fromRDF=function(dataset,options,callback){var defaultGraph={},graphMap={"@default":defaultGraph},referencedOnce={};for(var name in dataset){var graph=dataset[name];name in graphMap||(graphMap[name]={}),"@default"===name||name in defaultGraph||(defaultGraph[name]={"@id":name});for(var nodeMap=graphMap[name],ti=0;ti<graph.length;++ti){var triple=graph[ti],s=triple.subject.value,p=triple.predicate.value,o=triple.object;s in nodeMap||(nodeMap[s]={"@id":s});var node=nodeMap[s],objectIsId="IRI"===o.type||"blank node"===o.type;if(!objectIsId||o.value in nodeMap||(nodeMap[o.value]={"@id":o.value}),p!==RDF_TYPE||options.useRdfType||!objectIsId){var value=_RDFToObject(o,options.useNativeTypes);if(jsonld.addValue(node,p,value,{propertyIsArray:!0}),objectIsId)if(o.value===RDF_NIL){var object=nodeMap[o.value];"usages"in object||(object.usages=[]),object.usages.push({node:node,property:p,value:value})}else o.value in referencedOnce?referencedOnce[o.value]=!1:referencedOnce[o.value]={node:node,property:p,value:value}}else jsonld.addValue(node,"@type",o.value,{propertyIsArray:!0})}}for(var name in graphMap){var graphObject=graphMap[name];if(RDF_NIL in graphObject){for(var nil=graphObject[RDF_NIL],i=0;i<nil.usages.length;++i){for(var usage=nil.usages[i],node=usage.node,property=usage.property,head=usage.value,list=[],listNodes=[],nodeKeyCount=Object.keys(node).length;property===RDF_REST&&_isObject(referencedOnce[node["@id"]])&&_isArray(node[RDF_FIRST])&&1===node[RDF_FIRST].length&&_isArray(node[RDF_REST])&&1===node[RDF_REST].length&&(3===nodeKeyCount||4===nodeKeyCount&&_isArray(node["@type"])&&1===node["@type"].length&&node["@type"][0]===RDF_LIST)&&(list.push(node[RDF_FIRST][0]),listNodes.push(node["@id"]),usage=referencedOnce[node["@id"]],node=usage.node,property=usage.property,head=usage.value,nodeKeyCount=Object.keys(node).length,0===node["@id"].indexOf("_:")););if(property===RDF_FIRST){if(node["@id"]===RDF_NIL)continue;head=graphObject[head["@id"]][RDF_REST][0],list.pop(),listNodes.pop()}delete head["@id"],head["@list"]=list.reverse();for(var j=0;j<listNodes.length;++j)delete graphObject[listNodes[j]]}delete nil.usages}}for(var result=[],subjects=Object.keys(defaultGraph).sort(),i=0;i<subjects.length;++i){var subject=subjects[i],node=defaultGraph[subject];if(subject in graphMap)for(var graph=node["@graph"]=[],graphObject=graphMap[subject],subjects_=Object.keys(graphObject).sort(),si=0;si<subjects_.length;++si){
var node_=graphObject[subjects_[si]];_isSubjectReference(node_)||graph.push(node_)}_isSubjectReference(node)||result.push(node)}callback(null,result)},Processor.prototype.toRDF=function(input,options){var namer=new UniqueNamer("_:b"),nodeMap={"@default":{}};_createNodeMap(input,nodeMap,"@default",namer);for(var dataset={},graphNames=Object.keys(nodeMap).sort(),i=0;i<graphNames.length;++i){var graphName=graphNames[i];("@default"===graphName||_isAbsoluteIri(graphName))&&(dataset[graphName]=_graphToRDF(nodeMap[graphName],namer,options))}return dataset},Processor.prototype.processContext=function(activeCtx,localCtx,options){_isObject(localCtx)&&"@context"in localCtx&&_isArray(localCtx["@context"])&&(localCtx=localCtx["@context"]);var ctxs=_isArray(localCtx)?localCtx:[localCtx];if(0===ctxs.length)return activeCtx.clone();for(var rval=activeCtx,i=0;i<ctxs.length;++i){var ctx=ctxs[i];if(null!==ctx){if(_isObject(ctx)&&"@context"in ctx&&(ctx=ctx["@context"]),!_isObject(ctx))throw new JsonLdError("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ctx});if(jsonld.cache.activeCtx){var cached=jsonld.cache.activeCtx.get(activeCtx,ctx);if(cached){rval=activeCtx=cached;continue}}activeCtx=rval,rval=rval.clone();var defined={};if("@base"in ctx){var base=ctx["@base"];if(null===base)base=null;else{if(!_isString(base))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ctx});if(""!==base&&!_isAbsoluteIri(base))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ctx})}null!==base&&(base=jsonld.url.parse(base||"")),rval["@base"]=base,defined["@base"]=!0}if("@vocab"in ctx){var value=ctx["@vocab"];if(null===value)delete rval["@vocab"];else{if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx});if(!_isAbsoluteIri(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ctx});rval["@vocab"]=value}defined["@vocab"]=!0}if("@language"in ctx){var value=ctx["@language"];if(null===value)delete rval["@language"];else{if(!_isString(value))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:ctx});rval["@language"]=value.toLowerCase()}defined["@language"]=!0}for(var key in ctx)_createTermDefinition(rval,ctx,key,defined);jsonld.cache.activeCtx&&jsonld.cache.activeCtx.set(activeCtx,ctx,rval)}else rval=activeCtx=_getInitialContext(options)}return rval},Object.keys||(Object.keys=function(o){if(o!==Object(o))throw new TypeError("Object.keys called on non-object");var rval=[];for(var p in o)Object.prototype.hasOwnProperty.call(o,p)&&rval.push(p);return rval}),jsonld.registerRDFParser("application/nquads",_parseNQuads),jsonld.registerRDFParser("rdfa-api",_parseRdfaApiData),jsonld.UniqueNamer=UniqueNamer,UniqueNamer.prototype.clone=function(){var copy=new UniqueNamer(this.prefix);return copy.counter=this.counter,copy.existing=_clone(this.existing),copy},UniqueNamer.prototype.getName=function(oldName){if(oldName&&oldName in this.existing)return this.existing[oldName];var name=this.prefix+this.counter;return this.counter+=1,oldName&&(this.existing[oldName]=name),name},UniqueNamer.prototype.isNamed=function(oldName){return oldName in this.existing};var Permutator=function(list){this.list=list.sort(),this.done=!1,this.left={};for(var i=0;i<list.length;++i)this.left[list[i]]=!0};Permutator.prototype.hasNext=function(){return!this.done},Permutator.prototype.next=function(){for(var rval=this.list.slice(),k=null,pos=0,length=this.list.length,i=0;length>i;++i){var element=this.list[i],left=this.left[element];(null===k||element>k)&&(left&&i>0&&element>this.list[i-1]||!left&&length-1>i&&element>this.list[i+1])&&(k=element,pos=i)}if(null===k)this.done=!0;else{var swap=this.left[k]?pos-1:pos+1;this.list[pos]=this.list[swap],this.list[swap]=k;for(var i=0;length>i;++i)this.list[i]>k&&(this.left[this.list[i]]=!this.left[this.list[i]])}return rval};var sha1=jsonld.sha1={};if(_nodejs){var crypto=require("crypto");sha1.create=function(){var md=crypto.createHash("sha1");return{update:function(data){md.update(data,"utf8")},digest:function(){return md.digest("hex")}}}}else sha1.create=function(){return new sha1.MessageDigest};if(sha1.hash=function(nquads){for(var md=sha1.create(),i=0;i<nquads.length;++i)md.update(nquads[i]);return md.digest()},!_nodejs){sha1.Buffer=function(){this.data="",this.read=0},sha1.Buffer.prototype.putInt32=function(i){this.data+=String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(255&i)},sha1.Buffer.prototype.getInt32=function(){var rval=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,rval},sha1.Buffer.prototype.bytes=function(){return this.data.slice(this.read)},sha1.Buffer.prototype.length=function(){return this.data.length-this.read},sha1.Buffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},sha1.Buffer.prototype.toHex=function(){for(var rval="",i=this.read;i<this.data.length;++i){var b=this.data.charCodeAt(i);16>b&&(rval+="0"),rval+=b.toString(16)}return rval},sha1.MessageDigest=function(){_sha1.initialized||_sha1.init(),this.blockLength=64,this.digestLength=20,this.messageLength=0,this.input=new sha1.Buffer,this.words=new Array(80),this.state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}},sha1.MessageDigest.prototype.update=function(msg){msg=unescape(encodeURIComponent(msg)),this.messageLength+=msg.length,this.input.data+=msg,_sha1.update(this.state,this.words,this.input),(this.input.read>2048||0===this.input.length())&&this.input.compact()},sha1.MessageDigest.prototype.digest=function(){var len=this.messageLength,padBytes=new sha1.Buffer;padBytes.data+=this.input.bytes(),padBytes.data+=_sha1.padding.substr(0,64-(len+8)%64),padBytes.putInt32(len>>>29&255),padBytes.putInt32(len<<3&4294967295),_sha1.update(this.state,this.words,padBytes);var rval=new sha1.Buffer;return rval.putInt32(this.state.h0),rval.putInt32(this.state.h1),rval.putInt32(this.state.h2),rval.putInt32(this.state.h3),rval.putInt32(this.state.h4),rval.toHex()};var _sha1={padding:null,initialized:!1};_sha1.init=function(){_sha1.padding=String.fromCharCode(128);for(var c=String.fromCharCode(0),n=64;n>0;)1&n&&(_sha1.padding+=c),n>>>=1,n>0&&(c+=c);_sha1.initialized=!0},_sha1.update=function(s,w,input){for(var t,a,b,c,d,e,f,i,len=input.length();len>=64;){for(a=s.h0,b=s.h1,c=s.h2,d=s.h3,e=s.h4,i=0;16>i;++i)t=input.getInt32(),w[i]=t,f=d^b&(c^d),t=(a<<5|a>>>27)+f+e+1518500249+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;20>i;++i)t=w[i-3]^w[i-8]^w[i-14]^w[i-16],t=t<<1|t>>>31,w[i]=t,f=d^b&(c^d),t=(a<<5|a>>>27)+f+e+1518500249+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;32>i;++i)t=w[i-3]^w[i-8]^w[i-14]^w[i-16],t=t<<1|t>>>31,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+1859775393+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;40>i;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+1859775393+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;60>i;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b&c|d&(b^c),t=(a<<5|a>>>27)+f+e+2400959708+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;80>i;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+3395469782+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;s.h0+=a,s.h1+=b,s.h2+=c,s.h3+=d,s.h4+=e,len-=64}}}if(!XMLSerializer)var _defineXMLSerializer=function(){XMLSerializer=require("xmldom").XMLSerializer};if(jsonld.url={},jsonld.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},jsonld.url.parse=function(str,parser){for(var parsed={},o=jsonld.url.parsers[parser||"full"],m=o.regex.exec(str),i=o.keys.length;i--;)parsed[o.keys[i]]=void 0===m[i]?null:m[i];return parsed.normalizedPath=_removeDotSegments(parsed.path,!!parsed.authority),parsed},_nodejs?jsonld.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&jsonld.useDocumentLoader("xhr"),_nodejs){jsonld.use=function(extension){switch(extension){case"request":jsonld.request=require("./request");break;default:throw new JsonLdError("Unknown extension.","jsonld.UnknownExtension",{extension:extension})}};var _module={exports:{},filename:__dirname};require("pkginfo")(_module,"version"),jsonld.version=_module.exports.version}return jsonld},factory=function(){return wrapper(function(){return factory()})};return!_nodejs&&"function"==typeof define&&define.amd?define([],function(){return wrapper(factory),factory}):(wrapper(factory),"function"==typeof require&&"undefined"!=typeof module&&module.exports&&(module.exports=factory),_browser&&("undefined"==typeof jsonld?jsonld=jsonldjs=factory:jsonldjs=factory)),factory}()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/../rdf-parser-jsonld/node_modules/jsonld/js")},{"./request":66,_process:19,crypto:66,"es6-promise":68,http:66,pkginfo:69,request:66,util:66,xmldom:66}],68:[function(require,module,exports){(function(process,global){(function(){"use strict";function $$utils$$objectOrFunction(x){return"function"==typeof x||"object"==typeof x&&null!==x}function $$utils$$isFunction(x){return"function"==typeof x}function $$utils$$isMaybeThenable(x){return"object"==typeof x&&null!==x}function $$utils$$F(){}function $$asap$$useNextTick(){return function(){process.nextTick($$asap$$flush)}}function $$asap$$useMutationObserver(){var iterations=0,observer=new $$asap$$BrowserMutationObserver($$asap$$flush),node=document.createTextNode("");return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}function $$asap$$useMessageChannel(){var channel=new MessageChannel;return channel.port1.onmessage=$$asap$$flush,function(){channel.port2.postMessage(0)}}function $$asap$$useSetTimeout(){return function(){setTimeout($$asap$$flush,1)}}function $$asap$$flush(){for(var i=0;$$asap$$len>i;i+=2){var callback=$$asap$$queue[i],arg=$$asap$$queue[i+1];callback(arg),$$asap$$queue[i]=void 0,$$asap$$queue[i+1]=void 0}$$asap$$len=0}function $$$internal$$noop(){}function $$$internal$$selfFullfillment(){return new TypeError("You cannot resolve a promise with itself")}function $$$internal$$cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function $$$internal$$getThen(promise){try{return promise.then}catch(error){return $$$internal$$GET_THEN_ERROR.error=error,$$$internal$$GET_THEN_ERROR}}function $$$internal$$tryThen(then,value,fulfillmentHandler,rejectionHandler){try{then.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function $$$internal$$handleForeignThenable(promise,thenable,then){$$asap$$default(function(promise){var sealed=!1,error=$$$internal$$tryThen(then,thenable,function(value){sealed||(sealed=!0,thenable!==value?$$$internal$$resolve(promise,value):$$$internal$$fulfill(promise,value))},function(reason){sealed||(sealed=!0,$$$internal$$reject(promise,reason))},"Settle: "+(promise._label||" unknown promise"));!sealed&&error&&(sealed=!0,$$$internal$$reject(promise,error))},promise)}function $$$internal$$handleOwnThenable(promise,thenable){thenable._state===$$$internal$$FULFILLED?$$$internal$$fulfill(promise,thenable._result):promise._state===$$$internal$$REJECTED?$$$internal$$reject(promise,thenable._result):$$$internal$$subscribe(thenable,void 0,function(value){$$$internal$$resolve(promise,value)},function(reason){$$$internal$$reject(promise,reason)})}function $$$internal$$handleMaybeThenable(promise,maybeThenable){if(maybeThenable.constructor===promise.constructor)$$$internal$$handleOwnThenable(promise,maybeThenable);else{var then=$$$internal$$getThen(maybeThenable);then===$$$internal$$GET_THEN_ERROR?$$$internal$$reject(promise,$$$internal$$GET_THEN_ERROR.error):void 0===then?$$$internal$$fulfill(promise,maybeThenable):$$utils$$isFunction(then)?$$$internal$$handleForeignThenable(promise,maybeThenable,then):$$$internal$$fulfill(promise,maybeThenable)}}function $$$internal$$resolve(promise,value){promise===value?$$$internal$$reject(promise,$$$internal$$selfFullfillment()):$$utils$$objectOrFunction(value)?$$$internal$$handleMaybeThenable(promise,value):$$$internal$$fulfill(promise,value)}function $$$internal$$publishRejection(promise){promise._onerror&&promise._onerror(promise._result),$$$internal$$publish(promise)}function $$$internal$$fulfill(promise,value){promise._state===$$$internal$$PENDING&&(promise._result=value,promise._state=$$$internal$$FULFILLED,0===promise._subscribers.length||$$asap$$default($$$internal$$publish,promise))}function $$$internal$$reject(promise,reason){promise._state===$$$internal$$PENDING&&(promise._state=$$$internal$$REJECTED,promise._result=reason,$$asap$$default($$$internal$$publishRejection,promise))}function $$$internal$$subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers,length=subscribers.length;parent._onerror=null,subscribers[length]=child,subscribers[length+$$$internal$$FULFILLED]=onFulfillment,subscribers[length+$$$internal$$REJECTED]=onRejection,0===length&&parent._state&&$$asap$$default($$$internal$$publish,parent)}function $$$internal$$publish(promise){var subscribers=promise._subscribers,settled=promise._state;if(0!==subscribers.length){for(var child,callback,detail=promise._result,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],child?$$$internal$$invokeCallback(settled,child,callback,detail):callback(detail);promise._subscribers.length=0}}function $$$internal$$ErrorObject(){this.error=null}function $$$internal$$tryCatch(callback,detail){try{return callback(detail)}catch(e){return $$$internal$$TRY_CATCH_ERROR.error=e,$$$internal$$TRY_CATCH_ERROR}}function $$$internal$$invokeCallback(settled,promise,callback,detail){var value,error,succeeded,failed,hasCallback=$$utils$$isFunction(callback);if(hasCallback){if(value=$$$internal$$tryCatch(callback,detail),value===$$$internal$$TRY_CATCH_ERROR?(failed=!0,error=value.error,value=null):succeeded=!0,promise===value)return void $$$internal$$reject(promise,$$$internal$$cannotReturnOwn())}else value=detail,succeeded=!0;promise._state!==$$$internal$$PENDING||(hasCallback&&succeeded?$$$internal$$resolve(promise,value):failed?$$$internal$$reject(promise,error):settled===$$$internal$$FULFILLED?$$$internal$$fulfill(promise,value):settled===$$$internal$$REJECTED&&$$$internal$$reject(promise,value))}function $$$internal$$initializePromise(promise,resolver){try{resolver(function(value){$$$internal$$resolve(promise,value)},function(reason){$$$internal$$reject(promise,reason)})}catch(e){$$$internal$$reject(promise,e)}}function $$$enumerator$$Enumerator(Constructor,input,abortOnReject,label){this._instanceConstructor=Constructor,this.promise=new Constructor($$$internal$$noop,label),this._abortOnReject=abortOnReject,this._validateInput(input)?(this._input=input,this.length=input.length,this._remaining=input.length,this._init(),0===this.length?$$$internal$$fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&$$$internal$$fulfill(this.promise,this._result))):$$$internal$$reject(this.promise,this._validationError())}function $$es6$promise$promise$$needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function $$es6$promise$promise$$needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function $$es6$promise$promise$$Promise(resolver){this._id=$$es6$promise$promise$$counter++,this._state=void 0,this._result=void 0,this._subscribers=[],$$$internal$$noop!==resolver&&($$utils$$isFunction(resolver)||$$es6$promise$promise$$needsResolver(),this instanceof $$es6$promise$promise$$Promise||$$es6$promise$promise$$needsNew(),$$$internal$$initializePromise(this,resolver))}var $$utils$$_isArray;$$utils$$_isArray=Array.isArray?Array.isArray:function(x){return"[object Array]"===Object.prototype.toString.call(x)};var $$asap$$scheduleFlush,$$utils$$isArray=$$utils$$_isArray,$$asap$$len=(Date.now||function(){return(new Date).getTime()},Object.create||function(o){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof o)throw new TypeError("Argument must be an object");return $$utils$$F.prototype=o,new $$utils$$F},0),$$asap$$default=function(callback,arg){$$asap$$queue[$$asap$$len]=callback,$$asap$$queue[$$asap$$len+1]=arg,$$asap$$len+=2,2===$$asap$$len&&$$asap$$scheduleFlush()},$$asap$$browserGlobal="undefined"!=typeof window?window:{},$$asap$$BrowserMutationObserver=$$asap$$browserGlobal.MutationObserver||$$asap$$browserGlobal.WebKitMutationObserver,$$asap$$isWorker="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$$asap$$queue=new Array(1e3);$$asap$$scheduleFlush="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?$$asap$$useNextTick():$$asap$$BrowserMutationObserver?$$asap$$useMutationObserver():$$asap$$isWorker?$$asap$$useMessageChannel():$$asap$$useSetTimeout();var $$$internal$$PENDING=void 0,$$$internal$$FULFILLED=1,$$$internal$$REJECTED=2,$$$internal$$GET_THEN_ERROR=new $$$internal$$ErrorObject,$$$internal$$TRY_CATCH_ERROR=new $$$internal$$ErrorObject;$$$enumerator$$Enumerator.prototype._validateInput=function(input){return $$utils$$isArray(input)},$$$enumerator$$Enumerator.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},$$$enumerator$$Enumerator.prototype._init=function(){this._result=new Array(this.length)};var $$$enumerator$$default=$$$enumerator$$Enumerator;$$$enumerator$$Enumerator.prototype._enumerate=function(){for(var length=this.length,promise=this.promise,input=this._input,i=0;promise._state===$$$internal$$PENDING&&length>i;i++)this._eachEntry(input[i],i)},$$$enumerator$$Enumerator.prototype._eachEntry=function(entry,i){var c=this._instanceConstructor;$$utils$$isMaybeThenable(entry)?entry.constructor===c&&entry._state!==$$$internal$$PENDING?(entry._onerror=null,this._settledAt(entry._state,i,entry._result)):this._willSettleAt(c.resolve(entry),i):(this._remaining--,this._result[i]=this._makeResult($$$internal$$FULFILLED,i,entry))},$$$enumerator$$Enumerator.prototype._settledAt=function(state,i,value){var promise=this.promise;promise._state===$$$internal$$PENDING&&(this._remaining--,this._abortOnReject&&state===$$$internal$$REJECTED?$$$internal$$reject(promise,value):this._result[i]=this._makeResult(state,i,value)),0===this._remaining&&$$$internal$$fulfill(promise,this._result)},$$$enumerator$$Enumerator.prototype._makeResult=function(state,i,value){return value},$$$enumerator$$Enumerator.prototype._willSettleAt=function(promise,i){var enumerator=this;$$$internal$$subscribe(promise,void 0,function(value){enumerator._settledAt($$$internal$$FULFILLED,i,value)},function(reason){enumerator._settledAt($$$internal$$REJECTED,i,reason)})};var $$promise$all$$default=function(entries,label){return new $$$enumerator$$default(this,entries,!0,label).promise},$$promise$race$$default=function(entries,label){function onFulfillment(value){$$$internal$$resolve(promise,value)}function onRejection(reason){$$$internal$$reject(promise,reason)}var Constructor=this,promise=new Constructor($$$internal$$noop,label);if(!$$utils$$isArray(entries))return $$$internal$$reject(promise,new TypeError("You must pass an array to race.")),promise;for(var length=entries.length,i=0;promise._state===$$$internal$$PENDING&&length>i;i++)$$$internal$$subscribe(Constructor.resolve(entries[i]),void 0,onFulfillment,onRejection);return promise},$$promise$resolve$$default=function(object,label){var Constructor=this;if(object&&"object"==typeof object&&object.constructor===Constructor)return object;var promise=new Constructor($$$internal$$noop,label);return $$$internal$$resolve(promise,object),promise},$$promise$reject$$default=function(reason,label){var Constructor=this,promise=new Constructor($$$internal$$noop,label);return $$$internal$$reject(promise,reason),promise},$$es6$promise$promise$$counter=0,$$es6$promise$promise$$default=$$es6$promise$promise$$Promise;$$es6$promise$promise$$Promise.all=$$promise$all$$default,$$es6$promise$promise$$Promise.race=$$promise$race$$default,$$es6$promise$promise$$Promise.resolve=$$promise$resolve$$default,$$es6$promise$promise$$Promise.reject=$$promise$reject$$default,$$es6$promise$promise$$Promise.prototype={constructor:$$es6$promise$promise$$Promise,then:function(onFulfillment,onRejection){var parent=this,state=parent._state;if(state===$$$internal$$FULFILLED&&!onFulfillment||state===$$$internal$$REJECTED&&!onRejection)return this;var child=new this.constructor($$$internal$$noop),result=parent._result;if(state){var callback=arguments[state-1];$$asap$$default(function(){$$$internal$$invokeCallback(state,child,callback,result)})}else $$$internal$$subscribe(parent,child,onFulfillment,onRejection);return child},"catch":function(onRejection){return this.then(null,onRejection)}};var $$es6$promise$polyfill$$default=function(){var local;local="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var es6PromiseSupport="Promise"in local&&"resolve"in local.Promise&&"reject"in local.Promise&&"all"in local.Promise&&"race"in local.Promise&&function(){var resolve;return new local.Promise(function(r){resolve=r}),$$utils$$isFunction(resolve)}();es6PromiseSupport||(local.Promise=$$es6$promise$promise$$default)},es6$promise$umd$$ES6Promise={Promise:$$es6$promise$promise$$default,polyfill:$$es6$promise$polyfill$$default};"function"==typeof define&&define.amd?define(function(){return es6$promise$umd$$ES6Promise}):"undefined"!=typeof module&&module.exports?module.exports=es6$promise$umd$$ES6Promise:"undefined"!=typeof this&&(this.ES6Promise=es6$promise$umd$$ES6Promise)}).call(this)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:19}],69:[function(require,module,exports){(function(__dirname){var fs=require("fs"),path=require("path"),pkginfo=module.exports=function(pmodule,options){var args=[].slice.call(arguments,2).filter(function(arg){return"string"==typeof arg});Array.isArray(options)?options={include:options}:"string"==typeof options&&(options={include:[options]}),options=options||{},options.include=options.include||[],args.length>0&&(options.include=options.include.concat(args));var pkg=pkginfo.read(pmodule,options.dir)["package"];return Object.keys(pkg).forEach(function(key){options.include.length>0&&!~options.include.indexOf(key)||pmodule.exports[key]||(pmodule.exports[key]=pkg[key])}),pkginfo};pkginfo.find=function(pmodule,dir){dir||(dir=path.dirname(pmodule.filename));var files=fs.readdirSync(dir);if(~files.indexOf("package.json"))return path.join(dir,"package.json");if("/"===dir)throw new Error("Could not find package.json up from: "+dir);if(!dir||"."===dir)throw new Error("Cannot find package.json from unspecified directory");return pkginfo.find(pmodule,path.dirname(dir))},pkginfo.read=function(pmodule,dir){dir=pkginfo.find(pmodule,dir);var data=fs.readFileSync(dir).toString();return{dir:dir,"package":JSON.parse(data)}},pkginfo(module,{dir:__dirname,include:["version"],target:pkginfo})}).call(this,"/../rdf-parser-jsonld/node_modules/jsonld/node_modules/pkginfo/lib")},{fs:9,path:18}],70:[function(require,module,exports){var rdf=require("rdf-ext")(),util=require("util"),DomParser=require("rdf-parser-dom"),URIResolver=require("./uri-resolver"),MicrodataProcessor=function(){this.blankCounter=0,this.vocabularies=[{namespaceURI:"http://schema.org/",isMember:function(uri){return 0===uri.indexOf(this.namespaceURI)},getProperty:function(name){return this.namespaceURI+name}}]};MicrodataProcessor.prototype=new URIResolver,MicrodataProcessor.prototype.constructor=MicrodataProcessor,MicrodataProcessor.typeNode=rdf.createNamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),MicrodataProcessor.integerNode=rdf.createNamedNode("http://www.w3.org/2001/XMLSchema#integer"),MicrodataProcessor.doubleNode=rdf.createNamedNode("http://www.w3.org/2001/XMLSchema#double"),MicrodataProcessor.timeNode=rdf.createNamedNode("http://www.w3.org/2001/XMLSchema#time"),MicrodataProcessor.dateTimeNode=rdf.createNamedNode("http://www.w3.org/2001/XMLSchema#dateTime"),MicrodataProcessor.durationNode=rdf.createNamedNode("http://www.w3.org/2001/XMLSchema#duration"),MicrodataProcessor.absoluteURIRE=/[\w\_\-]+:\S+/,MicrodataProcessor.prototype.resolve=function(uri){return uri},MicrodataProcessor.trim=function(str){return str=str||"",str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},MicrodataProcessor.tokenize=function(str){return MicrodataProcessor.trim(str).split(/\s+/).reduce(function(tokens,token){return token&&tokens.push(token),tokens},[])},MicrodataProcessor.prototype.getVocabulary=function(uri){for(var i=0;i<this.vocabularies.length;i++)if(this.vocabularies[i].isMember(uri))return this.vocabularies[i];var makeVocab=function(ns){return{namespaceURI:ns,getProperty:function(name){return this.namespaceURI+name}}},hash=uri.indexOf("#");if(hash>=0)return makeVocab(uri.substring(0,hash+1));var lastSlash=uri.lastIndexOf("/");return makeVocab(lastSlash>=0?uri.substring(0,lastSlash+1):uri)},MicrodataProcessor.prototype.getProperty=function(value,vocabulary){return MicrodataProcessor.absoluteURIRE.exec(value)?value:vocabulary?vocabulary.getProperty(value):base.resolve("#"+value)},MicrodataProcessor.valueMappings={link:function(node,base){return rdf.createNamedNode(base.resolve(node.getAttribute("href")))},media:function(node,base){return rdf.createNamedNode(base.resolve(node.getAttribute("src")))},meta:function(node){var value=node.getAttribute("content"),lang=node.getAttribute("lang");return rdf.createLiteral(value,lang?lang:null)},number:function(node){var value=node.getAttribute("value");return value===parseInt(value).toString()?rdf.createLiteral(value,null,MicrodataProcessor.integerNode):value===parseFloat(value).toString()?rdf.createLiteral(value,null,MicrodataProcessor.doubleNode):rdf.createLiteral(value)},object:function(node,base){return rdf.createNamedNode(base.resolve(node.getAttribute("data")))},time:function(node){var value=node.getAttribute("datetime"),lang=node.getAttribute("lang");return 9===value.length?rdf.createLiteral(value,null,MicrodataProcessor.timeNode):20===value.length?rdf.createLiteral(value,null,MicrodataProcessor.dateTimeNode):"P"===value.substr(0,1)?rdf.createLiteral(value,null,MicrodataProcessor.durationNode):rdf.createLiteral(value,lang?lang:null)}},MicrodataProcessor.valueMappings.a=MicrodataProcessor.valueMappings.link,MicrodataProcessor.valueMappings.area=MicrodataProcessor.valueMappings.a,MicrodataProcessor.valueMappings.audio=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.data=MicrodataProcessor.valueMappings.number,MicrodataProcessor.valueMappings.embed=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.iframe=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.img=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.meter=MicrodataProcessor.valueMappings.number,MicrodataProcessor.valueMappings.source=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.track=MicrodataProcessor.valueMappings.media,MicrodataProcessor.valueMappings.video=MicrodataProcessor.valueMappings.media,MicrodataProcessor.prototype.getValue=function(node,base){var converter=MicrodataProcessor.valueMappings[node.localName];return converter?converter(node,base):rdf.createLiteral(node.textContent)},MicrodataProcessor.prototype.process=function(node,callback,base){var self=this;node.nodeType===node.DOCUMENT_NODE&&(node=node.documentElement),base=self.parseURI(base);var createContext=function(memory,subject,type,vocabulary){return{memory:memory?memory:{},subject:subject,type:type,vocabulary:vocabulary}},processChildren=function(current,type){for(var context,itemProp,itemScope,predicate,subject,value,child=current.item.firstChild;child;child=child.nextSibling)child.nodeType===child.ELEMENT_NODE&&(itemProp=child.getAttribute("itemprop"),itemScope=child.hasAttribute("itemscope"),context=createContext(current.context.memory,current.context.subject,type,current.context.vocabulary),subject=generateTriple({item:child,context:context}),itemProp&&MicrodataProcessor.tokenize(itemProp).forEach(function(token){predicate=MicrodataProcessor.absoluteURIRE.test(token)?rdf.createNamedNode(token):context.vocabulary?rdf.createNamedNode(context.vocabulary+token):rdf.createNamedNode(base.resolve("#"+token)),value=self.getValue(child,base),itemScope&&(value=subject),callback(rdf.createTriple(current.context.subject,predicate,value))}))},processSubject=function(current){var type,vocab,itemType=current.item.getAttribute("itemtype");MicrodataProcessor.tokenize(itemType).forEach(function(token){MicrodataProcessor.absoluteURIRE.test(token)&&(type||(type=token),callback(rdf.createTriple(current.context.subject,MicrodataProcessor.typeNode,rdf.createNamedNode(base.resolve(token)))))}),type||(type=current.context.type),type&&(vocab=self.getVocabulary(type),vocab=vocab?vocab.namespaceURI:null),vocab&&(current.context.vocabulary=vocab),processChildren(current,type)},generateTriple=function(current){var id=current.item.getAttribute("id"),itemId=current.item.getAttribute("itemid"),itemRef=current.item.getAttribute("itemref"),itemScope=current.item.hasAttribute("itemscope");return id in current.context.memory?current.context.memory[id].forEach(function(context){processSubject({item:current.item,context:context})}):(itemScope&&(itemId?current.context.subject=rdf.createNamedNode(base.resolve(itemId)):current.context.subject=rdf.createBlankNode(),MicrodataProcessor.tokenize(itemRef).forEach(function(token){token in current.context.memory||(current.context.memory[token]=[]),current.context.memory[token].push(current.context)})),processSubject(current)),current.context.subject};generateTriple({item:node,context:createContext(null,null,null,null)})};var MicrodataParser=function(){DomParser.call(this,rdf);var self=this,processor=new MicrodataProcessor;this.process=function(data,callback,base,filter,done){return new Promise(function(resolve,reject){base=base||"http://localhost/",filter=filter||function(){return!0},done=done||function(){};try{processor.process(self.parseHtmlDom(data,base),function(triple){filter(triple)&&callback(triple)},base)}catch(error){done(error),reject(error)}done(),resolve()})}};util.inherits(MicrodataParser,DomParser);var instance=new MicrodataParser;for(var property in instance)MicrodataParser[property]=instance[property];module.exports=MicrodataParser},{"./uri-resolver":71,"rdf-ext":42,"rdf-parser-dom":60,util:36}],71:[function(require,module,exports){"use strict";var URIResolver=function(){};URIResolver.SCHEME=/^[A-Za-z][A-Za-z0-9\+\-\.]*\:/,URIResolver.prototype.parseURI=function(uri){var match=URIResolver.SCHEME.exec(uri);if(!match)throw"Bad URI value, no scheme: "+uri;
var parsed={spec:uri};return parsed.scheme=match[0].substring(0,match[0].length-1),parsed.schemeSpecificPart=parsed.spec.substring(match[0].length),"/"==parsed.schemeSpecificPart.charAt(0)&&"/"==parsed.schemeSpecificPart.charAt(1)?this.parseGeneric(parsed):parsed.isGeneric=!1,parsed.normalize=function(){if(this.isGeneric&&0!=this.segments.length){if(this.path.length>1&&"/."==this.path.substring(this.path.length-2))return this.path=this.path.substring(0,this.path.length-1),this.segments.splice(this.segments.length-1,1),this.schemeSpecificPart="//"+this.authority+this.path,"undefined"!=typeof this.query&&(this.schemeSpecificPart+="?"+this.query),"undefined"!=typeof this.fragment&&(this.schemeSpecificPart+="#"+this.fragment),void(this.spec=this.scheme+":"+this.schemeSpecificPart);var end=this.path.charAt(this.path.length-1);"/"!=end&&(end="");for(var i=0;i<this.segments.length;i++)i>0&&".."==this.segments[i]&&(this.segments.splice(i-1,2),i-=2),"."==this.segments[i]&&(this.segments.splice(i,1),i--);this.path=0==this.segments.length?"/":"/"+this.segments.join("/")+end,this.schemeSpecificPart="//"+this.authority+this.path,"undefined"!=typeof this.query&&(this.schemeSpecificPart+="?"+this.query),"undefined"!=typeof this.fragment&&(this.schemeSpecificPart+="#"+this.fragment),this.spec=this.scheme+":"+this.schemeSpecificPart}},parsed.resolve=function(href){if(!href)return this.spec;if("#"==href.charAt(0)){var lastHash=this.spec.lastIndexOf("#");return 0>lastHash?this.spec+href:this.spec.substring(0,lastHash)+href}if(!this.isGeneric)throw"Cannot resolve uri against non-generic URI: "+this.spec;href.indexOf(":");if("/"==href.charAt(0))return this.scheme+"://"+this.authority+href;if("."==href.charAt(0)&&"/"==href.charAt(1)){if("/"==this.path.charAt(this.path.length-1))return this.scheme+"://"+this.authority+this.path+href.substring(2);var last=this.path.lastIndexOf("/");return this.scheme+"://"+this.authority+this.path.substring(0,last)+href.substring(1)}if(URIResolver.SCHEME.test(href))return href;if("?"==href.charAt(0))return this.scheme+"://"+this.authority+this.path+href;if("/"==this.path.charAt(this.path.length-1))return this.scheme+"://"+this.authority+this.path+href;var last=this.path.lastIndexOf("/");return this.scheme+"://"+this.authority+this.path.substring(0,last+1)+href},parsed.relativeTo=function(otherURI){if(otherURI.scheme!=this.scheme)return this.spec;if(!this.isGeneric)throw"A non generic URI cannot be made relative: "+this.spec;if(!otherURI.isGeneric)throw"Cannot make a relative URI against a non-generic URI: "+otherURI.spec;if(otherURI.authority!=this.authority)return this.spec;for(var i=0;i<this.segments.length&&i<otherURI.segments.length;i++)if(this.segments[i]!=otherURI.segments[i]){for(var relative="",j=i;j<otherURI.segments.length;j++)relative+="../";for(var j=i;j<this.segments.length;j++)relative+=this.segments[j],j+1<this.segments.length&&(relative+="/");return"/"==this.path.charAt(this.path.length-1)&&(relative+="/"),relative}if(this.segments.length==otherURI.segments.length)return this.hash?this.hash:this.query?this.query:"";if(i<this.segments.length){for(var relative="",j=i;j<this.segments.length;j++)relative+=this.segments[j],j+1<this.segments.length&&(relative+="/");return"/"==this.path.charAt(this.path.length-1)&&(relative+="/"),relative}throw"Cannot calculate a relative URI for "+this.spec+" against "+otherURI.spec},parsed},URIResolver.prototype.parseGeneric=function(parsed){if("/"!=parsed.schemeSpecificPart.charAt(0)||"/"!=parsed.schemeSpecificPart.charAt(1))throw"Generic URI values should start with '//':"+parsed.spec;var work=parsed.schemeSpecificPart.substring(2),pathStart=work.indexOf("/");parsed.authority=0>pathStart?work:work.substring(0,pathStart),parsed.path=0>pathStart?"":work.substring(pathStart);var hash=parsed.path.indexOf("#");hash>=0&&(parsed.fragment=parsed.path.substring(hash+1),parsed.path=parsed.path.substring(0,hash));var questionMark=parsed.path.indexOf("?");if(questionMark>=0&&(parsed.query=parsed.path.substring(questionMark+1),parsed.path=parsed.path.substring(0,questionMark)),"/"==parsed.path||""==parsed.path)parsed.segments=[];else{parsed.segments=parsed.path.split(/\//),parsed.segments.length>0&&""==parsed.segments[0]&&parsed.path.length>1&&"/"!=parsed.path.charAt(1)&&parsed.segments.shift(),parsed.segments.length>0&&parsed.path.length>0&&"/"==parsed.path.charAt(parsed.path.length-1)&&""==parsed.segments[parsed.segments.length-1]&&parsed.path.length>1&&"/"!=parsed.path.charAt(parsed.path.length-2)&&parsed.segments.pop();for(var i=0;i<parsed.segments.length;i++)for(var check=parsed.segments[i].split(/%[A-Za-z0-9][A-Za-z0-9]|[\ud800-\udfff][\ud800-\udfff]|[A-Za-z0-9\-\._~!$&'()*+,;=@:\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/),j=0;j<check.length;j++)if(check[j].length>0)throw"Unecaped character "+check[j].charAt(0)+" ("+check[j].charCodeAt(0)+") in URI "+parsed.spec}parsed.isGeneric=!0},module.exports=URIResolver},{}],72:[function(require,module,exports){function N3Parser(options){AbstractParser.call(this,rdf),this.options=options||{},"importPrefixMap"in this.options||(this.options.importPrefixMap=!0)}var rdf=require("rdf-ext")(),util=require("util"),AbstractParser=require("rdf-parser-abstract"),N3=require("n3");util.inherits(N3Parser,AbstractParser),N3Parser.prototype.process=function(data,callback,base,filter,done){var self=this;return new Promise(function(resolve,reject){filter=filter||function(){return!0};var parser=N3.Parser({documentIRI:base}),blankNodes={};parser.parse(data,function(error,n3Triple,n3Prefixes){if(error)return done&&done(error),reject(error);if(self.options.importPrefixMap&&n3Prefixes)for(var prefix in n3Prefixes)self.rdf.prefixes[prefix]=n3Prefixes[prefix];if(!n3Triple)return done&&done(),resolve();var toRdfNode=function(n3Node){if(N3.Util.isIRI(n3Node))return self.rdf.createNamedNode(n3Node);if(N3.Util.isBlank(n3Node))return n3Node in blankNodes?blankNodes[n3Node]:blankNodes[n3Node]=self.rdf.createBlankNode();var lang=N3.Util.getLiteralLanguage(n3Node),type=N3.Util.getLiteralType(n3Node);return""===lang&&(lang=null),"http://www.w3.org/2001/XMLSchema#string"===type&&(type=null),self.rdf.createLiteral(N3.Util.getLiteralValue(n3Node),lang,type?self.rdf.createNamedNode(type):null)},pushTriple=function(n3Triple){var triple=self.rdf.createTriple(toRdfNode(n3Triple.subject),toRdfNode(n3Triple.predicate),toRdfNode(n3Triple.object));filter(triple)&&callback(triple)};pushTriple(n3Triple)})})};var instance=new N3Parser;for(var property in instance)N3Parser[property]=instance[property];module.exports=N3Parser},{n3:1,"rdf-ext":42,"rdf-parser-abstract":44,util:36}],73:[function(require,module,exports){var RdfLibParser=function(store){var RDFParser={};RDFParser.ns={RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},RDFParser.nodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},this.frameFactory=function(parser,parent,element){return{NODE:1,ARC:2,parent:parent,parser:parser,store:parser.store,element:element,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(type,uri){uri=uriJoin(uri,this.base),this.node=this.store.sym(uri),this.nodeType=type},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var triple=this.store.sym(uriJoin("#"+this.parent.rdfid,this.base));this.store.add(triple,this.store.sym(RDFParser.ns.RDF+"type"),this.store.sym(RDFParser.ns.RDF+"Statement"),this.parser.why),this.store.add(triple,this.store.sym(RDFParser.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.store.add(triple,this.store.sym(RDFParser.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(triple,this.store.sym(RDFParser.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType===this.NODE&&this.parent.nodeType===this.ARC&&this.parent.parent.nodeType===this.NODE},addNode:function(uri){this.addSymbol(this.NODE,uri),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(id){null!=id?null!=this.parser.bnodes[id]?this.node=this.parser.bnodes[id]:this.node=this.parser.bnodes[id]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(uri){uri===RDFParser.ns.RDF+"li"&&(uri=RDFParser.ns.RDF+"_"+this.parent.listIndex,this.parent.listIndex++),this.addSymbol(this.ARC,uri)},addLiteral:function(value){this.parent.datatype?this.node=this.store.literal(value,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(value,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(node,uri,name){var attributeNode=null;if(node.getAttributeNodeNS)attributeNode=node.getAttributeNodeNS(uri,name);else for(var potentialNode,fullName,attributes=node.attributes,i=0;i<attributes.length;++i)if(potentialNode=attributes[i],potentialNode.namespaceURI===uri&&(fullName=potentialNode.prefix?potentialNode.prefix+":"+name:name,fullName===potentialNode.nodeName)){attributeNode=potentialNode;break}return attributeNode},this.store=store,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(document,base,why){var children=document.childNodes;this.cleanParser();var root;if(document.nodeType===RDFParser.nodeType.DOCUMENT){for(var c=0;c<children.length;c++)if(children[c].nodeType===RDFParser.nodeType.ELEMENT){root=children[c];break}}else{if(document.nodeType!==RDFParser.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+base+". Halting. ");root=document}this.why=why;var f=this.frameFactory(this);return this.base=base,f.base=base,f.lang="",this.parseDOM(this.buildFrame(f,root)),!0},this.parseDOM=function(frame){for(var rdfid,elementURI=function(el){var result="";if(null==el.namespaceURI)throw new Error("RDF/XML syntax error: No namespace for "+el.localName+" in "+this.base);return el.namespaceURI&&(result+=el.namespaceURI),el.localName?result+=el.localName:el.nodeName&&(result+=el.nodeName.indexOf(":")>=0?el.nodeName.split(":")[1]:el.nodeName),result}.bind(this),dig=!0;frame.parent;){var dom=frame.element,attrs=dom.attributes;if(dom.nodeType===RDFParser.nodeType.TEXT||dom.nodeType===RDFParser.nodeType.CDATA_SECTION)frame.parent.nodeType==frame.NODE&&(frame.addArc(RDFParser.ns.RDF+"value"),frame=this.buildFrame(frame)),frame.addLiteral(dom.nodeValue);else if(elementURI(dom)!==RDFParser.ns.RDF+"RDF")if(frame.parent&&frame.parent.collection&&(frame.addCollectionArc(),frame=this.buildFrame(frame,frame.element),frame.parent.element=null),frame.parent&&frame.parent.nodeType&&frame.parent.nodeType!==frame.ARC){frame.addArc(elementURI(dom)),this.reify&&(rdfid=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"ID"),rdfid&&(frame.rdfid=rdfid.nodeValue,dom.removeAttributeNode(rdfid)));var parsetype=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"parseType"),datatype=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"datatype");if(datatype&&(frame.datatype=datatype.nodeValue,dom.removeAttributeNode(datatype)),parsetype){var nv=parsetype.nodeValue;"Literal"===nv?(frame.datatype=RDFParser.ns.RDF+"XMLLiteral",frame=this.buildFrame(frame),frame.addLiteral(dom),dig=!1):"Resource"===nv?(frame=this.buildFrame(frame,frame.element),frame.parent.element=null,frame.addBNode()):"Collection"===nv&&(frame=this.buildFrame(frame,frame.element),frame.parent.element=null,frame.addCollection()),dom.removeAttributeNode(parsetype)}if(0!==attrs.length){var resource=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"resource"),bnid2=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"nodeID");frame=this.buildFrame(frame),resource?(frame.addNode(resource.nodeValue),dom.removeAttributeNode(resource)):bnid2?(frame.addBNode(bnid2.nodeValue),dom.removeAttributeNode(bnid2)):frame.addBNode();for(var x1=attrs.length-1;x1>=0;x1--){var f=this.buildFrame(frame);f.addArc(elementURI(attrs[x1])),elementURI(attrs[x1])===RDFParser.ns.RDF+"type"?this.buildFrame(f).addNode(attrs[x1].nodeValue):this.buildFrame(f).addLiteral(attrs[x1].nodeValue)}}else 0===dom.childNodes.length&&this.buildFrame(frame).addLiteral("")}else{var about=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"about");if(rdfid=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"ID"),about&&rdfid)throw new Error("RDFParser: "+dom.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(!about&&rdfid)frame.addNode("#"+rdfid.nodeValue),dom.removeAttributeNode(rdfid);else if(null==about&&null==rdfid){var bnid=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"nodeID");bnid?(frame.addBNode(bnid.nodeValue),dom.removeAttributeNode(bnid)):frame.addBNode()}else frame.addNode(about.nodeValue),dom.removeAttributeNode(about);var rdftype=this.getAttributeNodeNS(dom,RDFParser.ns.RDF,"type");RDFParser.ns.RDF+"Description"!==elementURI(dom)&&(rdftype={nodeValue:elementURI(dom)}),null!=rdftype&&(this.store.add(frame.node,this.store.sym(RDFParser.ns.RDF+"type"),this.store.sym(uriJoin(rdftype.nodeValue,frame.base)),this.why),rdftype.nodeName&&dom.removeAttributeNode(rdftype));for(var x=attrs.length-1;x>=0;x--)this.store.add(frame.node,this.store.sym(elementURI(attrs[x])),this.store.literal(attrs[x].nodeValue,frame.lang),this.why)}for(dom=frame.element;frame.parent;){for(var pframe=frame;null==dom;)frame=frame.parent,dom=frame.element;var candidate=dom.childNodes&&dom.childNodes[frame.lastChild];if(candidate&&dig){if((candidate.nodeType===RDFParser.nodeType.ELEMENT||candidate.nodeType===RDFParser.nodeType.TEXT||candidate.nodeType===RDFParser.nodeType.CDATA_SECTION)&&(candidate.nodeType!==RDFParser.nodeType.TEXT&&candidate.nodeType!==RDFParser.nodeType.CDATA_SECTION||1===dom.childNodes.length)){frame.lastChild++,frame=this.buildFrame(pframe,dom.childNodes[frame.lastChild-1]);break}frame.lastChild++}else{if(frame.terminateFrame(),!(frame=frame.parent))break;dom=frame.element,dig=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(parent,element){var frame=this.frameFactory(this,parent,element);if(parent&&(frame.base=parent.base,frame.lang=parent.lang),!element||element.nodeType===RDFParser.nodeType.TEXT||element.nodeType===RDFParser.nodeType.CDATA_SECTION)return frame;var attrs=element.attributes,base=element.getAttributeNode("xml:base");null!=base&&(frame.base=base.nodeValue,element.removeAttribute("xml:base"));var lang=element.getAttributeNode("xml:lang");null!=lang&&(frame.lang=lang.nodeValue,element.removeAttribute("xml:lang"));for(var x=attrs.length-1;x>=0;x--)if("xml"===attrs[x].nodeName.substr(0,3)){if("xmlns:"===attrs[x].name.slice(0,6)){var uri=attrs[x].nodeValue;this.base&&(uri=uriJoin(uri,this.base)),this.store.setPrefixForURI(attrs[x].name.slice(6),uri)}element.removeAttributeNode(attrs[x])}return frame}},uriJoin=function(given,base){var baseColon,baseHash,baseScheme,baseSingle,colon,lastSlash,path;if(baseHash=base.indexOf("#"),baseHash>0&&(base=base.slice(0,baseHash)),0===given.length)return base;if(0===given.indexOf("#"))return base+given;if(colon=given.indexOf(":"),colon>=0)return given;if(baseColon=base.indexOf(":"),0===base.length)return given;if(0>baseColon)return alert("Invalid base: "+base+" in join with given: "+given),given;if(baseScheme=base.slice(0,+baseColon+1||9e9),0===given.indexOf("//"))return baseScheme+given;if(base.indexOf("//",baseColon)===baseColon+1){if(baseSingle=base.indexOf("/",baseColon+3),0>baseSingle)return base.length-baseColon-3>0?base+"/"+given:baseScheme+given}else if(baseSingle=base.indexOf("/",baseColon+1),0>baseSingle)return base.length-baseColon-1>0?base+"/"+given:baseScheme+given;if(0===given.indexOf("/"))return base.slice(0,baseSingle)+given;if(path=base.slice(baseSingle),lastSlash=path.lastIndexOf("/"),0>lastSlash)return baseScheme+given;for(lastSlash>=0&&lastSlash<path.length-1&&(path=path.slice(0,+lastSlash+1||9e9)),path+=given;path.match(/[^\/]*\/\.\.\//);)path=path.replace(/[^\/]*\/\.\.\//,"");return path=path.replace(/\.\//g,""),path=path.replace(/\/\.$/,"/"),base.slice(0,baseSingle)+path},rdf=require("rdf-ext")(),util=require("util"),DomParser=require("rdf-parser-dom"),RdfXmlParser=function(){DomParser.call(this,rdf)};util.inherits(RdfXmlParser,DomParser),RdfXmlParser.prototype.process=function(toparse,callback,base,filter,done){var self=this;return new Promise(function(resolve,reject){base=base||"",filter=filter||function(){return!0},done=done||function(){};var domNodesToString=function(nodes){for(var xmlString="",i=0;i<nodes.length;i++)xmlString+=nodes[i].toString();return xmlString},store={};store.add=function(s,p,o){var triple=self.rdf.createTriple(s,p,o);filter(triple)&&callback(triple)},store.bnode=function(){return self.rdf.createBlankNode()},store.literal=function(value,language,type){return type&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===type.toString()&&(value=domNodesToString(value.childNodes)),self.rdf.createLiteral(value,language,type)},store.setPrefixForURI=function(){},store.sym=function(iri){return self.rdf.createNamedNode(iri)};try{"string"==typeof toparse&&(toparse=self.parseXmlDom(toparse)),new RdfLibParser(store).parse(toparse,base)}catch(error){done(error),reject(error)}done(),resolve()})};var instance=new RdfXmlParser;for(var property in instance)RdfXmlParser[property]=instance[property];module.exports=RdfXmlParser},{"rdf-ext":42,"rdf-parser-dom":60,util:36}],74:[function(require,module,exports){function AbstractSerializer(rdf){this.rdf=rdf}var util=require("util"),Readable=require("stream").Readable;AbstractSerializer.prototype.stream=function(inputStream,base,filter){var self=this,outputStream=new AbstractSerializer.DataReadStream;return AbstractSerializer.streamToGraph(inputStream,this.rdf.createGraph()).then(function(graph){self.serialize(graph,function(error,data){error?outputStream.emit("error",error):(outputStream.push(data),outputStream.emit("end"))})})["catch"](function(error){outputStream.emit("error",error)}),outputStream},AbstractSerializer.streamToGraph=function(stream,graph){return new Promise(function(resolve,reject){return"object"!=typeof stream||"function"!=typeof stream.read?resolve(stream):(stream.on("data",function(triple){graph.add(triple)}),stream.on("end",function(){resolve(graph)}),void stream.on("error",function(error){reject(error)}))})},AbstractSerializer.DataReadStream=function(){Readable.call(this,{objectMode:!0}),this._read=function(){return 0}},util.inherits(AbstractSerializer.DataReadStream,Readable),module.exports=AbstractSerializer},{stream:33,util:36}],75:[function(require,module,exports){function JsonLdSerializer(){AbstractSerializer.call(this,rdf)}var rdf=require("rdf-ext")(),util=require("util"),AbstractSerializer=require("rdf-serializer-abstract");util.inherits(JsonLdSerializer,AbstractSerializer),JsonLdSerializer.prototype.serialize=function(graph,done){return new Promise(function(resolve){done=done||function(){};var jsonGraph=[],subjects={},subjectIndex=function(subject){var value=subject.valueOf();return"undefined"==typeof subjects[value]&&("BlankNode"===subject.interfaceName?jsonGraph.push({"@id":"_:"+value}):jsonGraph.push({"@id":value}),subjects[value]=jsonGraph.length-1),subjects[value]},objectValue=function(object){var value=object.valueOf();return"NamedNode"===object.interfaceName?{"@id":value}:"BlankNode"===object.interfaceName?{"@id":"_:"+value}:object.language?{"@language":object.language,"@value":value}:object.datatype&&"http://www.w3.org/2001/XMLSchema#string"!==object.datatype.valueOf()?{"@type":object.datatype.valueOf(),"@value":value}:value};graph.forEach(function(triple){var index=subjectIndex(triple.subject),predicateValue=triple.predicate.valueOf();"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===predicateValue?("undefined"==typeof jsonGraph[index]["@type"]&&(jsonGraph[index]["@type"]=[]),jsonGraph[index]["@type"].push(triple.object.valueOf())):"undefined"==typeof jsonGraph[index][predicateValue]?jsonGraph[index][predicateValue]=objectValue(triple.object):(Array.isArray(jsonGraph[index][predicateValue])||(jsonGraph[index][predicateValue]=[jsonGraph[index][predicateValue]]),jsonGraph[index][predicateValue].push(objectValue(triple.object)))}),done(null,jsonGraph),resolve(jsonGraph)})};var instance=new JsonLdSerializer;for(var property in instance)JsonLdSerializer[property]=instance[property];module.exports=JsonLdSerializer},{"rdf-ext":42,"rdf-serializer-abstract":74,util:36}],76:[function(require,module,exports){function N3Serializer(options){this.options=options||{},this.options.usePrefixMap="usePrefixMap"in this.options?this.options.usePrefixMap:!0,AbstractSerializer.call(this,rdf)}var rdf=require("rdf-ext")(),util=require("util"),AbstractSerializer=require("rdf-serializer-abstract"),N3=require("n3");util.inherits(N3Serializer,AbstractSerializer),N3Serializer.prototype.serialize=function(graph,done){var self=this;return new Promise(function(resolve,reject){done=done||function(){};var writer,writerOptions={};self.options.usePrefixMap&&(writerOptions.prefixes={},Object.keys(rdf.prefixes).forEach(function(prefix){"string"==typeof rdf.prefixes[prefix]&&(writerOptions.prefixes[prefix]=rdf.prefixes[prefix])})),writer=N3.Writer(writerOptions);var createN3Node=function(node){return"NamedNode"===node.interfaceName.toString()?node.nominalValue:"BlankNode"===node.interfaceName.toString()?"_:"+node.nominalValue:node.datatype?'"'+node.nominalValue+'"^^'+node.datatype.nominalValue:node.language?'"'+node.nominalValue+'"@'+node.language:'"'+node.nominalValue+'"'};graph.forEach(function(triple){writer.addTriple(createN3Node(triple.subject),createN3Node(triple.predicate),createN3Node(triple.object))}),writer.end(function(error,result){error?(done(error),reject(error)):(done(null,result),resolve(result))})})};var instance=new N3Serializer;for(var property in instance)N3Serializer[property]=instance[property];module.exports=N3Serializer},{n3:77,"rdf-ext":42,"rdf-serializer-abstract":74,util:36}],77:[function(require,module,exports){arguments[4][1][0].apply(exports,arguments)},{"./lib/N3Lexer":78,"./lib/N3Parser":79,"./lib/N3Store":80,"./lib/N3StreamParser":81,"./lib/N3StreamWriter":82,"./lib/N3Util":83,"./lib/N3Writer":84,dup:1}],78:[function(require,module,exports){function N3Lexer(options){if(!(this instanceof N3Lexer))return new N3Lexer(options);if(options&&options.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var self=this;this._tokenize=this.tokenize,this.tokenize=function(input,callback){this._tokenize(input,function(error,token){!error&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(token.type)?callback&&callback(error,token):callback&&callback(error||self._syntaxError(token.type,callback=null))})}}}var fromCharCode=String.fromCharCode,immediately="function"==typeof setImmediate?setImmediate:function(func){setTimeout(func,0)},escapeSequence=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,escapeReplacements={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},illegalIriChars=/[\x00-\x20<>\\"\{\}\|\^\`]/;N3Lexer.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(callback,inputFinished){function reportSyntaxError(self){callback(self._syntaxError(/^\S*/.exec(input)[0]))}for(var input=this._input;;){for(var whiteSpaceMatch;whiteSpaceMatch=this._newline.exec(input);)input=input.substr(whiteSpaceMatch[0].length,input.length),this._line++;if((whiteSpaceMatch=this._whitespace.exec(input))&&(input=input.substr(whiteSpaceMatch[0].length,input.length)),this._endOfFile.test(input))return inputFinished&&callback(input=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=input;var unescaped,line=this._line,type="",value="",prefix="",firstChar=input[0],match=null,matchLength=0,inconclusive=!1;switch(firstChar){case"^":if(1===input.length)break;if("^"!==input[1])return reportSyntaxError(this);if(this._prevTokenType="^",input=input.substr(2),"<"!==input[0]){inconclusive=!0;break}case"<":if(match=this._unescapedIri.exec(input))type="IRI",value=match[1];else if(match=this._iri.exec(input)){if(unescaped=this._unescape(match[1]),null===unescaped||illegalIriChars.test(unescaped))return reportSyntaxError(this);type="IRI",value=unescaped}break;case"_":((match=this._blank.exec(input))||inputFinished&&(match=this._blank.exec(input+" ")))&&(type="prefixed",prefix="_",value=match[1]);break;case'"':case"'":if(match=this._unescapedString.exec(input))type="literal",value=match[0];else if(match=this._singleQuotedString.exec(input)){if(unescaped=this._unescape(match[0]),null===unescaped)return reportSyntaxError(this);type="literal",value=unescaped.replace(/^'|'$/g,'"')}else if(match=this._tripleQuotedString.exec(input)){if(unescaped=match[1]||match[2],this._line+=unescaped.split(/\r\n|\r|\n/).length-1,unescaped=this._unescape(unescaped),null===unescaped)return reportSyntaxError(this);type="literal",value=unescaped.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(match=this._langcode.exec(input))?(type="langcode",value=match[1]):(match=this._keyword.exec(input))&&(type=match[0]);break;case".":if(1===input.length?inputFinished:input[1]<"0"||input[1]>"9"){type=".",matchLength=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(match=this._number.exec(input))&&(type="literal",value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(match[1]?"double":/^[+\-]?\d+$/.test(match[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(match=this._sparqlKeyword.exec(input))?type=match[0].toUpperCase():inconclusive=!0;break;case"f":case"t":(match=this._boolean.exec(input))?(type="literal",value='"'+match[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):inconclusive=!0;break;case"a":(match=this._shortPredicates.exec(input))?(type="abbreviation",value="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):inconclusive=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":matchLength=1,type=firstChar;break;default:inconclusive=!0}if(inconclusive&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(match=this._prefix.exec(input))?((match=this._prefixed.exec(input))||inputFinished&&(match=this._prefixed.exec(input+" ")))&&(type="prefixed",prefix=match[1]||"",value=this._unescape(match[2])):(type="prefix",value=match[1]||"")),"^"===this._prevTokenType&&(type="IRI"===type||"prefixed"===type?"type":""),!type)return inputFinished||!/^'''|^"""/.test(input)&&/\n|\r/.test(input)?reportSyntaxError(this):this._input=input;callback(null,{line:line,type:type,value:value,prefix:prefix}),this._prevTokenType=type,input=input.substr(matchLength||match[0].length,input.length)}},_unescape:function(item){try{return item.replace(escapeSequence,function(sequence,unicode4,unicode8,escapedChar){var charCode;if(unicode4){if(charCode=parseInt(unicode4,16),isNaN(charCode))throw new Error;return fromCharCode(charCode)}if(unicode8){if(charCode=parseInt(unicode8,16),isNaN(charCode))throw new Error;return 65535>=charCode?fromCharCode(charCode):fromCharCode(55296+(charCode-=65536)/1024,56320+(1023&charCode))}var replacement=escapeReplacements[escapedChar];if(!replacement)throw new Error;return replacement})}catch(error){return null}},_syntaxError:function(issue){return this._input=null,new Error('Syntax error: unexpected "'+issue+'" on line '+this._line+".")},tokenize:function(input,callback){function addChunk(data){null!==self._input&&(self._input+=data,self._tokenizeToEnd(callback,!1))}function end(){null!==self._input&&self._tokenizeToEnd(callback,!0)}var self=this;this._line=1,"string"==typeof input?(this._input=input,immediately(function(){self._tokenizeToEnd(callback,!0)})):(this._input="",input&&"function"!=typeof input?("function"==typeof input.setEncoding&&input.setEncoding("utf8"),input.on("data",addChunk),input.on("end",end)):(this.addChunk=addChunk,this.end=end,callback||(callback=input)))}},module.exports=N3Lexer},{}],79:[function(require,module,exports){function N3Parser(options){if(!(this instanceof N3Parser))return new N3Parser(options);this._tripleStack=[],this._graph=null,options=options||{},this._setBase(options.documentIRI);var format="string"==typeof options.format&&options.format.match(/\w*$/)[0].toLowerCase(),isTurtle="turtle"===format,isTriG="trig"===format,isNTriples=/triple/.test(format),isNQuads=/quad/.test(format),isLineMode=isNTriples||isNQuads;(this._supportsNamedGraphs=!isTurtle)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(isTurtle||isTriG||isNTriples),isLineMode&&(this._base="",this._resolveIRI=function(token){return this._error("Disallowed relative IRI",token),this._callback=noop,this._subject=null}),this._blankNodePrefix="string"!=typeof options.blankNodePrefix?"":"_:"+options.blankNodePrefix.replace(/^_:/,""),
this._lexer=options.lexer||new N3Lexer({lineMode:isLineMode})}function noop(){}var N3Lexer=require("./N3Lexer"),RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_NIL=RDF_PREFIX+"nil",RDF_FIRST=RDF_PREFIX+"first",RDF_REST=RDF_PREFIX+"rest",absoluteIRI=/^[a-z][a-z0-9+.-]*:/i,schemeAuthority=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,dotSegments=/(?:^|\/)\.\.?(?:$|[\/#?])/,blankNodePrefix=0,blankNodeCount=0;N3Parser._resetBlankNodeIds=function(){blankNodePrefix=blankNodeCount=0},N3Parser.prototype={_setBase:function(baseIRI){if(baseIRI){if(baseIRI.indexOf("#")>=0)throw new Error("Invalid base IRI "+baseIRI)}else baseIRI=null;(this._base=baseIRI)&&(this._basePath=baseIRI.replace(/[^\/?]*(?:\?.*)?$/,""),baseIRI=baseIRI.match(schemeAuthority),this._baseRoot=baseIRI[0],this._baseScheme=baseIRI[1])},_readInTopContext:function(token){switch(token.type){case"eof":return null!==this._graph?this._error("Unclosed graph",token):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(token)}},_readSubject:function(token){switch(this._predicate=null,token.type){case"IRI":null===this._base||absoluteIRI.test(token.value)?this._subject=token.value:this._subject=this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._subject=prefix+token.value;break;case"[":return this._subject="_:b"+blankNodeCount++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:RDF_NIL,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(token);default:return this._error("Expected subject but got "+token.type,token)}return this._readPredicateOrNamedGraph},_readPredicate:function(token){var type=token.type;switch(type){case"IRI":case"abbreviation":null===this._base||absoluteIRI.test(token.value)?this._predicate=token.value:this._predicate=this._resolveIRI(token);break;case"prefixed":if("_"===token.prefix)return this._error("Disallowed blank node as predicate",token);var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._predicate=prefix+token.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+type,token):(this._subject=null,"]"===type?this._readBlankNodeTail(token):this._readPunctuation(token));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',token)}return this._readObject},_readObject:function(token){switch(token.type){case"IRI":null===this._base||absoluteIRI.test(token.value)?this._object=token.value:this._object=this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);this._object=prefix+token.value;break;case"literal":return this._object=token.value,this._readDataTypeOrLang;case"[":var blank="_:b"+blankNodeCount++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:blank,type:"blank"}),this._subject=blank,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:RDF_NIL,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',token)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(token){return"{"===token.type?this._readGraph(token):this._readPredicate(token)},_readGraph:function(token){return"{"!==token.type?this._error("Expected graph but got "+token.type,token):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(token){return"]"===token.type?(this._subject=null,this._readBlankNodeTail(token)):(this._predicate=null,this._readPredicate(token))},_readBlankNodeTail:function(token){if("]"!==token.type)return this._readBlankNodePunctuation(token);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var triple=this._tripleStack.pop();return this._subject=triple.subject,null!==triple.object?(this._predicate=triple.predicate,this._object=triple.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(token){switch(token.type){case"type":var value;if(""===token.prefix)value=null===this._base||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token);else{var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);value=prefix+token.value}return this._object+="^^"+value,this._getTripleEndReader();case"langcode":return this._object+="@"+token.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,token)}},_readListItem:function(token){var item=null,itemHead=null,prevItemHead=this._subject,stack=this._tripleStack,parentTriple=stack[stack.length-1],next=this._readListItem;switch(token.type){case"IRI":item=null===this._base||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token);break;case"prefixed":var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);item=prefix+token.value;break;case"literal":item=token.value,next=this._readDataTypeOrLang;break;case"[":itemHead="_:b"+blankNodeCount++,item="_:b"+blankNodeCount++,stack.push({subject:itemHead,predicate:RDF_FIRST,object:item,type:"blank"}),this._subject=item,next=this._readBlankNodeHead;break;case"(":itemHead="_:b"+blankNodeCount++,stack.push({subject:itemHead,predicate:RDF_FIRST,object:RDF_NIL,type:"list"}),this._subject=null,next=this._readListItem;break;case")":if(stack.pop(),0!==stack.length&&"list"===stack[stack.length-1].type&&this._callback(null,{subject:parentTriple.subject,predicate:parentTriple.predicate,object:parentTriple.object,graph:this._graph||""}),this._subject=parentTriple.subject,null===parentTriple.predicate){if(next=this._readPredicate,parentTriple.subject===RDF_NIL)return next}else if(this._predicate=parentTriple.predicate,this._object=parentTriple.object,next=this._getTripleEndReader(),parentTriple.object===RDF_NIL)return next;itemHead=RDF_NIL;break;default:return this._error('Expected list item instead of "'+token.type+'"',token)}return null===itemHead&&(this._subject=itemHead="_:b"+blankNodeCount++),null===prevItemHead?parentTriple.object===RDF_NIL?parentTriple.object=itemHead:parentTriple.subject=itemHead:this._callback(null,{subject:prevItemHead,predicate:RDF_REST,object:itemHead,graph:this._graph||""}),null!==item&&this._callback(null,{subject:itemHead,predicate:RDF_FIRST,object:item,graph:this._graph||""}),next},_readPunctuation:function(token){var next,subject=this._subject,graph=this._graph;switch(token.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",token);this._graph=null;case".":this._subject=null,next=this._readInTopContext;break;case";":next=this._readPredicate;break;case",":next=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){graph=null===this._base||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token),subject=this._subject,next=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var prefix=this._prefixes[token.prefix];if(void 0===prefix)return this._error('Undefined prefix "'+token.prefix+':"',token);graph=prefix+token.value,next=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}return null!==subject&&this._callback(null,{subject:subject,predicate:this._predicate,object:this._object,graph:graph||""}),next},_readBlankNodePunctuation:function(token){var next;switch(token.type){case";":next=this._readPredicate;break;case",":next=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',token)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),next},_readQuadPunctuation:function(token){return"."!==token.type?this._error("Expected dot to follow quad",token):this._readInTopContext},_readPrefix:function(token){return"prefix"!==token.type?this._error("Expected prefix to follow @prefix",token):(this._prefix=token.value,this._readPrefixIRI)},_readPrefixIRI:function(token){if("IRI"!==token.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',token);var prefixIRI;return prefixIRI=null===this._base||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token),this._prefixes[this._prefix]=prefixIRI,this._prefixCallback(this._prefix,prefixIRI),this._readDeclarationPunctuation},_readBaseIRI:function(token){if("IRI"!==token.type)return this._error("Expected IRI to follow base declaration",token);try{this._setBase(null===this._base||absoluteIRI.test(token.value)?token.value:this._resolveIRI(token))}catch(error){this._error(error.message,token)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(token){switch(token.type){case"IRI":case"prefixed":return this._readSubject(token),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",token)}},_readNamedGraphBlankLabel:function(token){return"]"!==token.type?this._error("Invalid graph label",token):(this._subject="_:b"+blankNodeCount++,this._readGraph)},_readDeclarationPunctuation:function(token){return this._sparqlStyle?this._readInTopContext(token):"."!==token.type?this._error("Expected declaration to end with a dot",token):this._readInTopContext},_getTripleEndReader:function(){var stack=this._tripleStack;if(0===stack.length)return this._readPunctuation;switch(stack[stack.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(message,token){this._callback(new Error(message+" at line "+token.line+"."))},_resolveIRI:function(token){var iri=token.value;switch(iri[0]){case void 0:return this._base;case"#":return this._base+iri;case"?":return this._base.replace(/(?:\?.*)?$/,iri);case"/":return("/"===iri[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(iri);default:return this._removeDotSegments(this._basePath+iri)}},_removeDotSegments:function(iri){if(!dotSegments.test(iri))return iri;for(var result="",length=iri.length,i=-1,pathStart=-1,segmentStart=0,next="/";length>i;){switch(next){case":":if(0>pathStart&&"/"===iri[++i]&&"/"===iri[++i])for(;(pathStart=i+1)<length&&"/"!==iri[pathStart];)i=pathStart;break;case"?":case"#":i=length;break;case"/":if("."===iri[i+1])switch(next=iri[++i+1]){case"/":result+=iri.substring(segmentStart,i-1),segmentStart=i+1;break;case void 0:case"?":case"#":return result+iri.substring(segmentStart,i)+iri.substr(i+1);case".":if(next=iri[++i+1],void 0===next||"/"===next||"?"===next||"#"===next){if(result+=iri.substring(segmentStart,i-2),(segmentStart=result.lastIndexOf("/"))>=pathStart&&(result=result.substr(0,segmentStart)),"/"!==next)return result+"/"+iri.substr(i+1);segmentStart=i+1}}}next=iri[++i]}return result+iri.substring(segmentStart)},parse:function(input,tripleCallback,prefixCallback){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+blankNodePrefix++ +"_","function"==typeof input&&(prefixCallback=tripleCallback,tripleCallback=input,input=null),this._callback=tripleCallback||noop,this._prefixCallback=prefixCallback||noop;var self=this;this._lexer.tokenize(input,function(error,token){null!==error?(self._callback(error),self._callback=noop):void 0!==self._readCallback&&(self._readCallback=self._readCallback(token))}),input||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},module.exports=N3Parser},{"./N3Lexer":78}],80:[function(require,module,exports){function N3Store(triples,options){return this instanceof N3Store?(this._size=0,this._graphs=Object.create(null),this._entities=Object.create(null),this._entities["><"]=0,this._entityCount=0,this._blankNodeIndex=0,options||!triples||triples[0]||(options=triples,triples=null),this._prefixes=Object.create(null),options&&options.prefixes&&this.addPrefixes(options.prefixes),void(triples&&this.addTriples(triples))):new N3Store(triples,options)}var expandPrefixedName=require("./N3Util").expandPrefixedName;N3Store.prototype={get size(){var size=this._size;if(null!==size)return size;var subjects,subject,graphs=this._graphs;for(var graphKey in graphs)for(var subjectKey in subjects=graphs[graphKey].subjects)for(var predicateKey in subject=subjects[subjectKey])size+=Object.keys(subject[predicateKey]).length;return this._size=size},_addToIndex:function(index0,key0,key1,key2){var index1=index0[key0]||(index0[key0]={}),index2=index1[key1]||(index1[key1]={});index2[key2]=null},_removeFromIndex:function(index0,key0,key1,key2){var key,index1=index0[key0],index2=index1[key1];delete index2[key2];for(key in index2)return;delete index1[key1];for(key in index1)return;delete index0[key0]},_findInIndex:function(index0,key0,key1,key2,name0,name1,name2,graph){var tmp,index1,index2,results=[],entityKeys=Object.keys(this._entities);key0&&((tmp=index0,index0={})[key0]=tmp[key0]);for(var value0 in index0){var entity0=entityKeys[value0];if(index1=index0[value0]){key1&&((tmp=index1,index1={})[key1]=tmp[key1]);for(var value1 in index1){var entity1=entityKeys[value1];if(index2=index1[value1])for(var values=(key2?key2 in index2?[key2]:[]:Object.keys(index2)),l=values.length-1;l>=0;l--){var result={subject:"",predicate:"",object:"",graph:graph};result[name0]=entity0,result[name1]=entity1,result[name2]=entityKeys[values[l]],results.push(result)}}}}return results},_countInIndex:function(index0,key0,key1,key2){var tmp,index1,index2,count=0;key0&&((tmp=index0,index0={})[key0]=tmp[key0]);for(var value0 in index0)if(index1=index0[value0]){key1&&((tmp=index1,index1={})[key1]=tmp[key1]);for(var value1 in index1)(index2=index1[value1])&&(key2?key2 in index2&&count++:count+=Object.keys(index2).length)}return count},addTriple:function(subject,predicate,object,graph){predicate||(graph=subject.graph,object=subject.object,predicate=subject.predicate,subject=subject.subject),graph=graph||"";var graphItem=this._graphs[graph];graphItem||(graphItem=this._graphs[graph]={subjects:{},predicates:{},objects:{}},Object.freeze(graphItem));var entities=this._entities;subject=entities[subject]||(entities[subject]=++this._entityCount),predicate=entities[predicate]||(entities[predicate]=++this._entityCount),object=entities[object]||(entities[object]=++this._entityCount),this._addToIndex(graphItem.subjects,subject,predicate,object),this._addToIndex(graphItem.predicates,predicate,object,subject),this._addToIndex(graphItem.objects,object,subject,predicate),this._size=null},addTriples:function(triples){for(var i=triples.length-1;i>=0;i--)this.addTriple(triples[i])},addPrefix:function(prefix,iri){this._prefixes[prefix]=iri},addPrefixes:function(prefixes){for(var prefix in prefixes)this.addPrefix(prefix,prefixes[prefix])},removeTriple:function(subject,predicate,object,graph){predicate||(graph=subject.graph,object=subject.object,predicate=subject.predicate,subject=subject.subject),graph=graph||"";var graphItem,entities=this._entities,graphs=this._graphs;if((subject=entities[subject])&&(predicate=entities[predicate])&&(object=entities[object])&&(graphItem=graphs[graph])){var subjects,predicates;if((subjects=graphItem.subjects[subject])&&(predicates=subjects[predicate])&&object in predicates){this._removeFromIndex(graphItem.subjects,subject,predicate,object),this._removeFromIndex(graphItem.predicates,predicate,object,subject),this._removeFromIndex(graphItem.objects,object,subject,predicate),null!==this._size&&this._size--;for(subject in graphItem.subjects)return;delete graphs[graph]}}},removeTriples:function(triples){for(var i=triples.length-1;i>=0;i--)this.removeTriple(triples[i])},find:function(subject,predicate,object,graph){var prefixes=this._prefixes;return this.findByIRI(expandPrefixedName(subject,prefixes),expandPrefixedName(predicate,prefixes),expandPrefixedName(object,prefixes),expandPrefixedName(graph,prefixes))},findByIRI:function(subject,predicate,object,graph){graph=graph||"";var graphItem=this._graphs[graph],entities=this._entities;return graphItem?subject&&!(subject=entities[subject])?[]:predicate&&!(predicate=entities[predicate])?[]:object&&!(object=entities[object])?[]:subject?object?this._findInIndex(graphItem.objects,object,subject,predicate,"object","subject","predicate",graph):this._findInIndex(graphItem.subjects,subject,predicate,null,"subject","predicate","object",graph):predicate?this._findInIndex(graphItem.predicates,predicate,object,null,"predicate","object","subject",graph):object?this._findInIndex(graphItem.objects,object,null,null,"object","subject","predicate",graph):this._findInIndex(graphItem.subjects,null,null,null,"subject","predicate","object",graph):[]},count:function(subject,predicate,object,graph){var prefixes=this._prefixes;return this.countByIRI(expandPrefixedName(subject,prefixes),expandPrefixedName(predicate,prefixes),expandPrefixedName(object,prefixes),expandPrefixedName(graph,prefixes))},countByIRI:function(subject,predicate,object,graph){graph=graph||"";var graphItem=this._graphs[graph],entities=this._entities;return graphItem?subject&&!(subject=entities[subject])?0:predicate&&!(predicate=entities[predicate])?0:object&&!(object=entities[object])?0:subject?object?this._countInIndex(graphItem.objects,object,subject,predicate):this._countInIndex(graphItem.subjects,subject,predicate,object):predicate?this._countInIndex(graphItem.predicates,predicate,object,subject):this._countInIndex(graphItem.objects,object,subject,predicate):0},createBlankNode:function(suggestedName){var name,index;if(suggestedName)for(name=suggestedName="_:"+suggestedName,index=1;this._entities[name];)name=suggestedName+index++;else do name="_:b"+this._blankNodeIndex++;while(this._entities[name]);return this._entities[name]=++this._entityCount,name}},module.exports=N3Store},{"./N3Util":83}],81:[function(require,module,exports){arguments[4][5][0].apply(exports,arguments)},{"./N3Parser.js":79,dup:5,stream:33,util:36}],82:[function(require,module,exports){arguments[4][6][0].apply(exports,arguments)},{"./N3Writer.js":84,dup:6,stream:33,util:36}],83:[function(require,module,exports){function addN3Util(parent,toPrototype){for(var name in N3Util)toPrototype?parent.prototype[name]=applyToThis(N3Util[name]):parent[name]=N3Util[name];return parent}function applyToThis(f){return function(a){return f(this,a)}}var Xsd="http://www.w3.org/2001/XMLSchema#",XsdString=Xsd+"string",XsdInteger=Xsd+"integer",XsdDecimal=Xsd+"decimal",XsdBoolean=Xsd+"boolean",RdfLangString="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",N3Util={isIRI:function(entity){if(!entity)return entity;var firstChar=entity[0];return'"'!==firstChar&&"_"!==firstChar},isLiteral:function(entity){return entity&&'"'===entity[0]},isBlank:function(entity){return entity&&"_:"===entity.substr(0,2)},getLiteralValue:function(literal){var match=/^"([^]*)"/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]},getLiteralType:function(literal){var match=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]||(match[2]?RdfLangString:XsdString)},getLiteralLanguage:function(literal){var match=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(literal);if(!match)throw new Error(literal+" is not a literal");return match[1]?match[1].toLowerCase():""},isPrefixedName:function(entity){return entity&&/^[^:\/"']*:[^:\/"']+$/.test(entity)},expandPrefixedName:function(prefixedName,prefixes){var prefix,base,index,match=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(prefixedName);return match&&(prefix=match[1],base=prefixes[prefix],index=match.index),void 0===base?prefixedName:0===index?base+prefixedName.substr(prefix.length+1):prefixedName.substr(0,index+3)+base+prefixedName.substr(index+prefix.length+4)},createIRI:function(iri){return iri&&'"'===iri[0]?N3Util.getLiteralValue(iri):iri},createLiteral:function(value,modifier){if(!modifier)switch(typeof value){case"boolean":modifier=XsdBoolean;break;case"number":if(isFinite(value)){modifier=value%1===0?XsdInteger:XsdDecimal;break}default:return'"'+value+'"'}return'"'+value+(/^[a-z]+(-[a-z0-9]+)*$/i.test(modifier)?'"@'+modifier.toLowerCase():'"^^'+modifier)}};module.exports=addN3Util(addN3Util)},{}],84:[function(require,module,exports){function N3Writer(outputStream,options){if(!(this instanceof N3Writer))return new N3Writer(outputStream,options);if(outputStream&&"function"!=typeof outputStream.write&&(options=outputStream,outputStream=null),options=options||{},outputStream)this._outputStream=outputStream,this._endStream=void 0===options.end?!0:!!options.end;else{var output="";this._outputStream={write:function(chunk,encoding,done){output+=chunk,done&&done()},end:function(done){done&&done(null,output)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(options.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),options.prefixes&&this.addPrefixes(options.prefixes))}function characterReplacer(character){var result=escapeReplacements[character];return void 0===result&&(1===character.length?(result=character.charCodeAt(0).toString(16),result="\\u0000".substr(0,6-result.length)+result):(result=(1024*(character.charCodeAt(0)-55296)+character.charCodeAt(1)+9216).toString(16),result="\\U00000000".substr(0,10-result.length)+result)),result}var N3LiteralMatcher=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,RDF_PREFIX="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_TYPE=RDF_PREFIX+"type",escape=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,escapeAll=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,escapeReplacements={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};N3Writer.prototype={_write:function(string,callback){this._outputStream.write(string,"utf8",callback)},_writeTriple:function(subject,predicate,object,graph,done){try{this._graph!==graph&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(graph?this._encodeIriOrBlankNode(graph)+" {\n":"")),this._subject=null,this._graph="["!==graph[0]?graph:"]"),this._subject===subject?this._predicate===predicate?this._write(", "+this._encodeObject(object),done):this._write(";\n    "+this._encodePredicate(this._predicate=predicate)+" "+this._encodeObject(object),done):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=subject)+" "+this._encodePredicate(this._predicate=predicate)+" "+this._encodeObject(object),done)}catch(error){done&&done(error)}},_writeTripleLine:function(subject,predicate,object,graph,done){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(subject)+" "+this._encodeIriOrBlankNode(predicate)+" "+this._encodeObject(object)+(graph?" "+this._encodeIriOrBlankNode(graph)+".\n":".\n"),done)}catch(error){done&&done(error)}},_encodeIriOrBlankNode:function(entity){var firstChar=entity[0];if("["===firstChar||"("===firstChar||"_"===firstChar&&":"===entity[1])return entity;escape.test(entity)&&(entity=entity.replace(escapeAll,characterReplacer));var prefixMatch=this._prefixRegex.exec(entity);return prefixMatch?prefixMatch[1]?this._prefixIRIs[prefixMatch[1]]+prefixMatch[2]:entity:"<"+entity+">"},_encodeLiteral:function(value,type,language){return escape.test(value)&&(value=value.replace(escapeAll,characterReplacer)),language?'"'+value+'"@'+language:type?'"'+value+'"^^'+this._encodeIriOrBlankNode(type):'"'+value+'"'},_encodeSubject:function(subject){if('"'===subject[0])throw new Error("A literal as subject is not allowed: "+subject);return"["===subject[0]&&(this._subject="]"),this._encodeIriOrBlankNode(subject)},_encodePredicate:function(predicate){if('"'===predicate[0])throw new Error("A literal as predicate is not allowed: "+predicate);return predicate===RDF_TYPE?"a":this._encodeIriOrBlankNode(predicate)},_encodeObject:function(object){if('"'!==object[0])return this._encodeIriOrBlankNode(object);var match=N3LiteralMatcher.exec(object);if(!match)throw new Error("Invalid literal: "+object);return this._encodeLiteral(match[1],match[2],match[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(subject,predicate,object,graph,done){void 0===object?this._writeTriple(subject.subject,subject.predicate,subject.object,subject.graph||"",predicate):"string"!=typeof graph?this._writeTriple(subject,predicate,object,"",graph):this._writeTriple(subject,predicate,object,graph,done)},addTriples:function(triples){for(var i=0;i<triples.length;i++)this.addTriple(triples[i])},addPrefix:function(prefix,iri,done){var prefixes={};prefixes[prefix]=iri,this.addPrefixes(prefixes,done)},addPrefixes:function(prefixes,done){var prefixIRIs=this._prefixIRIs,hasPrefixes=!1;for(var prefix in prefixes){var iri=prefixes[prefix];/[#\/]$/.test(iri)&&prefixIRIs[iri]!==(prefix+=":")&&(hasPrefixes=!0,prefixIRIs[iri]=prefix,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+prefix+" <"+iri+">.\n"))}if(hasPrefixes){var IRIlist="",prefixList="";for(var prefixIRI in prefixIRIs)IRIlist+=IRIlist?"|"+prefixIRI:prefixIRI,prefixList+=(prefixList?"|":"")+prefixIRIs[prefixIRI];IRIlist=IRIlist.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+prefixList+")[^/]*$|^("+IRIlist+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(hasPrefixes?"\n":"",done)},blank:function(predicate,object){var child,length,children=predicate;switch(void 0===predicate?children=[]:"string"==typeof predicate?children=[{predicate:predicate,object:object}]:"length"in predicate||(children=[predicate]),length=children.length){case 0:return"[]";case 1:if(child=children[0],"["!==child.object[0])return"[ "+this._encodePredicate(child.predicate)+" "+this._encodeObject(child.object)+" ]";default:for(var contents="[",i=0;length>i;i++)child=children[i],child.predicate===predicate?contents+=", "+this._encodeObject(child.object):(contents+=(i?";\n  ":"\n  ")+this._encodePredicate(child.predicate)+" "+this._encodeObject(child.object),predicate=child.predicate);return contents+"\n]"}},list:function(elements){for(var length=elements&&elements.length||0,contents=new Array(length),i=0;length>i;i++)contents[i]=this._encodeObject(elements[i]);return"("+contents.join(" ")+")"},_prefixRegex:/$0^/,end:function(done){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var singleDone=done&&function(error,result){singleDone=null,done(error,result)};if(this._endStream)try{return this._outputStream.end(singleDone)}catch(error){}singleDone&&singleDone()}},module.exports=N3Writer},{}],85:[function(require,module,exports){function NTriplesSerializer(){AbstractSerializer.call(this,rdf)}var rdf=require("rdf-ext")(),util=require("util"),AbstractSerializer=require("rdf-serializer-abstract");util.inherits(NTriplesSerializer,AbstractSerializer),NTriplesSerializer.prototype.serialize=function(graph,done){return new Promise(function(resolve){done=done||function(){};var nTriples="";graph.forEach(function(triple){nTriples+=triple.toString()+"\n"}),done(null,nTriples),resolve(nTriples)})};var instance=new NTriplesSerializer;for(var property in instance)NTriplesSerializer[property]=instance[property];module.exports=NTriplesSerializer},{"rdf-ext":42,"rdf-serializer-abstract":74,util:36}],86:[function(require,module,exports){function SparqlUpdateSerializer(){AbstractSerializer.call(this,rdf)}var rdf=require("rdf-ext")(),util=require("util"),AbstractSerializer=require("rdf-serializer-abstract");util.inherits(SparqlUpdateSerializer,AbstractSerializer),SparqlUpdateSerializer.prototype.serialize=function(graph,done){return new Promise(function(resolve){done=done||function(){};var nTriples="INSERT DATA { ";graph.forEach(function(triple){nTriples+=triple.toString()+"\n"}),nTriples+=" }",done(null,nTriples),resolve(nTriples)})};var instance=new SparqlUpdateSerializer;for(var property in instance)SparqlUpdateSerializer[property]=instance[property];module.exports=SparqlUpdateSerializer},{"rdf-ext":42,"rdf-serializer-abstract":74,util:36}],87:[function(require,module,exports){"use strict";function InMemoryStore(rdf){var graphs={};this.graph=function(iri,callback){var graph=null;void 0===iri?(graph=rdf.createGraph(),this.forEach(function(toAdd){graph.addAll(toAdd)})):iri in graphs&&(graph=graphs[iri]),callback(null,graph)},this.match=function(iri,subject,predicate,object,callback,limit){this.graph(iri,function(graph){graph?callback(null,graph.match(subject,predicate,object,limit)):callback()})},this.add=function(iri,graph,callback){graphs[iri]=rdf.createGraph(),graphs[iri].addAll(graph),callback(null,graph)},this.merge=function(iri,graph,callback){iri in graphs?graphs[iri].addAll(graph):graphs[iri]=graph,callback(null,graph)},this.remove=function(iri,graph,callback){iri in graphs&&(graphs[iri]=rdf.Graph.difference(graphs[iri],graph)),callback()},this.removeMatches=function(iri,subject,predicate,object,callback){iri in graphs&&graphs[iri].removeMatches(subject,predicate,object),callback()},this["delete"]=function(iri,callback){iri in graphs&&delete graphs[iri],callback()},this.forEach=function(callback){Object.keys(graphs).forEach(function(iri){callback(graphs[iri],iri)})}}module.exports=InMemoryStore},{}],88:[function(require,module,exports){"use strict";function LdpStore(rdf,options){var self=this;options=options||{},self.parsers=options.parsers||LdpStore.defaultParsers(rdf),self.serializers=options.serializers||LdpStore.defaultSerializers(rdf),self.defaultParser=options.defaultParser||"text/turtle",self.defaultSerializer=options.defaultSerializer||"text/turtle",self.defaultPatchSerializer=options.defaultPatchSerializer||options.defaultSerializer||"text/turtle",self.request=options.request||rdf.defaultRequest;var buildAccept=function(){var accept=null;for(var mimeType in self.parsers)accept?accept+=", "+mimeType:accept=mimeType;return accept},httpSuccess=function(statusCode){return statusCode>=200&&300>statusCode};self.graph=function(iri,callback,options){options=options||{},self.request("GET",iri,{Accept:buildAccept()},null,function(statusCode,headers,content,error){if(error)return callback(null,"request error: "+error);if(!httpSuccess(statusCode)&&0!==statusCode)return callback(null,"status code error: "+statusCode);var contentType=self.defaultParser;"content-type"in headers&&headers["content-type"]in self.parsers&&(contentType=headers["content-type"]),"forceContentType"in options&&options.forceContentType in self.parsers&&(contentType=options.forceContentType),self.parsers[contentType](content,function(graph,error){return error?callback(null,"parser error: "+error):("useEtag"in options&&options.useEtag&&"etag"in headers&&(graph.etag=headers.etag),void callback(graph))},iri)})},self.match=function(iri,subject,predicate,object,callback,limit){self.graph(iri,function(graph,error){return error?callback(null,error):void callback(graph.match(subject,predicate,object,limit))})},self.add=function(iri,graph,callback,options){var method="PUT",contentType=self.defaultSerializer,headers={};
options=options||{},headers["Content-Type"]=contentType,"method"in options&&(method=options.method),"etag"in options&&(headers["If-Match"]=options.etag),"useEtag"in options&&options.useEtag&&"etag"in graph&&(headers["If-Match"]=graph.etag),self.serializers[contentType](graph,function(data,error){return error?callback(null,error):void self.request(method,iri,headers,data,function(statusCode,headers,content,error){return error?callback(null,error):httpSuccess(statusCode)?void callback(graph):callback(null,"status code error: "+statusCode)})})},self.merge=function(iri,graph,callback,options){var contentType=self.defaultPatchSerializer,headers={};options=options||{},headers["Content-Type"]=contentType,"etag"in options&&(headers["If-Match"]=options.etag),"useEtag"in options&&options.useEtag&&"etag"in graph&&(headers["If-Match"]=graph.etag),self.serializers[contentType](graph,function(data,error){return error?callback(null,error):void self.request("PATCH",iri,headers,data,function(statusCode,headers,content,error){return error?callback(null,error):httpSuccess(statusCode)?void callback(graph):callback(null,"status code error: "+statusCode)})})},self.remove=function(iri,graph,callback){},self.removeMatches=function(iri,subject,predicate,object,callback){},self["delete"]=function(iri,callback){self.request("DELETE",iri,{},null,function(statusCode,headers,content,error){return error?callback(!1,"request error: "+error):httpSuccess(statusCode)?void callback(!0):callback(!1,"status code error: "+statusCode)})}}LdpStore.serializeSparqlUpdate=function(rdf,graph,callback){rdf.serializeNTriples(graph,function(nTriples,error){return error?callback(null,error):void callback("INSERT DATA { "+nTriples+" }")})},LdpStore.defaultParsers=function(rdf){return{"application/ld+json":rdf.parseJsonLd,"application/n-triples":rdf.parseTurtle,"text/turtle":rdf.parseTurtle}},LdpStore.defaultSerializers=function(rdf){return{"application/ld+json":rdf.serializeJsonLd,"application/n-triples":rdf.serializeNTriples,"application/sparql-update":LdpStore.serializeSparqlUpdate.bind(null,rdf),"text/turtle":rdf.serializeNTriples}},module.exports=LdpStore},{}],89:[function(require,module,exports){"use strict";function RdfstoreStore(store){var self=this,rdf=store.rdf;self.graph=function(iri,callback){store.graph(iri,function(success,graph){callback(success?graph:null)})},self.match=function(iri,subject,predicate,object,callback,limit){self.graph(iri,function(graph){callback(graph?graph.match(subject,predicate,object,limit):null)})},self.add=function(iri,graph,callback){store.clear(iri,function(){store.insert(graph,iri,function(success){success?callback(graph):callback(null,"couldn'n insert graph")})})},self.merge=function(iri,graph,callback){store.insert(graph,iri,function(success){success?callback(graph):callback(null,"couldn'n insert graph")})},self.remove=function(iri,graph,callback){self.graph(iri,function(oldGraph){var newGraph=rdf.Graph.difference(oldGraph,graph);self.add(iri,newGraph,function(addedGraph){callback(!!addedGraph)})})},self.removeMatches=function(iri,subject,predicate,object,callback){self.graph(iri,function(oldGraph){var newGraph=oldGraph.removeMatches(subject,predicate,object);self.add(iri,newGraph,function(addedGraph){callback(!!addedGraph)})})},self["delete"]=function(iri,callback){store.clear(iri,function(success){success?callback(!0):callback(null,"couldn'n delete graph")})}}module.exports=RdfstoreStore},{}],90:[function(require,module,exports){"use strict";function SingleGraphStore(rdf,singleGraph){this.graph=function(iri,callback){callback(singleGraph)},this.match=function(iri,subject,predicate,object,callback,limit){callback(singleGraph.match(subject,predicate,object,limit))},this.add=function(iri,graph,callback){callback(singleGraph=graph)},this.merge=function(iri,graph,callback){singleGraph.addAll(graph),callback(graph)},this.remove=function(iri,graph,callback){singleGraph=rdf.difference(singleGraph,graph),callback(!0)},this.removeMatches=function(iri,subject,predicate,object,callback){singleGraph.removeMatches(subject,predicate,object),callback(!0)},this["delete"]=function(iri,callback){singleGraph.removeMatches(),callback(!0)}}module.exports=SingleGraphStore},{}],91:[function(require,module,exports){"use strict";var SparqlStore=function(rdf,options){var self=this;options=options||{},self.endpointUrl=options.endpointUrl,self.updateUrl=options.updateUrl||self.endpointUrl,self.mimeType=options.mimeType||"text/turtle",self.serialize=options.serialize||rdf.serializeNTriples,self.parse=options.parse||rdf.parseTurtle,self.request=options.request||rdf.defaultRequest;var httpSuccess=function(statusCode){return statusCode>=200&&300>statusCode},buildMatch=function(subject,predicate,object){var match="",nodeToNT=function(node){return"string"==typeof node?"_:"===node.substr(0,2)?node:"<"+node+">":node.toNT()};return match+=subject?nodeToNT(subject):"?s",match+=predicate?" "+nodeToNT(predicate):" ?p",match+=object?" "+nodeToNT(object):" ?o"};self.executeQuery=function(queryString,callback,queryParams,requestOptions){queryParams=queryParams||{parse:!0},requestOptions=requestOptions||{};var queryUrl=self.endpointUrl+"?query="+encodeURIComponent(queryString),reqHeaders={Accept:self.mimeType};self.request("GET",queryUrl,reqHeaders,null,function(statusCode,resHeaders,resContent,error){return error?callback("request error: "+error):httpSuccess(statusCode)?void(200===statusCode&&queryParams.parse?self.parse(resContent,callback):callback()):callback("status code error: "+statusCode)})},self.executeUpdateQuery=function(queryString,callback,queryParams,requestOptions){queryParams=queryParams||{parse:!0},requestOptions=requestOptions||{};var reqHeaders={"Content-Type":"application/sparql-update"};self.request("POST",self.updateUrl,reqHeaders,queryString,function(statusCode,resHeaders,resContent,error){return error?callback("request error: "+error):httpSuccess(statusCode)?void(200===statusCode&&queryParams.parse?self.parse(resContent,callback):callback()):callback("status code error: "+statusCode)})},self.graph=function(graphIri,callback){self.match(graphIri,null,null,null,callback)},self.match=function(graphIri,subject,predicate,object,callback,limit){var filter=buildMatch(subject,predicate,object),query="CONSTRUCT { "+filter+" } { GRAPH <"+graphIri+"> {"+filter+" }}";self.executeQuery(query,callback)},self.add=function(graphIri,graph,callback){self.serialize(graph,function(error,data){if(error)callback(error);else{var query="DROP SILENT GRAPH <"+graphIri+">;INSERT DATA { GRAPH <"+graphIri+"> { "+data+" } }";self.executeUpdateQuery(query,function(error){error?callback(error):callback(null,graph)})}})},self.merge=function(graphIri,graph,callback){self.serialize(graph,function(error,data){if(error)callback(error);else{var query="INSERT DATA { GRAPH <"+graphIri+"> { "+data+" } }";self.executeUpdateQuery(query,function(error){error?callback(error):callback(null,graph)})}})},self.remove=function(graphIri,graph,callback){self.serialize(graph,function(error,data){if(error)callback(error);else{var query="DELETE DATA FROM <"+graphIri+"> { "+data+" }";self.executeUpdateQuery(query,callback)}})},self.removeMatches=function(graphIri,subject,predicate,object,callback){var query="DELETE FROM GRAPH <"+graphIri+"> WHERE { "+buildMatch(subject,predicate,object)+" }";self.executeUpdateQuery(query,callback)},self["delete"]=function(graphIri,callback){var query="CLEAR  GRAPH <"+graphIri+">";self.executeUpdateQuery(query,callback)}};module.exports=SparqlStore},{}]},{},[37]);
//# sourceMappingURL=rdf-ext.min.js.map